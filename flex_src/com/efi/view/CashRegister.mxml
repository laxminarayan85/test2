<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" creationComplete="init()" xmlns:fc="http://www.adobe.com/2006/fc" xmlns:vo="com.efi.vo.*"
width="800" height="678" title="Cash Register"
 label="Cash Register" name="cashregister" xmlns:ns1="com.efi.components.*">
 
 	<mx:RemoteObject id="dataService" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveResult(event)"/>
	</mx:RemoteObject>

	<mx:Producer id="producer" destination="cashregister"/>
	<mx:Consumer id="consumer" destination="cashregister" message="messageHandler(event.message)"/>
	<mx:Consumer id="notification_consumer" destination="notifications" message="messageHandler(event.message)"/>
<mx:Script>
<![CDATA[
	import mx.controls.Text;

	import mx.controls.Alert;                                         
	import mx.managers.PopUpManager;                                         
	import mx.containers.TitleWindow;                                         
	import mx.collections.ArrayCollection;                                         
	import mx.rpc.events.ResultEvent;                                         
	import mx.rpc.events.FaultEvent;                                         
	import mx.messaging.messages.AsyncMessage;
	import mx.messaging.messages.IMessage;
	import mx.collections.XMLListCollection;

	[Bindable]
	private var enableSave:Boolean = true;

//Data field arrays
//	[Bindable]
	private var CashRegisterArray:ArrayCollection = new ArrayCollection();

//Data view variables
//	[Bindable]
//	private var preferencesSystem:PreferencesSystem;

//Tree view XML table
	[Bindable]
	private var treeData:XML =
    	<root>
			<node label="SS Copy" isBranch="false" tag="0"/>
			<node label="Color" isBranch="false" tag="1"/>
			<node label="Fax Rec" isBranch="false" tag="2"/>
			<node label="Fax Send" isBranch="false" tag="3"/>
			<node label="Other" isBranch="false" tag="4"/>
			<node label="Merch 1" isBranch="false" tag="5"/>
			<node label="Merch 2" isBranch="false" tag="6"/>
			<node label="Misc" isBranch="false" tag="7"/>
			<node label="No Sale" isBranch="false" tag="8"/>
		</root>;
	
		
	public function init():void {
		consumer.subscribe();
		notification_consumer.subscribe();

		openTree();
		setup();
		
	}
	
	private function setup():void{
		
	}
	
	private function messageHandler(message:IMessage):void{
	}
     
	private function handleFault(ev:FaultEvent):void {  
		var message:String;
		              
		message = "Error: "                          
		+ ev.fault.faultCode + " - "                                  
		+ ev.fault.faultDetail + " - "                                  
		+ ev.fault.faultString;
		Alert.show(message, "Error", 0, null, null, null, 4);                                 
	}


// Data Load Handlers
	private function handleLoadResult(ev:ResultEvent):void {
		CashRegisterArray = ev.result as ArrayCollection;
	}

// Data Save Handlers
	private function handleSaveResult(ev:ResultEvent):void {
    	//dataService.getAll("PreferencesSystem");
	}

	

	private function openTree():void {
		var nodeList:XMLListCollection = 
			tvItems.dataProvider as XMLListCollection;
		tvItems.selectedIndex = 0;

		var node:XML = XML(tvItems.selectedItem);
	}

	private function treeSelect(event:Event):void {
		
//		var node:XML = XML(event.currentTarget.selectedItem);
//		if( node == null ) return;
		
//		cashregister_stack.selectedIndex = node.@tag; 
	}

	
	private function doSave():void{
	}
	
	private function doRevert():void{
	}
	


]]>
                             
</mx:Script>	
	<mx:Tree x="0" y="0" width="200"  
		id="tvItems" 
		dataProvider="{treeData.node}"
		labelField="@label"
		height="100%" change="treeSelect(event);"></mx:Tree>

	<mx:Button x="228" y="6" width="38" height="38" click="doSave();" enabled="{enableSave}" id="btnSave">
		<mx:icon>@Embed(source='../../../assets/file.png')</mx:icon>
	</mx:Button>
	<mx:Button x="274" y="6" width="38" height="38" click="doRevert();" enabled="{enableSave}" id="btnRevert">
		<mx:icon>@Embed(source='../../../assets/cancel.png')</mx:icon>
	</mx:Button>

	<mx:VBox id="vbox2" left="200" top="50" height="100%" width="100%" creationPolicy="all">
		<mx:Canvas width="100%" height="100%" id="cashregister_canvas" hideEffect="effect" showEffect="effect">

		</mx:Canvas>
	</mx:VBox>
</mx:Panel>
