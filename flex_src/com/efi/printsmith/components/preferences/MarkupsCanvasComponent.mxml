<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:components="com.efi.printsmith.common.components.*">

	<mx:Script>
		<![CDATA[
			import com.efi.printsmith.data.OutsideService;
			import com.efi.printsmith.data.Merchandise;
			import mx.events.DataGridEventReason;
			import mx.events.DataGridEvent;
			import mx.controls.dataGridClasses.DataGridColumn;
			import mx.collections.ArrayCollection;
			
			[Bindable] public var preferencesMarkupsArray:ArrayCollection = new ArrayCollection();
			
			[Bindable] public var preferencesMarkupsDeleteArray:ArrayCollection = new ArrayCollection();
			
			[Bindable] public var preferencesMarkupsMerchandiseArray:ArrayCollection = new ArrayCollection();
			
			[Bindable] public var preferencesMarkupsMerchandiseDeleteArray:ArrayCollection = new ArrayCollection();
		
			private function formatNumberMarkup(item:Object, column:DataGridColumn):String {
				return item.markup.toFixed(2);
			}
			
			private function doNewMarkup(item:String):void{
				if (item=="outside")
				{
					var newItem1:OutsideService = new OutsideService();
					preferencesMarkupsArray.addItem(newItem1);
				}else {
					var newItem2:Merchandise = new Merchandise();
					preferencesMarkupsMerchandiseArray.addItem(newItem2);
				}
			}
			private function doRemoveMarkup(item:String, dg:DataGrid):void{
				if (dg.selectedIndex > -1) {
					if (item=="outside")
					{
						var newItem1:OutsideService = dg.selectedItem as OutsideService;
						preferencesMarkupsDeleteArray.addItem(newItem1);
						preferencesMarkupsArray.removeItemAt(dg.selectedIndex);
					}else {
						var newItem2:Merchandise = dg.selectedItem as Merchandise;
						preferencesMarkupsMerchandiseDeleteArray.addItem(newItem2);
						preferencesMarkupsMerchandiseArray.removeItemAt(dg.selectedIndex);
					}
				}
			}
		]]>
	</mx:Script>
	
	<mx:VBox width="100%" height="100%">
	
		<mx:Label
			text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'genericPrefCmd.Markups')}"
			textAlign="center" width="100%"/>
			
		<mx:HRule width="100%"/>
		
		<mx:HBox width="100%" height="100%">
		
			<mx:Spacer width="30"/>
			
			<mx:VBox width="100%" height="100%">
	
				<mx:Text
					text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.Markupissteppedandba')}"
					height="38" width="50%"/>
					
				<mx:HBox width="60%" height="100%" horizontalGap="10">
				
					<mx:VBox width="50%" height="100%">
					
						<mx:Label
							text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.OutsideServices')}"/>
							
						<mx:DataGrid id="outsideServicesGrid" dataProvider="{preferencesMarkupsArray}"
							editable="true" height="80%">
							
							<mx:columns>
							
								<mx:DataGridColumn
									headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.TotalCost')}"
									dataField="totalCost">
									<mx:itemRenderer>
										<mx:Component>
											<mx:Text selectable="false" text="{data.totalCost}"/>
										</mx:Component>
									</mx:itemRenderer>
									<mx:itemEditor>
										<mx:Component>
											<components:CustomNumericTextInputComponent
												datagridControl="true" variableName="totalCost" customText="{data.totalCost}"
												precision="2" rounding="nearest" isItemEditor="true"/>
										</mx:Component>
									</mx:itemEditor>
								</mx:DataGridColumn>
									
								<mx:DataGridColumn
									headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.Markup')}"
									dataField="markup" labelFunction="formatNumberMarkup">
									<mx:itemRenderer>
										<mx:Component>
											<mx:Text selectable="false" text="{data.markup}" />
										</mx:Component>
									</mx:itemRenderer>
									<mx:itemEditor>
										<mx:Component>
											<components:CustomNumericTextInputComponent
												datagridControl="true" variableName="markup" customText="{data.markup}"
												precision="2" rounding="nearest" isItemEditor="true"/>
										</mx:Component>
									</mx:itemEditor>
								</mx:DataGridColumn>
									
							</mx:columns>
							
						</mx:DataGrid>
						
						<mx:HBox width="100%">
							
							<mx:Button width="38" height="38"
								click="{doNewMarkup('outside')}">
								<mx:icon>@Embed(source='../../../../../assets/new.png')</mx:icon>
							</mx:Button>
							
							<mx:Button width="38" height="38"
								click="{doRemoveMarkup('outside',outsideServicesGrid)}">
								<mx:icon>@Embed(source='../../../../../assets/cancel.png')</mx:icon>
							</mx:Button>
							
						</mx:HBox>
						
					</mx:VBox>
					
					<mx:VBox width="50%" height="100%">
					
						<mx:Label
							text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.Merchandise')}"/>
					
						<mx:DataGrid id="merchandiseGrid" height="80%"
							dataProvider="{preferencesMarkupsMerchandiseArray}" editable="true">
							
							<mx:columns>
							
								<mx:DataGridColumn
									headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.TotalCost')}"
									dataField="totalCost">
									<mx:itemRenderer>
										<mx:Component>
											<mx:Text selectable="false" text="{data.totalCost}" />
										</mx:Component>
									</mx:itemRenderer>
									<mx:itemEditor>
										<mx:Component>
											<components:CustomNumericTextInputComponent
												datagridControl="true" variableName="totalCost" customText="{data.totalCost}"
												precision="2" rounding="nearest" isItemEditor="true"/>
										</mx:Component>
									</mx:itemEditor>
								</mx:DataGridColumn>
									
								<mx:DataGridColumn
									headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'pricePrefCmd.Markup')}"
									dataField="markup" labelFunction="formatNumberMarkup">
									<mx:itemRenderer>
										<mx:Component>
											<mx:Text selectable="false" text="{data.markup}" />
										</mx:Component>
									</mx:itemRenderer>
									<mx:itemEditor>
										<mx:Component>
											<components:CustomNumericTextInputComponent
												datagridControl="true" variableName="markup" customText="{data.markup}"
												precision="2" rounding="nearest" isItemEditor="true"/>
										</mx:Component>
									</mx:itemEditor>
								</mx:DataGridColumn>
									
							</mx:columns>
							
						</mx:DataGrid>
						
						<mx:HBox width="100%">
						
							<mx:Button width="38" height="38"
								click="{doNewMarkup('merchandise')}">
								<mx:icon>@Embed(source='../../../../../assets/new.png')</mx:icon>
							</mx:Button>
							
							<mx:Button width="38" height="38"
								click="{doRemoveMarkup('merchandise',merchandiseGrid)}">
								<mx:icon>@Embed(source='../../../../../assets/cancel.png')</mx:icon>
							</mx:Button>
						
						</mx:HBox>
						
					</mx:VBox>
					
				</mx:HBox>
				
			</mx:VBox>
			
		</mx:HBox>
		
	</mx:VBox>
	
</mx:Canvas>