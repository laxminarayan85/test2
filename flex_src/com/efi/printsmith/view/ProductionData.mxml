<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:vo="com.efi.printsmith.vo.*" label="Estmate History" name="Estmate History"
width="938" height="507"  creationComplete="init()"  
     title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.ProductionData')}" xmlns:text="flash.text.*" fontSize="9" xmlns:ns1="com.efi.printsmith.common.components.*">
	<mx:states>
		<mx:State name="BlankStock">
			<mx:RemoveChild target="{label1}"/>
			<mx:RemoveChild target="{markup}"/>
			<mx:RemoveChild target="{press_label}"/>
			<mx:RemoveChild target="{copier}"/>
			<mx:RemoveChild target="{copier_speed}"/>
			<mx:RemoveChild target="{press_speed_label}"/>
			<mx:RemoveChild target="{label2}"/>
			<mx:RemoveChild target="{label3}"/>
			<mx:RemoveChild target="{label4}"/>
			<mx:RemoveChild target="{label5}"/>
			<mx:RemoveChild target="{setup_time}"/>
			<mx:RemoveChild target="{run_time}"/>
			<mx:RemoveChild target="{washup_time}"/>
			<mx:RemoveChild target="{total_time}"/>
			<mx:RemoveChild target="{hrule1}"/>
		</mx:State>
		<mx:State name="ChargesOnly">
			<mx:RemoveChild target="{parent_size}"/>
			<mx:RemoveChild target="{parent_size_label}"/>
			<mx:RemoveChild target="{label6}"/>
			<mx:RemoveChild target="{run_size}"/>
			<mx:RemoveChild target="{parent_costs}"/>
			<mx:RemoveChild target="{label7}"/>
			<mx:RemoveChild target="{label8}"/>
			<mx:RemoveChild target="{production_run}"/>
			<mx:RemoveChild target="{text1}"/>
			<mx:RemoveChild target="{requires}"/>
			<mx:RemoveChild target="{requires_label}"/>
			<mx:RemoveChild target="{sheets_purchased_label}"/>
			<mx:RemoveChild target="{copier_speed}"/>
			<mx:RemoveChild target="{press_label}"/>
			<mx:RemoveChild target="{sheets_purchased}"/>
			<mx:RemoveChild target="{press_speed_label}"/>
			<mx:RemoveChild target="{copier}"/>
			<mx:RemoveChild target="{setup_time}"/>
			<mx:RemoveChild target="{run_time}"/>
			<mx:RemoveChild target="{washup_time}"/>
			<mx:RemoveChild target="{hrule1}"/>
			<mx:RemoveChild target="{total_time}"/>
			<mx:RemoveChild target="{label5}"/>
			<mx:RemoveChild target="{label4}"/>
			<mx:RemoveChild target="{label3}"/>
			<mx:RemoveChild target="{label2}"/>
			<mx:RemoveChild target="{label1}"/>
			<mx:RemoveChild target="{markup}"/>
			<mx:RemoveChild target="{per}"/>
			<mx:RemoveChild target="{label9}"/>
			<mx:RemoveChild target="{label10}"/>
			<mx:RemoveChild target="{area}"/>
			<mx:RemoveChild target="{label11}"/>
			<mx:RemoveChild target="{number_out}"/>
			<mx:RemoveChild target="{copier_label}"/>
			<mx:RemoveChild target="{copier_speed_label}"/>
			<mx:RemoveChild target="{hrule2}"/>
		</mx:State>
	</mx:states>
<mx:RemoteObject id="dataService" destination="dataService">
	<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveResult(event)"/>
	<mx:method name="getByAccountId" fault="handleFault(event)" result="handleLoadResult(event)"/>
	<mx:method name="deleteItem" fault="handleFault(event)" result="handleDeleteResult(event)"/>
	<mx:method name="getAll" fault="handleFault(event)" result="handleLoadProductionDatesResult(event)"/>
</mx:RemoteObject>
<mx:Producer id="producer" destination="invoicebase"/>
	<mx:Consumer id="consumer" destination="invoicebase" message="messageHandler(event.message)"/>
	<mx:Consumer id="notification_consumer" destination="notifications" message="messageHandler(event.message)"/>
<mx:RemoteObject id="dimensionDataService"
					 destination="dataService">
		<mx:method name="getAll"
				   fault="handleFault(event)"
				   result="handleLoadDimensionResult(event)"/>
	</mx:RemoteObject>
<mx:Script>                                   
<![CDATA[
	import com.efi.printsmith.data.ProductionDates;
	import com.efi.printsmith.data.ProductionCopiers;
	import com.efi.printsmith.data.ProductionLocations;
	import com.efi.printsmith.data.Dimension;
	import com.efi.printsmith.data.Job;
	import com.efi.printsmith.data.JobBase;
	import mx.controls.Alert;                                         
	import mx.managers.PopUpManager;                                         
	import mx.containers.TitleWindow;                                         
	import mx.collections.ArrayCollection;                                         
	import mx.rpc.events.ResultEvent;                                         
	import mx.rpc.events.FaultEvent;                                           
	import mx.messaging.messages.AsyncMessage;
	import mx.messaging.messages.IMessage;
    import mx.printing.FlexPrintJob;
    import mx.printing.PrintAdvancedDataGrid;
    import mx.printing.PrintDataGrid;
    import mx.core.Application;
    import mx.validators.Validator;
    import mx.events.ValidationResultEvent;    
	import com.efi.printsmith.data.Account; 
	import com.efi.printsmith.data.Invoice;         
	import com.efi.printsmith.events.AccountPickerSelectEvent;	  
	import com.efi.printsmith.events.PriceJobEvent;
	import mx.rpc.events.ResultEvent;
	import mx.rpc.events.FaultEvent;
	import mx.rpc.IResponder;   
	import com.efi.printsmith.pages.ShowCutOut;
	
	[Bindable]                                         
	private var job:Job;
	
	[Bindable]
	private var dimensionsArray:ArrayCollection=new ArrayCollection();
	
	[Bindable]
    private var estimates:ArrayCollection = new ArrayCollection(); 
    
    [Bindable]
    private var dates:ArrayCollection = new ArrayCollection();
	
	public function init():void {
		consumer.subscribe();
		dimensionDataService.getAll("Dimension");
		dataService.getAll("ProductionDates");
	}  
	
	private function doGet():void {
		
	}  
	
	private function doPaperCal():void{
		var showCutOutWindow:ShowCutOut = ShowCutOut(PopUpManager.createPopUp(this, ShowCutOut, true));
		showCutOutWindow.setStyle("borderAlpha", 0.9);
	 	showCutOutWindow.setJob(job);
	 }
	 
	private function handleLoadProductionDatesResult(ev:ResultEvent):void {
		dates = ev.result as ArrayCollection;
		
		for(var i:int = 0;i < dates.length && i < 16;i++) {
			var date:com.efi.printsmith.data.ProductionDates = dates[i] as com.efi.printsmith.data.ProductionDates;
			
			if (i == 0)
				prod_date_1.text = date.name;
			else if (i == 1)
				prod_date_2.text = date.name;
			else if (i == 2)
				prod_date_3.text = date.name;
			else if (i == 3)
				prod_date_4.text = date.name;
			else if (i == 4)
				prod_date_5.text = date.name;
			else if (i == 5)
				prod_date_6.text = date.name;
			else if (i == 6)
				prod_date_7.text = date.name;
			else if (i == 7)
				prod_date_8.text = date.name;
			else if (i == 8)
				prod_date_9.text = date.name;
			else if (i == 9)
				prod_date_10.text = date.name;
			else if (i == 10)
				prod_date_11.text = date.name;
			else if (i == 11)
				prod_date_12.text = date.name;
			else if (i == 12)
				prod_date_13.text = date.name;
			else if (i == 13)
				prod_date_14.text = date.name;
			else if (i == 14)
				prod_date_15.text = date.name;
			else if (i == 15)
				prod_date_16.text = date.name;
		}
	}
	
	private function handleLoadDimensionResult(ev:ResultEvent):void
	{
		dimensionsArray=ev.result as ArrayCollection;
		if (job.parentSize != null)
			this.parent_size.selectedIndex = findItem(job.parentSize.name, dimensionsArray);
		if (this.parent_size.selectedIndex == -1)
			this.parent_size.text = job.parentSize.name;
		if (job.runSize != null)
			this.run_size.selectedIndex = findItem(job.runSize.name, dimensionsArray);
		if (this.run_size.selectedIndex == -1)
			this.run_size.text = job.runSize.name;
	}
	
	private function findItem(name:String, array:ArrayCollection):int
	{
		for each (var element:Object in array)
		{
			if (name == element.name)
			{ 
				return array.getItemIndex(element);
			}
		}
		return -1;
	}
	
	public function setJob(job2:JobBase):void
	{
		this.job = job2 as Job;
		dimensionDataService.getAll("Dimension");
		setProductionData();
	}			
	
	private function setProductionData():void {
		if (job.pricingMethod.title == "Blank") {
			this.currentState = "BlankStock";
			this.parent_size.selectedIndex = findItem(job.parentSize.name,this.dimensionsArray);
			this.run_size.selectedIndex = findItem(job.runSize.name,this.dimensionsArray);
			this.production_run.text = job.pressQty.toString();
			this.requires.text = job.sheets.toString();
			this.sheets_purchased.text = job.qtyOrdered.toString();
			this.area.text = (job.runSize.height * job.runSize.width).toString();
			this.per.text = job.costUnits.toString();
			this.labor_cost.text = job.pricingRecord.laborTotalPrice.toString();
			this.number_out.text = job.paperCal.runout.toString();
			this.job_price.text = job.pricingRecord.totalPrice.toFixed(2);
			this.itemized_markups.text = "0.00";
			this.other_charges.text = job.pricingRecord.otherChargePrice.toString();
			this.production.text = job.pricingRecord.productionPrice.toString();
			this.stock_cost.text = job.pricingRecord.stockCost.toFixed(2);
			this.stock_price.text = job.pricingRecord.stockTotalPrice.toFixed(2);
			if (job.pricingRecord.stockTotalPrice > 0)
				this.stock_markup.text = (job.pricingRecord.stockTotalPrice - job.pricingRecord.stockCost).toFixed(2);
			else
				this.stock_markup.text = "0.00";
			this.labor_cost.text = job.pricingRecord.laborCost.toFixed(2);
			this.labor_price.text = job.pricingRecord.laborTotalPrice.toFixed(2);
			this.labor_markup.text = (job.pricingRecord.laborTotalPrice - job.pricingRecord.laborCost).toFixed(2);
			this.parent_costs.text = job.parentStockCost.toFixed(2);
		} else if (job.pricingMethod.title == "Printing" || job.pricingMethod.method == "Large Format" || job.pricingMethod.method == "B&W" || job.pricingMethod.method == "Color") {
			this.parent_size.selectedIndex = findItem(job.parentSize.name,this.dimensionsArray);
			this.run_size.selectedIndex = findItem(job.runSize.name,this.dimensionsArray);
			this.production_run.text = job.pressQty.toString();
			this.requires.text = job.sheets.toString();
			this.sheets_purchased.text = job.qtyOrdered.toString();
			this.area.text = (job.runSize.height * job.runSize.width).toString();
			this.per.text = job.costUnits.toString();
			this.markup.text = job.pricingRecord.stockMarkup.toString();
			this.labor_cost.text = job.pricingRecord.laborTotalPrice.toString();
			this.number_out.text = job.paperCal.runout.toString();
			this.job_price.text = job.pricingRecord.totalPrice.toFixed(2);
			this.itemized_markups.text = "0.00";
			this.other_charges.text = job.pricingRecord.otherChargePrice.toString();
			this.production.text = job.pricingRecord.productionPrice.toString();
			this.stock_cost.text = job.pricingRecord.stockCost.toFixed(2);
			this.stock_price.text = job.pricingRecord.stockTotalPrice.toFixed(2);
			if (job.pricingRecord.stockTotalPrice > 0)
				this.stock_markup.text = (job.pricingRecord.stockTotalPrice - job.pricingRecord.stockCost).toFixed(2);
			else
				this.stock_markup.text = "0.00";
			this.labor_cost.text = job.pricingRecord.laborCost.toFixed(2);
			this.labor_price.text = job.pricingRecord.laborTotalPrice.toFixed(2);
			this.labor_markup.text = (job.pricingRecord.laborTotalPrice - job.pricingRecord.laborCost).toFixed(2);
			this.parent_costs.text = job.parentStockCost.toFixed(2);
			if (job.pricingMethod.title == "Printing") {
				this.copier.text = job.pricingPress.name;
				this.copier_speed.text = job.pricingPress.avgImpressPerHour.toString();
				this.copier_label.visible = false;
				this.copier_speed_label.visible = false;
				this.press_label.visible = true;
				this.press_speed_label.visible = true;
				var setupHours:String = (this.job.pricingPress.setupMin / 60).toFixed(0);
				var setupMinutes:Number = this.job.pricingPress.setupMin;
				setupMinutes = setupMinutes - (parseInt(setupHours) * 60);
				this.setup_time.text = setupHours + ":" + setupMinutes.toString();
				var runHours:String = (this.job.impressionsPerRun / this.job.pricingPress.avgImpressPerHour).toFixed(0);
				var runMinutes:Number = (this.job.impressionsPerRun / this.job.pricingPress.avgImpressPerHour) * 60;
				runMinutes = runMinutes - (parseInt(runHours) * 60);
				this.run_time.text = runHours + ":" + runMinutes.toFixed(0);
				this.washup_time.text = "0:00";
				this.total_time.text = (parseInt(setupHours) + parseInt(runHours)).toString() + ":" + (setupMinutes + runMinutes).toFixed(0);
			} else {
				this.copier.text = job.pricingCopier.name;
				this.copier_speed.text = job.copyMinutes.toString();
				this.copier_label.visible = true;
				this.copier_speed_label.visible = true;
				this.press_label.visible = false;
				this.press_speed_label.visible = false;
				var runHours:String = Math.floor((this.job.runTime / 60)).toFixed(0);
				runHours = runHours.replace(".","");
				var runMinutes:Number = this.job.runTime - (parseInt(runHours) * 60);
				if (runMinutes < 10)
					this.run_time.text = runHours + ":0" + runMinutes.toFixed(0);
				else
					this.run_time.text = runHours + ":" + runMinutes.toFixed(0);
				var totalTime:Number = job.runTime + job.setupTime + job.washupTime;
				var totalHours:String = Math.floor((totalTime / 60)).toFixed(0);
				totalHours = totalHours.replace(".","");
				var totalMinutes:Number = totalTime - (parseInt(totalHours) * 60);
				if (totalMinutes < 10)
					this.total_time.text = totalHours + ":0" + totalMinutes.toFixed(0);
				else
					this.total_time.text = totalHours + ":" + totalMinutes.toFixed(0);
				this.production_run.text = job.numCopies.toString();
				if (job.pricingMethod.method != "Large Format") {
					this.requires.visible = true;
					this.sheets_purchased.visible = true;
					var requires:Number = 0;
					var purchased:Number = 0;
					if (job.doubleSided) {
						requires = Math.round((job.totalCopies / 2 / job.paperCal.runout));
						this.requires.text = requires.toFixed(0);
						purchased = Math.round((job.totalCopies / 2 / job.paperCal.runout));
						this.sheets_purchased.text = purchased.toFixed(0);
					}
					else {
						requires = Math.round((job.totalCopies / job.paperCal.runout));
						this.requires.text = requires.toFixed(0);
						purchased = Math.round((job.totalCopies / job.paperCal.runout));
						this.sheets_purchased.text = purchased.toFixed(0);
					}
				}
				else {
					this.parent_size_label.text = resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobCmd.RollWidth');
					this.requires.visible = false;
					this.sheets_purchased.visible = false;
					this.requires_label.visible = false;
					this.sheets_purchased_label.visible = false;
					this.run_size.selectedIndex = -1;
					this.run_size.text = job.rollWidth + " x " + job.cutOff;
					if (job.pricingCopier.squareAreaType == "AreaFinishSize")
						this.area.text = (job.finishSize.height * job.finishSize.width).toFixed(0);
					else
						this.area.text = (job.rollWidth * job.cutOff).toFixed(0);
				}
			}
		} else {
			this.currentState = "ChargesOnly";
			this.labor_cost.text = job.pricingRecord.laborTotalPrice.toString();
			this.number_out.text = job.paperCal.runout.toString();
			this.job_price.text = job.pricingRecord.totalPrice.toFixed(2);
			this.itemized_markups.text = "0.00";
			this.other_charges.text = job.pricingRecord.otherChargePrice.toString();
			this.production.text = job.pricingRecord.productionPrice.toString();
			this.stock_cost.text = job.pricingRecord.stockCost.toFixed(2);
			this.stock_price.text = job.pricingRecord.stockTotalPrice.toFixed(2);
			if (job.pricingRecord.stockTotalPrice > 0)
				this.stock_markup.text = (job.pricingRecord.stockTotalPrice - job.pricingRecord.stockCost).toFixed(2);
			else
				this.stock_markup.text = "0.00";
			this.labor_cost.text = job.pricingRecord.laborCost.toFixed(2);
			this.labor_price.text = job.pricingRecord.laborTotalPrice.toFixed(2);
			this.labor_markup.text = (job.pricingRecord.laborTotalPrice - job.pricingRecord.laborCost).toFixed(2);
		}
	}
	
	private function handleLoadResult(ev:ResultEvent):void {
		estimates = ev.result as ArrayCollection;
	
	}
	private function handleSaveResult(event:Event):void {
		
	}
	private function handleDeleteResult(event:Event):void {

	}
	private function handleFault(event:FaultEvent):void {
		var message:String;
		              
		message = "Error: "                          
		+ event.fault.faultCode + " - "                                  
		+ event.fault.faultDetail + " - "                                  
		+ event.fault.faultString;
		Alert.show(message, "Error", 0, null, null, null, 4);        	
	} 	
	private function messageHandler(message:IMessage):void
	{
		var messageBody:Object = message.body;// as com.efi.messaging.MessageBody;
		
		var messageType:String = messageBody.messageType;
		if (messageType == "ADDUPDATE" || messageType == "DELETE") {
			var payloadType:String = messageBody.payloadType as String; // What kind of item was added/deleted
			var payload:Number = messageBody.payload as Number; // ID if item added or deleted
			if (payloadType == "Estimate") {
		  		
			}
		}
	}
	
	private function runSizeLostFocus():void {
		var sizeStr:String = Snowmass.formatSizeString(this.run_size.text);
		this.run_size.selectedIndex = findItem(sizeStr, dimensionsArray);
		if (this.run_size.selectedIndex == -1) {
			if (job.runSize == null)
				job.runSize = new Dimension() as Dimension;
			job.runSize.name = sizeStr;
			job.runSize.width = Snowmass.getWidthFromSizeString(job.runSize);
			job.runSize.height = Snowmass.getLengthFromSizeString(job.runSize);
			run_size.text = job.runSize.name;
		}
		else if (run_size.selectedItem != null) {
			var localSize:Dimension = run_size.selectedItem as Dimension;
			job.runSize.name = localSize.name;
			job.runSize.type = localSize.type;
			job.runSize.height = localSize.height;
			job.runSize.width = localSize.width;
		}
		
		if (job.runSize != null)
			this.area.text = (job.runSize.height * job.runSize.width).toString();
	}
	
	private function doNumOutChange():void {
		if (this.number_out.text == "" || isNaN(parseInt(this.number_out.text)))
			job.orRunOut = false;
		else
			job.orRunOut = true;
	}
	
	private function doProductionPriceChange():void {
		if (this.production.text == "" || isNaN(parseInt(this.production.text)))
			job.pricingRecord.productionPriceOverride = false;
		else
			job.pricingRecord.productionPriceOverride = true;
	}
	
	private function doCopierSpeedChange():void {
		if (this.copier_speed.text == "" || isNaN(parseInt(this.copier_speed.text)))
			job.copyMinutesOverride = false;
		else
			job.copyMinutesOverride = true;
	}
	
	private function doParentCostChange():void {
		if (this.parent_costs.text == "" || isNaN(parseInt(this.copier_speed.text)))
			job.parentStockCostOverride = false;
		else
			job.parentStockCostOverride = true;
	}
	
	private function doPerChange():void {
		if (this.per.text == "" || isNaN(parseInt(this.per.text)))
			job.costUnitsOverride = false;
		else
			job.costUnitsOverride = true;
	}
	
	private function doMarkupChange():void {
		if (this.markup.text == "" || isNaN(parseInt(this.markup.text)))
			job.orStockMarkup = false;
		else
			job.orStockMarkup = true;
	}
	
	private function fieldChanged(evt:FocusEvent):void
	{	
		var doUpdatePrice:Boolean = false;
		
		switch (evt.currentTarget) {
			case this.number_out:
				job.paperCal.runout = parseInt(this.number_out.text);
				doUpdatePrice = true;
				break;
			case this.parent_costs:
				job.parentStockCost = parseFloat(this.parent_costs.text);
				doUpdatePrice = true;
				break;
			case this.per:
				job.costUnits = parseInt(this.per.text);
				doUpdatePrice = true;
				break;
			case this.copier_speed:
				job.copyMinutes = parseFloat(this.copier_speed.text);
				break;
			case this.markup:
				job.pricingRecord.stockMarkup = parseFloat(this.markup.text);
				doUpdatePrice = true;
				break;
			case this.production:
				job.pricingRecord.productionPrice = parseFloat(this.production.text);
				doUpdatePrice = true;
				break;
			case this.setup_time:
				var hours:Number = 0;
				var minutes:Number = 0;
				if (this.setup_time.text.indexOf(":") != -1) {
					hours = parseInt(this.setup_time.text.substr(0,this.setup_time.text.indexOf(":")));
					minutes = parseInt(this.setup_time.text.substr(this.setup_time.text.indexOf(":")+1));
				} if (this.setup_time.text.indexOf(".") != -1) {
					hours = parseInt(this.setup_time.text.substr(0,this.setup_time.text.indexOf(".")));
					minutes = parseInt(this.setup_time.text.substr(this.setup_time.text.indexOf(".")+1));
				} else {
					hours = parseInt(this.setup_time.text);
				}
				job.setupTime = (hours * 60) + minutes;
				this.setProductionData();
				break;
			case this.run_time:
				var hours:Number = 0;
				var minutes:Number = 0;
				if (this.run_time.text.indexOf(":") != -1) {
					hours = parseInt(this.run_time.text.substr(0,this.run_time.text.indexOf(":")));
					minutes = parseInt(this.run_time.text.substr(this.run_time.text.indexOf(":")+1));
				} if (this.run_time.text.indexOf(".") != -1) {
					hours = parseInt(this.run_time.text.substr(0,this.run_time.text.indexOf(".")));
					minutes = parseInt(this.run_time.text.substr(this.run_time.text.indexOf(".")+1));
				} else {
					hours = parseInt(this.run_time.text);
				}
				job.runTime = (hours * 60) + minutes;
				this.setProductionData();
				break;
			case this.washup_time:
				var hours:Number = 0;
				var minutes:Number = 0;
				if (this.washup_time.text.indexOf(":") != -1) {
					hours = parseInt(this.washup_time.text.substr(0,this.washup_time.text.indexOf(":")));
					minutes = parseInt(this.washup_time.text.substr(this.washup_time.text.indexOf(":")+1));
				} if (this.washup_time.text.indexOf(".") != -1) {
					hours = parseInt(this.washup_time.text.substr(0,this.washup_time.text.indexOf(".")));
					minutes = parseInt(this.washup_time.text.substr(this.washup_time.text.indexOf(".")+1));
				} else {
					hours = parseInt(this.washup_time.text);
				}
				job.washupTime = (hours * 60) + minutes;
				this.setProductionData();
				break;
		}
		
		if (doUpdatePrice)
			this.updatePrice();
		
	}
	
	private function updatePrice():void
	{
		var priceJobEvent:PriceJobEvent = new PriceJobEvent(this.job, new mx.rpc.Responder(handlePriceJobComplete, handlePriceJobFault));
		priceJobEvent.dispatch();
	}
	
	private function handlePriceJobComplete(ev:ResultEvent):void
	{
		this.job = ev.result as Job;
		this.setProductionData();
	}
	
	private function handlePriceJobFault(ev:FaultEvent):void
	{
		if (ev != null && ev.fault != null && ev.fault.faultString != null) {				
			Alert.show(ev.fault.faultString, "Error in Pricing", 0, null);
		} else {
			Alert.show("Unknown error when pricing job", "Error in Pricing", 0, null);
		}
	}
	
	private function doOK():void
	{
		PopUpManager.removePopUp(this);
	}

	private function doCancel():void
	{
		PopUpManager.removePopUp(this);
	}
]]>
                             
</mx:Script>
<mx:Canvas width="914" height="459" dropShadowEnabled="false" horizontalScrollPolicy="off" verticalScrollPolicy="off" id="canvas1">
	<mx:Label x="10" y="10" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.ParentSize')}" width="120" textAlign="right" id="parent_size_label"/>
	<mx:Label x="379" y="31" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Area')}" width="101" textAlign="right" id="label10"/>
	<mx:Text x="488" y="31" text="" width="60" textAlign="right" id="area"/>
	<mx:Label x="380" y="12" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Out')}" width="100" textAlign="right" id="label11"/>
	<mx:Label x="595" y="23" text="Proof Back:" width="97" textAlign="right" id="prod_date_2"/>
	<mx:Label x="595" y="44" text="Blueline:" width="97" textAlign="right" id="prod_date_3"/>
	<mx:Label x="595" y="65" text="Blueline Back:" width="97" textAlign="right" id="prod_date_4"/>
	<mx:Label x="595" y="2" text="Type Setting:" width="97" textAlign="right" id="prod_date_1"/>
	<mx:Label x="595" y="151" text="Copied:" width="97" textAlign="right" id="prod_date_8"/>
	<mx:Label x="595" y="172" text="Bindery:" width="97" textAlign="right" id="prod_date_9"/>
	<mx:Label x="595" y="253" text="Mailing:" width="97" textAlign="right" id="prod_date_13"/>
	<mx:Label x="595" y="193" text="Cut:" width="97" textAlign="right" id="prod_date_10"/>
	<mx:Label x="595" y="235" text="Finished:" width="97" textAlign="right" id="prod_date_12"/>
	<mx:Label x="595" y="213" text="Folded:" width="97" textAlign="right" id="prod_date_11"/>
	<mx:Label x="595" y="274" text="Outside Service:" width="97" textAlign="right" id="prod_date_14"/>
	<mx:Label x="595" y="130" text="Printed:" width="97" textAlign="right" id="prod_date_7"/>
	<mx:Label x="595" y="296" text="Other:" width="97" textAlign="right" id="prod_date_15"/>
	<mx:Label x="595" y="319" text="Delivered:" width="97" textAlign="right" id="prod_date_16"/>
	<mx:Label x="595" y="86" text="Stock Cut:" width="97" textAlign="right" id="prod_date_5"/>
	<mx:Label x="595" y="107" text="At Press:" width="97" textAlign="right" id="prod_date_6"/>
	<mx:Label x="380" y="54" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.per')}" width="100" textAlign="right" id="label9"/>
	<mx:TextInput x="488" y="10" text="" width="60" textAlign="right" height="20" id="number_out" change="doNumOutChange()" focusOut="fieldChanged(event)"/>
	<mx:TextInput x="488" y="52" width="61" textAlign="right" height="20" id="per" change="doPerChange()" focusOut="fieldChanged(event)"/>
	<mx:Label x="380" y="75" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Markup')}" width="100" textAlign="right" id="label1"/>
	<mx:TextInput x="488" y="73" width="61" textAlign="right" height="20" id="markup" change="doMarkupChange()" focusOut="fieldChanged(event)"/>
	<mx:Text x="138" y="69" width="84" textAlign="right" id="production_run"/>
	<mx:Label x="10" y="69" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.ProductionRun')}" width="120" textAlign="right" id="label8"/>
	<mx:Text x="138" y="90" width="84" textAlign="right" id="requires"/>
	<mx:Text x="230" y="91" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.parentsheets')}" width="101" textAlign="right" fontWeight="bold" height="17" id="text1"/>
	<mx:Text x="138" y="111" width="84" textAlign="right" id="sheets_purchased"/>
	<mx:Text x="138" y="132" width="262" textAlign="right" id="copier"/>
	<mx:Label x="10" y="132" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Copier')}" width="120" textAlign="right" id="copier_label"/>
	<mx:Label x="10" y="132" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Press')}" width="120" textAlign="right" id="press_label"/>
	<mx:Label x="10" y="90" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Requires')}" width="120" textAlign="right" id="requires_label"/>
	<mx:Label x="10" y="111" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.SheetsPurchased')}" width="120" textAlign="right" id="sheets_purchased_label"/>
	<mx:Label x="10" y="29" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.PressRunSize')}" width="120" textAlign="right" id="label6"/>
	<mx:Label x="10" y="50" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.ParentCosts')}" width="120" textAlign="right" id="label7"/>
	<mx:TextInput x="138" y="48" height="20" width="84" textAlign="right" id="parent_costs" change="doParentCostChange()" focusOut="fieldChanged(event)"/>
	<mx:Label x="10" y="153" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.CopierSpeed')}" width="120" textAlign="right" id="copier_speed_label"/>
	<mx:Label x="10" y="153" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.PressSpeed')}" width="120" textAlign="right" id="press_speed_label"/>
	<mx:TextInput x="138" y="153" height="20" fontSize="9" width="84" textAlign="right" id="copier_speed" change="doCopierSpeedChange()" focusOut="fieldChanged(event)"/>
	<mx:Panel x="256" y="157" width="293" height="199" layout="absolute" borderStyle="solid" dropShadowEnabled="false" headerHeight="0" borderThickness="2" verticalScrollPolicy="off" horizontalScrollPolicy="off">
		<mx:Text x="59" y="4" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Cost')}" fontWeight="bold" textDecoration="underline" width="70" textAlign="right" height="17"/>
		<mx:Text x="0" y="22" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Stock')}" fontWeight="bold" width="51" textAlign="right" height="29"/>
		<mx:Text x="0" y="44" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Labor')}" fontWeight="bold" width="51" textAlign="right" height="19"/>
		<mx:Text x="93" y="66" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.ItemizedMarkups')}" fontWeight="bold" width="101" textAlign="right" height="18"/>
		<mx:Text x="93" y="87" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.OtherCharges')}" fontWeight="bold" width="101" textAlign="right" height="18"/>
		<mx:Text x="93" y="108" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Production')}" fontWeight="bold" height="18" width="101" textAlign="right"/>
		<mx:Text x="93" y="129" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.TargetAdjust')}" fontWeight="bold" height="18" width="101" textAlign="right"/>
		<mx:Text x="131" y="4" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Markup')}" fontWeight="bold" textDecoration="underline" width="70" textAlign="right" height="17"/>
		<mx:Text x="202" y="4" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.Price')}" fontWeight="bold" height="17" textDecoration="underline" width="68" textAlign="right"/>
		<mx:Text x="59" y="22" height="20" fontSize="9" width="70" textAlign="right" id="stock_cost" text="0.00"/>
		<mx:Text x="131" y="22" height="20" fontSize="9" width="70" textAlign="right" id="stock_markup" text="0.00"/>
		<mx:Text x="202" y="22" height="20" fontSize="9" width="70" textAlign="right" id="stock_price" text="0.00"/>
		<mx:Text x="59" y="43" height="20" fontSize="9" width="70" textAlign="right" id="labor_cost" text="0.00"/>
		<mx:Text x="131" y="43" height="20" fontSize="9" width="70" textAlign="right" id="labor_markup" text="0.00"/>
		<mx:Text x="202" y="43" height="20" fontSize="9" width="70" textAlign="right" id="labor_price" text="0.00"/>
		<mx:Text x="202" y="64" height="20" fontSize="9" width="70" textAlign="right" id="itemized_markups" text="0.00"/>
		<mx:Text x="202" y="85" height="20" fontSize="9" width="70" textAlign="right" id="other_charges" text="0.00"/>
		<mx:Text x="202" y="127" height="20" fontSize="9" width="70" textAlign="right" id="target_adjust" text="N/A"/>
		<mx:Text x="93" y="159" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.JobPrice')}" fontWeight="bold" height="18" width="101" textAlign="right"/>
		<mx:Text x="202" y="159" height="20" fontSize="9" width="70" textAlign="right" id="job_price" text="0.00"/>
		<mx:TextInput x="202" y="106" height="20" fontSize="9" width="70" textAlign="right" id="production" text="0.00" change="doProductionPriceChange()" focusOut="fieldChanged(event)"/>
		<mx:HRule x="197" y="154" width="82" height="1" strokeWidth="1"/>
		<mx:HRule x="197" y="152" width="82" height="1" strokeWidth="1"/>
	</mx:Panel>
	<mx:Button x="10" y="407" label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'rButtonLabel.Cancel')}" id="cancel_btn" width="90" click="this.doCancel();"/>
	<mx:Button x="10" y="367" label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'rButtonLabel.OK')}" width="90" id="ok_btn" click="this.doOK();"/>
	<mx:Button x="132" y="407" label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.ShowCutout')}" id="show_cutout_btn" width="90" click="doPaperCal()"/>
	<mx:Panel width="212" height="125" layout="absolute" borderStyle="solid" dropShadowEnabled="false" headerHeight="0" borderThickness="2" x="10" y="177">
		<mx:Label x="-4" y="12" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.SetupTime')}" width="96" textAlign="right" id="label2"/>
		<mx:TextInput x="100" y="10" height="20" width="84" textAlign="right" id="setup_time" text="0:00" focusOut="fieldChanged(event)"/>
		<mx:Label x="-4" y="33" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.RunTime')}" width="96" textAlign="right" id="label3"/>
		<mx:TextInput x="100" y="31" height="20" width="84" textAlign="right" id="run_time" text="0:00" focusOut="fieldChanged(event)"/>
		<mx:Label x="-4" y="54" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.WashupTime')}" width="96" textAlign="right" id="label4"/>
		<mx:TextInput x="100" y="52" height="20" width="84" textAlign="right" id="washup_time" text="0:00" focusOut="fieldChanged(event)"/>
		<mx:Label x="-5" y="87" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'jobDataCmd.TotalTime')}" width="96" textAlign="right" id="label5"/>
		<mx:TextInput x="100" y="85" height="20" width="84" textAlign="right" id="total_time" text="0:00" focusOut="fieldChanged(event)" editable="false" enabled="true"/>
		<mx:HRule x="95" y="79" width="93" height="1" strokeWidth="1" id="hrule2"/>
		<mx:HRule x="95" y="77" width="93" height="1" strokeWidth="1" id="hrule1"/>
	</mx:Panel>
	<mx:ComboBox x="138" y="8" width="84" id="parent_size" labelField = "name" dataProvider="{dimensionsArray}" editable="true" focusOut="" height="20" enabled="false"></mx:ComboBox>
	<mx:ComboBox x="138" y="30" width="84" id="run_size" labelField="name" focusOut="runSizeLostFocus()" dataProvider="{dimensionsArray}" editable="true" height="20"></mx:ComboBox>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="0" height="23" showSeconds="false" dataHolder="{job}" variableName="typeSettingDate" customText="{job.typeSettingDate}" is24Hour="false"  disabledColor="#000000" id="typeSettingTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="0" width="100" id="typeSettingDate" dataProvider="{job.typeSettingDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="20" height="23" showSeconds="false" dataHolder="{job}" variableName="proofBackDate" customText="{job.proofBackDate}" is24Hour="false"  disabledColor="#000000" id="proofBackTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="20" width="100" id="proofBackDate" dataProvider="{job.proofBackDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="40" height="23" showSeconds="false" dataHolder="{job}" variableName="bluelineDate" customText="{job.bluelineDate}" is24Hour="false"  disabledColor="#000000" id="bluelineTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="40" width="100" id="bluelineDate" dataProvider="{job.bluelineDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="60" height="23" showSeconds="false" dataHolder="{job}" variableName="bluelineBackDate" customText="{job.bluelineBackDate}" is24Hour="false"  disabledColor="#000000" id="bluelineBackTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="60" width="100" id="bluelineBackDate" dataProvider="{job.bluelineBackDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="81" height="23" showSeconds="false" dataHolder="{job}" variableName="stockCutDate" customText="{job.stockCutDate}" is24Hour="false"  disabledColor="#000000" id="stockCutTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="81" width="100" id="stockCutDate" dataProvider="{job.stockCutDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="102" height="23" showSeconds="false" dataHolder="{job}" variableName="atPressDate" customText="{job.atPressDate}" is24Hour="false"  disabledColor="#000000" id="atPressTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="102" width="100" id="atPressDate" dataProvider="{job.atPressDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="125" height="23" showSeconds="false" dataHolder="{job}" variableName="printedDate" customText="{job.printedDate}" is24Hour="false"  disabledColor="#000000" id="printedTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="125" width="100" id="printedDate" dataProvider="{job.printedDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="146" height="23" showSeconds="false" dataHolder="{job}" variableName="copiedDate" customText="{job.copiedDate}" is24Hour="false"  disabledColor="#000000" id="copiedTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="146" width="100" id="copiedDate" dataProvider="{job.copiedDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="166" height="23" showSeconds="false" dataHolder="{job}" variableName="binderyDate" customText="{job.binderyDate}" is24Hour="false"  disabledColor="#000000" id="binderyTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="166" width="100" id="binderyDate" dataProvider="{job.binderyDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="188" height="23" showSeconds="false" dataHolder="{job}" variableName="cutDate" customText="{job.cutDate}" is24Hour="false"  disabledColor="#000000" id="cutTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="188" width="100" id="cutDate" dataProvider="{job.cutDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="210" height="23" showSeconds="false" dataHolder="{job}" variableName="foldedDate" customText="{job.foldedDate}" is24Hour="false"  disabledColor="#000000" id="foldedTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="210" width="100" id="foldedDate" dataProvider="{job.foldedDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="230" height="23" showSeconds="false" dataHolder="{job}" variableName="finishedDate" customText="{job.finishedDate}" is24Hour="false"  disabledColor="#000000" id="finishedTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="230" width="100" id="finishedDate" dataProvider="{job.finishedDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="252" height="23" showSeconds="false" dataHolder="{job}" variableName="mailingDate" customText="{job.mailingDate}" is24Hour="false"  disabledColor="#000000" id="mailingTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="252" width="100" id="mailingDate" dataProvider="{job.mailingDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="274" height="23" showSeconds="false" dataHolder="{job}" variableName="outsideServiceDate" customText="{job.outsideServiceDate}" is24Hour="false"  disabledColor="#000000" id="outsideServiceTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="274" width="100" id="outsideServiceDate" dataProvider="{job.outsideServiceDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="295" height="23" showSeconds="false" dataHolder="{job}" variableName="otherDate" customText="{job.otherDate}" is24Hour="false"  disabledColor="#000000" id="otherTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="295" width="100" id="otherDate" dataProvider="{job.otherDate}"/>
	<ns1:CustomTimeEntryDateComponent width="103" x="802" y="317" height="23" showSeconds="false" dataHolder="{job}" variableName="deliveredDate" customText="{job.deliveredDate}" is24Hour="false"  disabledColor="#000000" id="deliveredTime">
	</ns1:CustomTimeEntryDateComponent>
	<mx:DateField x="700" y="317" width="100" id="deliveredDate" dataProvider="{job.deliveredDate}"/>
</mx:Canvas>

</mx:Panel>