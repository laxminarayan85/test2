<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" 
	layout="vertical" creationPolicy="all" 
	preinitialize="preInit();"
 	implements="com.efi.mdi.IMDIWindowAware,com.efi.printsmith.security.ISecureComponent"
 
	xmlns:fc="http://www.adobe.com/2006/fc" 
	xmlns:vo="com.efi.printsmith.vo.*"
	xmlns:cmp="com.efi.printsmith.components.*"
	xmlns:vld="com.efi.printsmith.validators.*"
	xmlns:prefcomp="com.efi.printsmith.components.preferences.*"
	xmlns:components="com.efi.printsmith.common.components.*"
	width="100%" height="100%" 
	headerHeight="0"
	title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'genericPrefCmd.Preferences')}"
	label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'genericPrefCmd.Preferences')}" 
	name="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'genericPrefCmd.Preferences')}" 
	xmlns:ns1="com.efi.printsmith.components.*"
	>

<mx:Metadata>
 	[Protected(permissions="Preferences_Behavior",notInPermissionAction="disable",componentId="behavior_canvas")]
 	[Protected(permissions="Preferences_Company",notInPermissionAction="disable",componentId="company_canvas")]
 	[Protected(permissions="Preferences_BusinessCalendar",notInPermissionAction="disable",componentId="calendar_canvas")]
 	[Protected(permissions="Preferences_Numbers",notInPermissionAction="disable",componentId="numbers_canvas")]
 	[Protected(permissions="Preferences_AlternateCurrency",notInPermissionAction="disable",componentId="alternatecurrency_canvas")]
 	[Protected(permissions="Preferences_International",notInPermissionAction="disable",componentId="international_canvas")]
 	[Protected(permissions="Preferences_AddressFormatting",notInPermissionAction="disable",componentId="addressformatting_canvas")]
 	
 	[Protected(permissions="Preferences_Receipt",notInPermissionAction="disable",componentId="receipt_canvas")]
 	[Protected(permissions="Preferences_CashDrawer",notInPermissionAction="disable",componentId="cashdrawer_canvas")]
 	[Protected(permissions="Preferences_CashRegister",notInPermissionAction="disable",componentId="cashregister_canvas")]
 	[Protected(permissions="Preferences_PendingList",notInPermissionAction="disable",componentId="pendinglist_canvas")]

 	[Protected(permissions="Preferences_EstimatorBehavior",notInPermissionAction="disable",componentId="estimatorbehavior_canvas")]
 	[Protected(permissions="Preferences_EstimatorPrinting",notInPermissionAction="disable",componentId="estimatorprinting_canvas")]
 	[Protected(permissions="Preferences_PaperCalculator",notInPermissionAction="disable",componentId="papercalculator_canvas")]
 	[Protected(permissions="Preferences_JobTicket",notInPermissionAction="disable",componentId="jobticket_canvas")]
 	[Protected(permissions="Preferences_QuantityBreaks",notInPermissionAction="disable",componentId="quantitybreaks_canvas")]
 	[Protected(permissions="Preferences_Markups",notInPermissionAction="disable",componentId="markups_canvas")]
 	[Protected(permissions="Preferences_StocksandSizes",notInPermissionAction="disable",componentId="stocksizes_canvas")]
 	[Protected(permissions="Preferences_StockDefinitions",notInPermissionAction="disable",componentId="stockdefinitions_canvas")]
 	[Protected(permissions="Preferences_PricingMethod",notInPermissionAction="disable",componentId="pricingmethod_canvas")]
 	 	
 	[Protected(permissions="Preferences_CreditDefaults",notInPermissionAction="disable",componentId="creditdefaults_canvas")]
 	[Protected(permissions="Preferences_AgingPeriods",notInPermissionAction="disable",componentId="agingperiods_canvas")]
 	[Protected(permissions="Preferences_SalesCategories",notInPermissionAction="disable",componentId="salescategories_canvas")]
 	[Protected(permissions="Preferences_GLProfiles",notInPermissionAction="disable",componentId="glprofiles_canvas")]
 	[Protected(permissions="Preferences_CreditCardInfo",notInPermissionAction="disable",componentId="creditcards_canvas")]
 	[Protected(permissions="Preferences_OrderNumFormat",notInPermissionAction="disable",componentId="ordernumberformat_canvas")]
 	[Protected(permissions="Preferences_JournalEntries",notInPermissionAction="disable",componentId="journalentries_canvas")]

 	[Protected(permissions="Preferences_Integration",notInPermissionAction="disable",componentId="fiery_canvas")]
 	 	
</mx:Metadata>	
	<mx:Script source="../common/scripts/Validation.as"/>
	<mx:Script source="../common/scripts/CommonUtils.as"/>
 <mx:Script source="../security/PSSecurityInclude.as" />
 	<mx:RemoteObject id="dataServiceSystem" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadSystemResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveSystemResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServicePOS" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadPOSResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSavePOSResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceEstimator" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadEstimatorResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveEstimatorResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceAccounting" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadAccountingResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveAccountingResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceCountry" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadCountryResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveCountryResult(event)"/>
	</mx:RemoteObject>
	 	<mx:RemoteObject id="dataServiceCashRegister" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadCashRegisterResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveCashRegisterResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceCreditCard" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadCreditCardResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveCreditCardResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceMarkups" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadMarkupsResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveMarkupsResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceMarkupsMerchandise" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadMarkupsMerchandiseResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveMarkupsMerchandiseResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServicePendingList" destination="dataService">
		<mx:method name="getAllOrderBy" fault="handleFault(event)" result="handleLoadPendingListResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSavePendingListResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServicePricingMethod" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadPricingMethodResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSavePricingMethodResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceQuantityBreaks" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadQuantityBreaksResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveQuantityBreaksResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceSalesCategory" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadSalesCategoryResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveSalesCategoryResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceStockDefinition" destination="dataService">
		<mx:method name="getAllOrderBy" fault="handleFault(event)" result="handleLoadStockDefinitionResult(event)"/>
		<mx:method name="addUpdateDeleteList" fault="handleFault(event)" result="handleSaveStockDefinitionResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceStocks" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadStocksResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveStocksResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceColumnNames" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadColumnNamesResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveColumnNamesResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceSizeTable" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadSizeTableResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveSizeTableResult(event)"/>
	</mx:RemoteObject>
 	<mx:RemoteObject id="dataServiceCategory" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadCategoryResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveCategoryResult(event)"/>
	</mx:RemoteObject>
	<mx:RemoteObject id="dataServiceIntegration" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadIntegrationResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveIntegrationResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceEstimatorTypes" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadEstimatorTypesResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceTaxTables" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadTaxTablesResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceTaxCodes" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadTaxCodesResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceJobMethods" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadJobMethodsResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceSalesReps" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadSalesRepsResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceShippingMethods" destination="dataService">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadShippingMethodsResult(event)"/>
	</mx:RemoteObject>

	<!--<mx:Producer id="producer" destination="systempreferences"/>
	<mx:Consumer id="consumer" destination="systempreferences" message="messageHandler(event.message)"/>
	<mx:Consumer id="notification_consumer" destination="notifications" message="messageHandler(event.message)"/>-->
<mx:Script>                                   
<![CDATA[
	import com.efi.printsmith.security.PSSecurityUtils;
	import mx.utils.StringUtil;
	import mx.events.FlexEvent;
	import com.efi.printsmith.security.PSSecurityCommands;
	import com.efi.mdi.event.window.WindowSaveSuccessEvent;
	import com.efi.mdi.view.window.MDIWindow;
	import com.efi.printsmith.data.ShippingMethod;
	import com.efi.printsmith.data.SalesRep;
	import com.efi.printsmith.common.components.CommonLoadComponent;
	import com.efi.printsmith.components.preferences.events.ConfirmStatusEvent;
	import com.efi.printsmith.components.preferences.PreferencesConfirmComponent;
	import mx.utils.ObjectUtil;
	import com.efi.printsmith.common.components.CustomStringTextInputComponent;
	import mx.formatters.NumberFormatter;
	import mx.formatters.CurrencyFormatter;
	import mx.formatters.NumberBase;
	import mx.formatters.Formatter;
	import com.efi.printsmith.data.Merchandise;
	import com.efi.printsmith.data.OutsideService;
	import com.efi.printsmith.data.TaxTable;
	import com.efi.printsmith.data.TaxCodes;
	import mx.controls.Text;
	import com.efi.printsmith.itemRenderers.JobMethodEditor;
	import com.efi.printsmith.itemRenderers.EstimatorTypesEditor;
	import com.efi.printsmith.itemRenderers.SalesCategoryEditor;
	import com.efi.printsmith.itemRenderers.TaxCodeEditor;
	import com.efi.printsmith.itemRenderers.TaxTableEditor;
			
	import com.efi.printsmith.data.PreferencesAccounting;
	import com.efi.printsmith.data.PreferencesEstimating;
	import com.efi.printsmith.data.PreferencesPOS;
	import com.efi.printsmith.data.PreferencesSystem;
	import com.efi.printsmith.data.PreferencesCashRegister;
	
	import com.efi.printsmith.data.PreferencesCreditCard;
	import com.efi.printsmith.data.PreferencesMarkups;
	import com.efi.printsmith.data.PreferencesPendingList;
	import com.efi.printsmith.data.PreferencesPricingMethod;
	import com.efi.printsmith.data.PreferencesQuantityBreaks;
	import com.efi.printsmith.data.PreferencesSalesCategory;
	import com.efi.printsmith.data.PreferencesStockDefinition;
	import com.efi.printsmith.data.PreferencesStocks;
	
	import com.efi.printsmith.data.PreferencesIntegration;
	
	import com.efi.printsmith.data.Country;
	import com.efi.printsmith.data.ColumnNames;
	import com.efi.printsmith.data.SizeTable;
	import com.efi.printsmith.data.SalesCategory;
	
	import mx.events.AdvancedDataGridEvent
	import mx.events.AdvancedDataGridEventReason
	
    import mx.events.DataGridEvent;
    import mx.events.DataGridEventReason;
	import mx.controls.Alert;                                         
	import mx.managers.PopUpManager;                                         
	import mx.containers.TitleWindow;                                         
	import mx.collections.ArrayCollection;                                         
	import mx.rpc.events.ResultEvent;                                         
	import mx.rpc.events.FaultEvent;                                         
	import mx.messaging.messages.AsyncMessage;
	import mx.messaging.messages.IMessage;
	import mx.collections.XMLListCollection;
	import mx.rpc.Responder;
	
   	import com.efi.printsmith.events.commandEvents.SystemPreferences.*;

	[Bindable]
	private var enableSave:Boolean = true;
	
	[Bindable] private var isReverted:Boolean = false;
	
	[Bindable] private var isLoad:Boolean = false;
	
	[Bindable] private var isRevert:Boolean = false;
	
	[Bindable] private var isSave:Boolean = false;
	
	[Bindable] private var loadComponent:CommonLoadComponent;
	
	[Bindable] private var checkCount:int=0;
	
	[Bindable] private var successCheckCount:int=0;

	[Bindable]
	private var currentnumberstext:String = "";

//Data field arrays
	[Bindable]
	private var PreferencesSystemArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesEstimatingArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesAccountingArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesCashRegisterArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesCashRegisterOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesCreditCardArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesCreditCardOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesMarkupsArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesMarkupsOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesMarkupsMerchandiseArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesMarkupsMerchandiseOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesPendingListArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesPendingListOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesPricingMethodArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesPricingMethodOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesQuantityBreaksArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesQuantityBreaksOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesSalesCategoryArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesSalesCategoryOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesStockDefinitionArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesStockDefinitionOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesStocksArray:ArrayCollection = new ArrayCollection();

	[Bindable]
	private var PreferencesCashRegisterDeleteArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesMarkupsDeleteArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesMarkupsMerchandiseDeleteArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesPricingMethodDeleteArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesSalesCategoryDeleteArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesCreditCardDeleteArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var PreferencesQuantityBreaksDeleteArray:ArrayCollection = new ArrayCollection();

//AutoComplete arrays
	[Bindable]
	private var CountryArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var CountryOrigArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var ColumnNamesArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var SizeTableArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var CategoryArray:ArrayCollection = new ArrayCollection();

//Combo box arrays
	[Bindable]
	private var DaysArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var MonthsArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var ReceiptPrinterArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var BaudRateArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var StopBitsArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var ParityArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var DataSizeArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var DefaultInvoiceArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var DefaultEstimateArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var RunToFinishGrainArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var JobTicketStylesArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var AccountingPackagesArray:ArrayCollection = new ArrayCollection();
	[Bindable]
	private var JournalDocumentPreferenceArray:ArrayCollection = new ArrayCollection();

//Radio Buttons
	[Bindable]
	private var opgFirstDayOfWorkWeekValue:int = 1;
	[Bindable]
	private var optPaymentDueDaysValue:String = "1";
	[Bindable]
	private var opgChargeDescriptionValue:String = "1";
	
	[Bindable]
	private var folioLocationValue:String ;
	[Bindable]
	private var gripLocationValue:String;

	
//Data view variables
	[Bindable]
	private var preferencesSystem:PreferencesSystem;
	
	[Bindable]
	private var preferencesSystemOrigObj:PreferencesSystem;

	[Bindable]                                         
	private var preferencesPOS:PreferencesPOS;
	
	[Bindable]                                         
	private var preferencesPOSOrigObj:PreferencesPOS;

	[Bindable]                                         
	private var preferencesEstimating:PreferencesEstimating;
	
	[Bindable]                                         
	private var preferencesEstimatingOrigObj:PreferencesEstimating;

	[Bindable]                                         
	private var preferencesAccounting:PreferencesAccounting;
	
	[Bindable]                                         
	private var preferencesAccountingOrigObj:PreferencesAccounting;

	[Bindable]
	private var preferencesStocks:PreferencesStocks;
	
	[Bindable]
	private var preferencesStocksOrigObj:PreferencesStocks;
	
	[Bindable]
	private var preferencesCashRegister:PreferencesCashRegister;
	
	[Bindable]
	private var preferencesCashRegisterOrigObj:PreferencesCashRegister;
		
	[Bindable]
	private var preferencesIntegration:PreferencesIntegration;
	
	[Bindable]
	private var preferencesIntegrationOrigObj:PreferencesIntegration;
	
	[Bindable]
	private var country:Country;
	
	[Bindable] public var numberCanvasTextInput:CustomStringTextInputComponent;
	
	[Bindable] public var estimatorTypesArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var taxTablesArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var taxCodesArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var jobMethodsArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var salesRepsArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var shippingMethodsArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var selectedSection:String="";
	
	[Bindable] public var selectedIndexSelection:int;
	
	[Bindable] public var addressLayoutArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var countryAddArray:ArrayCollection = new ArrayCollection();
	
	[Bindable] public var countryDeleteArray:ArrayCollection = new ArrayCollection();
	
	private var dollar:String = "$"; 
	private var yen:String = "¥";
	private var euro:String = "€";
	
//Tree view XML table
	[Bindable]
	private var treeData:XML =
    	<root>
			<node label="genericPrefCmd.System" isBranch="true" command="Preferences_System" >
				<node label="genericPrefCmd.Behavior" isBranch="false" tag="0" command="Preferences_Behavior" />
				<node label="genericPrefCmd.Company" isBranch="false" tag="1" command="Preferences_Company"/>
				<node label="genericPrefCmd.BusinessCalendar" isBranch="false" tag="2" command="Preferences_BusinessCalendar"/>
				<node label="genericPrefCmd.Numbers" isBranch="false" tag="3" command="Preferences_Numbers"/>
				<node label="genericPrefCmd.AlternateCurrency" isBranch="false" tag="4" command="Preferences_AlternateCurrency"/>
				<node label="genericPrefCmd.International" isBranch="false" tag="5" command="Preferences_International"/>
				<node label="genericPrefCmd.AddressFormatting" isBranch="false" tag="6" command="Preferences_AddressFormatting"/>
			</node>
			<node label="genericPrefCmd.POS" isBranch="true" command="Preferences_POS">
				<node label="genericPrefCmd.Receipt" isBranch="false" tag="7" command="Preferences_Receipt"/>
				<node label="genericPrefCmd.CashDrawer" isBranch="false" tag="8" command="Preferences_CashDrawer"/>
				<node label="genericPrefCmd.CashRegister" isBranch="false" tag="9" command="Preferences_CashRegister"/>
				<node label="genericPrefCmd.PendingList" isBranch="false" tag="10" command="Preferences_PendingList"/>
			</node>
			<node label="genericPrefCmd.Estimator" isBranch="true" command="Preferences_Estimator">
				<node label="genericPrefCmd.EstimatorBehavior" isBranch="false" tag="11" command="Preferences_EstimatorBehavior"/>
				<node label="genericPrefCmd.EstimatorPrinting" isBranch="false" tag="12" command="Preferences_EstimatorPrinting"/>
				<node label="genericPrefCmd.PaperCalculator" isBranch="false" tag="13" command="Preferences_PaperCalculator"/>
				<node label="genericPrefCmd.JobTicket" isBranch="false" tag="14" command="Preferences_JobTicket"/>
				<node label="genericPrefCmd.QuantityBreaks" isBranch="false" tag="15" command="Preferences_QuantityBreaks"/>
				<node label="genericPrefCmd.Markups" isBranch="false" tag="16" command="Preferences_Markups"/>
				<node label="genericPrefCmd.StocksandSizes" isBranch="false" tag="17" command="Preferences_StocksandSizes"/>
				<node label="genericPrefCmd.StockDefinitions" isBranch="false" tag="18" command="Preferences_StockDefinitions"/>
				<node label="genericPrefCmd.PricingMethod" isBranch="false" tag="19" command="Preferences_PricingMethod"/>
			</node>			
			<node label="genericPrefCmd.Accounting" isBranch="true" command="Preferences_Accounting">
				<node label="genericPrefCmd.CreditDefaults" isBranch="false" tag="20" command="Preferences_CreditDefaults"/>
				<node label="genericPrefCmd.AgingPeriods" isBranch="false" tag="21" command="Preferences_AgingPeriods"/>
				<node label="genericPrefCmd.SalesCategories" isBranch="false" tag="22" command="Preferences_SalesCategories"/>
				<node label="genericPrefCmd.GLProfiles" isBranch="false" tag="23" command="Preferences_GLProfiles"/>
				<node label="genericPrefCmd.CreditCardInfo" isBranch="false" tag="24" command="Preferences_CreditCardInfo"/>
				<node label="genericPrefCmd.OrderNumberFormat" isBranch="false" tag="25" command="Preferences_OrderNumFormat"/>
				<node label="genericPrefCmd.JournalEntries" isBranch="false" tag="26" command="Preferences_JournalEntries"/>
			</node>
			<node label="genericPrefCmd.Integration" isBranch="true" command="Preferences_Integration">
				<node label="genericPrefCmd.Integration" isBranch="false" tag="27" command="Preferences_Integration"/>
			</node>
		</root>;
	
	private function fillDaysArray(fillArray:ArrayCollection):void {
		var day:Object=new Object();
		day.name="Sunday";
		fillArray.addItem(day);
		day=new Object();
		day.name="Monday";
		fillArray.addItem(day);
		day=new Object();
		day.name="Tuesday";
		fillArray.addItem(day);
		day=new Object();
		day.name="Wednesday";
		fillArray.addItem(day);
		day=new Object();
		day.name="Thursday";
		fillArray.addItem(day);
		day=new Object();
		day.name="Friday";
		fillArray.addItem(day);
		day=new Object();
		day.name="Saturday";
		fillArray.addItem(day);
		
	}

	private function fillMonthsArray(fillArray:ArrayCollection):void{
		var month:Object=new Object();
		month.name="January";
		fillArray.addItem(month);
		month=new Object();
		month.name="February";
		fillArray.addItem(month);
		month=new Object();
		month.name="March";
		fillArray.addItem(month);
		month=new Object();
		month.name="April";
		fillArray.addItem(month);
		month=new Object();
		month.name="May";
		fillArray.addItem(month);
		month=new Object();
		month.name="June";
		fillArray.addItem(month);
		month=new Object();
		month.name="July";
		fillArray.addItem(month);
		month=new Object();
		month.name="August";
		fillArray.addItem(month);
		month=new Object();
		month.name="September";
		fillArray.addItem(month);
		month=new Object();
		month.name="October";
		fillArray.addItem(month);
		month=new Object();
		month.name="November";
		fillArray.addItem(month);
		month=new Object();
		month.name="December";
		fillArray.addItem(month);
	}
	
	private function fillReceiptPrinterArray(fillArray:ArrayCollection):void{
		var printer:Object=new Object();
		printer.name="Off";
		fillArray.addItem(printer);
		printer=new Object();
		printer.name="Modem Port";
		fillArray.addItem(printer);
		printer=new Object();
		printer.name="Printer Port";
		fillArray.addItem(printer);
		printer=new Object();
		printer.name="USB Serial Port";
		fillArray.addItem(printer);
		printer=new Object();
		printer.name="Named Graphics Printer";
		fillArray.addItem(printer);
		printer=new Object();
		printer.name="Named Serial Port";
		fillArray.addItem(printer);

	}
	private function fillModemArray():void{
		var setting:Object = new Object();
		setting.name="300";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="600";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="1200";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="1800";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="2400";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="3600";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="4800";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="7200";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="9600";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="19200";
		BaudRateArray.addItem(setting);
		setting = new Object();
		setting.name="57600";
		BaudRateArray.addItem(setting);
		
		setting=new Object();
		setting.name="1 bit";
		StopBitsArray.addItem(setting);
		setting=new Object();
		setting.name="1.5 bit";
		StopBitsArray.addItem(setting);
		setting=new Object();
		setting.name="2 bit";
		StopBitsArray.addItem(setting);

		setting=new Object();
		setting.name="None";
		ParityArray.addItem(setting);
		setting=new Object();
		setting.name="Odd";
		ParityArray.addItem(setting);
		setting=new Object();
		setting.name="Even";
		ParityArray.addItem(setting);

		setting=new Object();
		setting.name="5 Bits";
		DataSizeArray.addItem(setting);
		setting=new Object();
		setting.name="6 Bits";
		DataSizeArray.addItem(setting);
		setting=new Object();
		setting.name="7 Bits";
		DataSizeArray.addItem(setting);
		setting=new Object();
		setting.name="8 Bits";
		DataSizeArray.addItem(setting);

	}
	
	private function fillDefaultDocumentsArray(fillArray:ArrayCollection):void{
		var setting:Object = new Object();
		setting.id=1;
		setting.name="No default specified";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=2;
		setting.name="Alternate Currency";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=3;
		setting.name="Credit Memo";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=4;
		setting.name="Estimate - Long Form";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=5;
		setting.name="Estimate - Short Form";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=6;
		setting.name="Fax Form";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=7;
		setting.name="Invoice - Long Form";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=8;
		setting.name="Invoice - Short Form";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=9;
		setting.name="Quote Form";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=10;
		setting.name="Quote Letter";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=11;
		setting.name="Standard";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=12;
		setting.name="Thank You Letter";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=13;
		setting.name="Unit Price / each";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=14;
		setting.name="Unit Price / thousand";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=15;
		setting.name="[en]!TaxName !Remarks";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=16;
		setting.name="[en]!TaxName +Remarks";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=17;
		setting.name="[en]+TaxName !Remarks";
		fillArray.addItem(setting);
		setting = new Object();
		setting.id=18;
		setting.name="[en]+TaxName +Remarks";
		fillArray.addItem(setting);
	}

	private function fillRunToFinishGrainArray(fillArray:ArrayCollection):void{
		var setting:Object = new Object();
		setting.name= resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'extPaperCalcCmd.Neither' );
		fillArray.addItem(setting);
		setting = new Object();
		setting.name=resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'extPaperCalcPickerCmd.MatchGrain' );
		fillArray.addItem(setting);
		setting = new Object();
		setting.name=resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'extPaperCalcCmd.SwingCombination' );
		fillArray.addItem(setting);
	}
	
	private function fillJobTicketStylesArray(fillArray:ArrayCollection):void{
		
	}
	private function fillAccountingPackagesArray(fillArray:ArrayCollection):void{
		var setting:Object = new Object();
		setting.name="MYOB";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="Peachtree Accounting";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="Quickbooks";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="MultiLedger";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="SAGE Accounting";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="Simply Accounting";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="BusinessWorks";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="Great Plains Import Manager";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="SAGE Line 50";
		fillArray.addItem(setting);
		setting = new Object();
		setting.name="Peachtree CSV";
		fillArray.addItem(setting);
	}
	
	private function fillAddressLayoutArray():void{
		var layoutOption:Object = new Object();
		layoutOption.name = "";
		addressLayoutArray.addItem(layoutOption);
		layoutOption = new Object();
		layoutOption.name = "Street1";
		addressLayoutArray.addItem(layoutOption);
		layoutOption = new Object();
		layoutOption.name = "Street2";
		addressLayoutArray.addItem(layoutOption);
		layoutOption = new Object();
		layoutOption.name = "City";
		addressLayoutArray.addItem(layoutOption);
		layoutOption = new Object();
		layoutOption.name = "State";
		addressLayoutArray.addItem(layoutOption);
		layoutOption = new Object();
		layoutOption.name = "Zip";
		addressLayoutArray.addItem(layoutOption);
		layoutOption = new Object();
		layoutOption.name = "Country";
		addressLayoutArray.addItem(layoutOption);
	}

    public function getSecurityCommand():String {
    	return PSSecurityCommands.ADMIN_PREFERENCES;
    }		
	public function init(event:FlexEvent=null):void {

		this.currentState="";
		
		var mdiWin:MDIWindow = Snowmass.getInstance().containerManager.getWindowWithChild(this);
		mdiWin.title = resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'genericPrefCmd.Preferences');
		
		isLoad = true;
		checkCount = 22;
		loadComponent = PopUpManager.createPopUp(this,CommonLoadComponent,true) as CommonLoadComponent;

		fillStaticData();
		
		getPreferencesData();

		openTree();
		setup();
		
		/*var eventbehavior:SystemPreferencesBehaviorPanelEvent = new SystemPreferencesBehaviorPanelEvent(behavior_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventbehavior.dispatch();
		var eventcompany:SystemPreferencesCompanyPanelEvent = new SystemPreferencesCompanyPanelEvent(company_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventcompany.dispatch();
		var eventcalendar:SystemPreferencesBusinessCalendarPanelEvent = new SystemPreferencesBusinessCalendarPanelEvent(calendar_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventcalendar.dispatch();
		var eventnumbers:SystemPreferencesNumbersPanelEvent = new SystemPreferencesNumbersPanelEvent(numbers_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventnumbers.dispatch();
		var eventalternatecurrency:SystemPreferencesAlternateCurrencyPanelEvent = new SystemPreferencesAlternateCurrencyPanelEvent(alternatecurrency_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventalternatecurrency.dispatch();
		var eventinternational:SystemPreferencesInternationalPanelEvent = new SystemPreferencesInternationalPanelEvent(international_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventinternational.dispatch();
		var eventaddressformatting:SystemPreferencesAddressFormattingPanelEvent = new SystemPreferencesAddressFormattingPanelEvent(addressformatting_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventaddressformatting.dispatch();
		var eventreceipt:SystemPreferencesReceiptPanelEvent = new SystemPreferencesReceiptPanelEvent(receipt_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventreceipt.dispatch();
		var eventcashdrawer:SystemPreferencesCashDrawerPanelEvent = new SystemPreferencesCashDrawerPanelEvent(cashdrawer_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventcashdrawer.dispatch();
		var eventcashregister:SystemPreferencesCashRegisterPanelEvent = new SystemPreferencesCashRegisterPanelEvent(cashregister_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventcashregister.dispatch();
		var eventpendinglist:SystemPreferencesPendingListPanelEvent = new SystemPreferencesPendingListPanelEvent(pendinglist_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventpendinglist.dispatch();
		var eventestimatorbehavior:SystemPreferencesEstimatorBehaviorPanelEvent = new SystemPreferencesEstimatorBehaviorPanelEvent(estimatorbehavior_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventestimatorbehavior.dispatch();
		var eventestimatorprinting:SystemPreferencesEstimatorPrintingPanelEvent = new SystemPreferencesEstimatorPrintingPanelEvent(estimatorprinting_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventestimatorprinting.dispatch();
		var eventpapercalculator:SystemPreferencesPaperCalculatorPanelEvent = new SystemPreferencesPaperCalculatorPanelEvent(papercalculator_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventpapercalculator.dispatch();
		var eventjobticket:SystemPreferencesJobTicketPanelEvent = new SystemPreferencesJobTicketPanelEvent(jobticket_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventjobticket.dispatch();
		var eventquantitybreaks:SystemPreferencesQuantityBreaksPanelEvent = new SystemPreferencesQuantityBreaksPanelEvent(quantitybreaks_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventquantitybreaks.dispatch();
		var eventmarkups:SystemPreferencesMarkupsPanelEvent = new SystemPreferencesMarkupsPanelEvent(markups_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventmarkups.dispatch();
		var eventstocksizes:SystemPreferencesStocksandSizesPanelEvent = new SystemPreferencesStocksandSizesPanelEvent(stocksizes_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventstocksizes.dispatch();
		var eventstockdefinitions:SystemPreferencesStockDefinitionsPanelEvent = new SystemPreferencesStockDefinitionsPanelEvent(stockdefinitions_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventstockdefinitions.dispatch();
		var eventpricingmethod:SystemPreferencesPricingMethodPanelEvent = new SystemPreferencesPricingMethodPanelEvent(pricingmethod_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventpricingmethod.dispatch();
		var eventcreditdefaults:SystemPreferencesCreditDefaultsPanelEvent = new SystemPreferencesCreditDefaultsPanelEvent(creditdefaults_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventcreditdefaults.dispatch();
		var eventagingperiods:SystemPreferencesAgingPeriodsPanelEvent = new SystemPreferencesAgingPeriodsPanelEvent(agingperiods_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventagingperiods.dispatch();
		var eventsalescategories:SystemPreferencesSalesCategoriesPanelEvent = new SystemPreferencesSalesCategoriesPanelEvent(salescategories_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventsalescategories.dispatch();
		var eventglprofiles:SystemPreferencesGLProfilesPanelEvent = new SystemPreferencesGLProfilesPanelEvent(glprofiles_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventglprofiles.dispatch();
		var eventcreditcards:SystemPreferencesCreditCardInfoPanelEvent = new SystemPreferencesCreditCardInfoPanelEvent(creditcards_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventcreditcards.dispatch();
		var eventjournalentries:SystemPreferencesJournalEntriesPanelEvent = new SystemPreferencesJournalEntriesPanelEvent(journalentries_canvas, new mx.rpc.Responder(handleUIPanelEvent, handleUIPanelFault));
		eventjournalentries.dispatch();*/
		    
	}      

	public function handleUIPanelEvent(evt:ResultEvent):void {
		evt.result.panel.enabled = evt.result.enabled;
	}		
	private function handleUIPanelFault(ev:FaultEvent):void {  
	}	
	private function setup():void{
		
		for each(var element:Object in CategoryArray) {
//			CashRegisterGridSalesCategoryArray.addItem(element)
		}
	}
	
	private function fillStaticData():void{
		fillDaysArray(DaysArray);
		fillMonthsArray(MonthsArray);
		fillReceiptPrinterArray(ReceiptPrinterArray);	

		
		dataServiceColumnNames.getAll("ColumnNames");
		dataServiceSizeTable.getAll("SizeTable");
		dataServiceCategory.getAll("SalesCategory");

		fillModemArray();
		fillDefaultDocumentsArray(DefaultInvoiceArray);
		fillDefaultDocumentsArray(DefaultEstimateArray);
		fillDefaultDocumentsArray(JournalDocumentPreferenceArray)
		fillRunToFinishGrainArray(RunToFinishGrainArray);
		fillJobTicketStylesArray(JobTicketStylesArray);
		fillAccountingPackagesArray(AccountingPackagesArray);
		fillAddressLayoutArray();
	}
	
	private function getPreferencesData():void{
		dataServiceSystem.getAll("PreferencesSystem");
		dataServicePOS.getAll("PreferencesPOS");
		dataServiceEstimator.getAll("PreferencesEstimating");
		dataServiceAccounting.getAll("PreferencesAccounting");
		dataServiceCashRegister.getAll("PreferencesCashRegister");
		dataServiceCreditCard.getAll("PreferencesCreditCard");
		dataServiceMarkups.getAll("OutsideService");
		dataServiceMarkupsMerchandise.getAll("Merchandise")
		dataServicePendingList.getAllOrderBy("PreferencesPendingList","columnOrder");
		dataServicePricingMethod.getAll("PreferencesPricingMethod");
		dataServiceQuantityBreaks.getAll("PreferencesQuantityBreaks");
		dataServiceSalesCategory.getAll("SalesCategory");
		dataServiceStockDefinition.getAllOrderBy("PreferencesStockDefinition","columnOrder");
		dataServiceStocks.getAll("PreferencesStocks");
		dataServiceIntegration.getAll("PreferencesIntegration");
		dataServiceEstimatorTypes.getAll("EstimatorTypes");
		dataServiceTaxTables.getAll("TaxTable");
		dataServiceTaxCodes.getAll("TaxCodes");
		dataServiceJobMethods.getAll("JobMethod");
		dataServiceSalesReps.getAll("SalesRep");
		dataServiceShippingMethods.getAll("ShippingMethod");
		dataServiceCountry.getAll("Country");
	}

	private function updatePreferencesData():void{
		var counter:int = 1;
		checkCount = 0;
		successCheckCount = 0;
		loadComponent = PopUpManager.createPopUp(this,CommonLoadComponent,true) as CommonLoadComponent;
		if(selectedSection == "genericPrefCmd.Behavior" || selectedSection == "genericPrefCmd.Company" || selectedSection == "genericPrefCmd.BusinessCalendar"
			|| selectedSection == "genericPrefCmd.Numbers" || selectedSection == "genericPrefCmd.AlternateCurrency" || selectedSection == "genericPrefCmd.International") {
			checkCount = 1;
			dataServiceSystem.addUpdate(preferencesSystem);
		}
		
		if(selectedSection == "genericPrefCmd.AddressFormatting") {
			checkCount = 2;
			if(preferencesSystem.defaultCountry==0 && preferencesSystem.defaultCountryName!=null){
				dataServiceCountry.addUpdateDeleteList(countryAddArray,countryDeleteArray);
			} else {
				dataServiceSystem.addUpdate(preferencesSystem);
				dataServiceCountry.addUpdateDeleteList(countryAddArray,countryDeleteArray);
			}
		}
		
		if(selectedSection == "genericPrefCmd.Receipt" || selectedSection == "genericPrefCmd.CashDrawer"){
			checkCount = 1;
			dataServicePOS.addUpdate(preferencesPOS);
		}
		
		if(selectedSection == "genericPrefCmd.CashRegister"){
			checkCount = 1;
			for each(var preferencesCashRegister:PreferencesCashRegister in PreferencesCashRegisterArray){
				if(preferencesCashRegister.taxTable!=null){
					if(preferencesCashRegister.taxTable.id==-1){
						preferencesCashRegister.taxTable = null;
					}
				}
			}
			dataServiceCashRegister.addUpdateDeleteList(PreferencesCashRegisterArray,PreferencesCashRegisterDeleteArray);
			PreferencesCashRegisterDeleteArray.removeAll();
		}
		
		if(selectedSection == "genericPrefCmd.PendingList"){
			checkCount = 2;
			dataServicePOS.addUpdate(preferencesPOS);
			for each(var preferencesPendingList:PreferencesPendingList in PreferencesPendingListArray){
				if (preferencesPendingList.columnOrder != counter){
					preferencesPendingList.columnOrder = counter;
				}
				counter = counter + 1;
			}
			dataServicePendingList.addUpdateDeleteList(PreferencesPendingListArray,null);
		}
		
		if(selectedSection == "genericPrefCmd.EstimatorBehavior" || selectedSection == "genericPrefCmd.EstimatorPrinting" ||
			selectedSection == "genericPrefCmd.PaperCalculator" || selectedSection == "genericPrefCmd.JobTicket"){
			checkCount = 1;
			dataServiceEstimator.addUpdate(preferencesEstimating);
		}
		
		if(selectedSection == "genericPrefCmd.QuantityBreaks"){
			checkCount = 1;
			dataServiceQuantityBreaks.addUpdateDeleteList(PreferencesQuantityBreaksArray,PreferencesQuantityBreaksDeleteArray);
			PreferencesQuantityBreaksDeleteArray.removeAll();
		}
		
		if(selectedSection == "genericPrefCmd.Markups"){
			checkCount = 2;
			dataServiceMarkups.addUpdateDeleteList(PreferencesMarkupsArray,PreferencesMarkupsDeleteArray);
			PreferencesMarkupsDeleteArray.removeAll();
			dataServiceMarkupsMerchandise.addUpdateDeleteList(PreferencesMarkupsMerchandiseArray,PreferencesMarkupsMerchandiseDeleteArray);
			PreferencesMarkupsMerchandiseDeleteArray.removeAll();
		}
		
		if(selectedSection == "genericPrefCmd.StocksandSizes"){
			checkCount = 1;
			dataServiceStocks.addUpdate(preferencesStocks);
		}
		
		if(selectedSection == "genericPrefCmd.StockDefinitions"){
			checkCount = 1;
			for each(var preferencesStockDefinition:PreferencesStockDefinition in PreferencesStockDefinitionArray){
				if (preferencesStockDefinition.columnOrder != counter){
					preferencesStockDefinition.columnOrder = counter;
				}
				counter = counter + 1;
			}
			dataServiceStockDefinition.addUpdateDeleteList(PreferencesStockDefinitionArray,null);
		}
		
		if(selectedSection == "genericPrefCmd.PricingMethod"){
			checkCount = 1;
			dataServicePricingMethod.addUpdateDeleteList(PreferencesPricingMethodArray,PreferencesPricingMethodDeleteArray);
			PreferencesPricingMethodDeleteArray.removeAll();
		}
		
		if(selectedSection == "genericPrefCmd.CreditDefaults" || selectedSection == "genericPrefCmd.AgingPeriods" || 
			selectedSection == "genericPrefCmd.GLProfiles" || selectedSection == "genericPrefCmd.OrderNumberFormat" ||
			selectedSection == "genericPrefCmd.JournalEntries"){
				checkCount = 1;
				dataServiceAccounting.addUpdate(preferencesAccounting);
		}
		
		if(selectedSection == "genericPrefCmd.CreditCardInfo"){
			checkCount = 2;
			dataServiceAccounting.addUpdate(preferencesAccounting);
			dataServiceCreditCard.addUpdateDeleteList(PreferencesCreditCardArray,PreferencesCreditCardDeleteArray);
			PreferencesCreditCardDeleteArray.removeAll();
		}
		
		if(selectedSection == "genericPrefCmd.Integration"){
			checkCount = 1;
			dataServiceIntegration.addUpdate(preferencesIntegration);
		}
		
		if(selectedSection == "genericPrefCmd.SalesCategories"){
			checkCount = 1;
			dataServiceSalesCategory.addUpdateDeleteList(PreferencesSalesCategoryArray,PreferencesSalesCategoryDeleteArray);
			PreferencesSalesCategoryDeleteArray.removeAll();
		}
		dispatchEvent(new WindowSaveSuccessEvent(WindowSaveSuccessEvent.WINDOW_SAVESUCCESS_STATUS,true));

	}
	private function mapFromPrefereincesIntegrationData():void {
		//this.txtFieryURL.text = preferencesIntegration.fieryConnectorURL;
	}
	private function mapFromPreferencesSystemData():void {
		//check boxes
		/* preferencesSystem.enablePricingSystem = true;
		preferencesSystem.lineItemTaxes = true; */
		company_canvas.address_editor.setAddress(preferencesSystem.companyAddress);
		if(preferencesSystem.numbersIntegers !=null)
			if (preferencesSystem.numbersIntegers.length == 0){
				preferencesSystem.numbersIntegers = "###,###,###,###";
			}
		if (preferencesSystem.numbersPercentages !=null)
			if (preferencesSystem.numbersPercentages.length == 0){
				preferencesSystem.numbersPercentages = "###,##0.###%;-###,##0.###%;0%";
			}
		if (preferencesSystem.numbersAmount !=null)
			if (preferencesSystem.numbersAmount.length == 0) {
				preferencesSystem.numbersAmount = "###,###,###,##0.00";
			}
		if (preferencesSystem.numbersTaxRate !=null)
			if (preferencesSystem.numbersTaxRate.length == 0) {
				preferencesSystem.numbersTaxRate = "###,###,###%;-###,###,###%;0%";
			}
		if (preferencesSystem.numbersRate !=null)
			if (preferencesSystem.numbersRate.length == 0) {
				preferencesSystem.numbersRate = "###,###,###,##0.00##";
			}
		if (preferencesSystem.numbersFactor !=null)
			if (preferencesSystem.numbersFactor.length == 0) {
				preferencesSystem.numbersFactor = "###,###,###,##0.####;-###,###,###,##.####;0"
			}
		if (preferencesSystem.numbersInvoice !=null)
			if (preferencesSystem.numbersInvoice.length == 0) {
				preferencesSystem.numbersInvoice = "###,###,###,##0.00";
			}
		if (preferencesSystem.numbersShortPercent !=null)
			if (preferencesSystem.numbersShortPercent.length == 0) {
				preferencesSystem.numbersShortPercent = "#####0%";
			}
		if (preferencesSystem.displayFormat !=null)
			if (preferencesSystem.displayFormat.length == 0){
				preferencesSystem.displayFormat = "'e'###,###,###,##0.00";
			}
		
		if (preferencesSystem.conversionFactor < 0){
			preferencesSystem.conversionFactor = 1.18;
		}	
		
		if (preferencesSystem.alternateRoundto < 0){
			preferencesSystem.alternateRoundto = 2;
		}	

		//set controls for System items
		setDisplayText(null,preferencesSystem.numbersIntegers,"Integers");
		setAlternateCurrencyText(preferencesSystem.displayFormat,preferencesSystem.alternateRoundto);
		setCurrentRange();
		
	}
	private function mapFromPreferencesAccountingData():void {
		if( preferencesAccounting.invoiceDocument == null || preferencesAccounting.invoiceDocument=="")
			preferencesAccounting.invoiceDocument = "123456789";
		if( preferencesAccounting.estimateDocument == null || preferencesAccounting.estimateDocument=="")
			preferencesAccounting.estimateDocument = "123456789";
	}

	private function mapFromPreferencesAllData():void {
		mapFromPreferencesAccountingData();
		mapFromPreferencesSystemData();
	}

	private function mapToPreferencesAllData():void {
		mapToPreferencesSystem();
		
	}
	
	private function mapToPreferencesSystem():void {
		
		preferencesSystem.companyAddress = company_canvas.address_editor.getAddress();
		
	}
	
	
	private function messageHandler(message:IMessage):void{
		var messageBody:Object = message.body;// as com.efi.messaging.MessageBody;
		
		var messageType:String = messageBody.messageType;
		if (messageType == "ADDUPDATE" || messageType == "DELETE") {
			var payloadType:String = messageBody.payloadType as String; // What kind of item was added/deleted
			var payload:Number = messageBody.payload as Number; // ID if item added or deleted
			if (payloadType == "PreferencesSystem") {
				dataServiceSystem.getAll("PreferencesSystem");
			}
			if (payloadType == "PreferencesPOS") {
				dataServicePOS.getAll("PreferencesPOS");
			}
			if (payloadType == "PreferencesEstimating") {
				dataServiceEstimator.getAll("PreferencesEstimating");
			}
			if (payloadType == "PreferencesAccounting") {
				dataServiceAccounting.getAll("PreferencesAccounting");
			}
			if (payloadType == "PreferencesCashRegister") {
				dataServiceCashRegister.getAll("PreferencesCashRegister");
			}
			if (payloadType == "PreferencesCreditCard") {
				dataServiceCreditCard.getAll("PreferencesCreditCard");
			}
			if (payloadType == "OutsideService") {
				dataServiceMarkups.getAll("OutsideService");
			}
			if (payloadType == "Merchandise") {
				dataServiceMarkupsMerchandise.getAll("Merchandise")
			}
			if (payloadType == "PreferencesPendingList") {
				dataServicePendingList.getAllOrderBy("PreferencesPendingList","columnOrder");
			}
			if (payloadType == "PreferencesPricingMethod") {
				dataServicePricingMethod.getAll("PreferencesPricingMethod");
			}
			if (payloadType == "PreferencesQuantityBreaks") {
				dataServiceQuantityBreaks.getAll("PreferencesQuantityBreaks");
			}
			if (payloadType == "SalesCategory") {
				dataServiceSalesCategory.getAll("SalesCategory");
			}
			if (payloadType == "PreferencesStockDefinition") {
				dataServiceStockDefinition.getAllOrderBy("PreferencesStockDefinition","columnOrder");
			}
			if (payloadType == "PreferencesStocks") {
				dataServiceStocks.getAll("PreferencesStocks");
			}
		}
	}
     
	private function handleFault(ev:FaultEvent):void {  
		var message:String;
		
		if(isSave || isRevert || isLoad){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
		              
		message = "Error: "                          
		+ ev.fault.faultCode + " - "                                  
		+ ev.fault.faultDetail + " - "                                  
		+ ev.fault.faultString;
		Alert.show(message, "Error", 0, null, null, null, 4);                                 
	}
	
	public function setCurrentCountry(event:Event=null) : void {
		if(event){
			addressformatting_canvas.txtSampleAddress.text = event.currentTarget.selectedItem.name;
		} else {
			if(preferencesSystem.defaultCountry==0){
				preferencesSystem.defaultCountry = CountryArray.getItemAt(0).id;
				addressformatting_canvas.countryList.selectedIndex=0;
				addressformatting_canvas.txtSampleAddress.text = CountryArray.getItemAt(0).name;
			} else {
				for(var i:int=0;i<CountryArray.length;i++){
					var obj:Object = CountryArray.getItemAt(i);
					if(obj.id == preferencesSystem.defaultCountry){
						addressformatting_canvas.countryList.selectedIndex = i;
						addressformatting_canvas.countryList.scrollToIndex(i);
						addressformatting_canvas.txtSampleAddress.text = obj.name;
						break;
					}
				}
			}
			addressformatting_canvas.setFormatText(null,addressformatting_canvas.countryList.selectedItem as Country);
		}
	}

	private function findItem(name:String, array:ArrayCollection):int {
		for each(var element:Object in array) {
			if (name == element.name) {
				return array.getItemIndex(element);
			}
		}
		return -1;
	}

// Data Load Handlers

	private function handleLoadEstimatorTypesResult(event:ResultEvent):void {
		estimatorTypesArray = event.result as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadTaxTablesResult(event:ResultEvent):void {
		taxTablesArray = event.result as ArrayCollection;
		var taxTable:TaxTable = new TaxTable();
		taxTable.id = -1;
		taxTable.name = resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'taxCmd.UseParentTaxTable');
		taxTablesArray.addItemAt(taxTable,0);
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadTaxCodesResult(event:ResultEvent):void {
		taxCodesArray = event.result as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadJobMethodsResult(event:ResultEvent):void {
		jobMethodsArray = event.result as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadSalesRepsResult(event:ResultEvent):void {
		var arrayList:ArrayCollection = event.result as ArrayCollection;
		var salesRep:SalesRep = new SalesRep();
		salesRep.name = "";
		arrayList.addItemAt(salesRep,0);
		salesRepsArray = arrayList;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadShippingMethodsResult(event:ResultEvent):void {
		var arrayList:ArrayCollection = event.result as ArrayCollection;
		var shippingMethod:ShippingMethod = new ShippingMethod();
		shippingMethod.name = "";
		arrayList.addItemAt(shippingMethod,0);
		shippingMethodsArray = arrayList;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	

	private function handleLoadIntegrationResult(ev:ResultEvent):void {
		var preferencesIntegrationArray:ArrayCollection = ev.result as ArrayCollection;
		if (preferencesIntegrationArray.length > 0) {
			preferencesIntegration = preferencesIntegrationArray.getItemAt(0,0) as PreferencesIntegration;
		}
		if (preferencesIntegration == null) {
			preferencesIntegration = new PreferencesIntegration();
		}
		mapFromPrefereincesIntegrationData();
		registerClassAlias("com.efi.printsmith.data.PreferencesIntegration",PreferencesIntegration);
		preferencesIntegrationOrigObj = ObjectUtil.copy(preferencesIntegration) as PreferencesIntegration;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadSystemResult(ev:ResultEvent):void {
		PreferencesSystemArray = ev.result as ArrayCollection;
		if (PreferencesSystemArray.length > 0)
   			preferencesSystem = PreferencesSystemArray.getItemAt(0,0) as PreferencesSystem ;
		if (preferencesSystem == null)
		{
			preferencesSystem = new PreferencesSystem();
		}
		mapFromPreferencesSystemData();
		registerClassAlias("com.efi.printsmith.data.PreferencesSystem",PreferencesSystem);
		preferencesSystemOrigObj = ObjectUtil.copy(preferencesSystem) as PreferencesSystem;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadPOSResult(ev:ResultEvent):void {
		var preferencesPOSArray:ArrayCollection = ev.result as ArrayCollection;
		if ( preferencesPOSArray.length >0 )
			preferencesPOS = preferencesPOSArray.getItemAt(0,0) as PreferencesPOS;
		if (preferencesPOS == null)
		{
			preferencesPOS = new PreferencesPOS();
		}
		registerClassAlias("com.efi.printsmith.data.PreferencesPOS",PreferencesPOS);
		preferencesPOSOrigObj = ObjectUtil.copy(preferencesPOS) as PreferencesPOS;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadEstimatorResult(ev:ResultEvent):void {
		PreferencesEstimatingArray = ev.result as ArrayCollection;
		if( PreferencesEstimatingArray.length >0){
			preferencesEstimating = PreferencesEstimatingArray.getItemAt(0,0) as PreferencesEstimating;
			if(preferencesEstimating.gripLocation==null || preferencesEstimating.gripLocation==""){
				preferencesEstimating.gripLocation = 'Top';
			}
			if(preferencesEstimating.folioLocation==null || preferencesEstimating.folioLocation==""){
				preferencesEstimating.folioLocation = 'Top';
			}
		}
		if (preferencesEstimating == null)
		{
			preferencesEstimating = new PreferencesEstimating();
			preferencesEstimating.gripLocation = 'Top';
			preferencesEstimating.folioLocation = 'Top';
		}
		registerClassAlias("com.efi.printsmith.data.PreferencesEstimating",PreferencesEstimating);
		preferencesEstimatingOrigObj = ObjectUtil.copy(preferencesEstimating) as PreferencesEstimating;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadAccountingResult(ev:ResultEvent):void {
		PreferencesAccountingArray = ev.result as ArrayCollection;
		if ( PreferencesAccountingArray.length >0)
			preferencesAccounting = PreferencesAccountingArray.getItemAt(0,0) as PreferencesAccounting;
		if (preferencesAccounting == null)
		{
			preferencesAccounting = new PreferencesAccounting();
		} 
		mapFromPreferencesAccountingData();
		if(isReverted){
			creditcards_canvas.updated = false;
			creditcards_canvas.updateComp(preferencesAccounting);
		}
		isReverted = false;
		registerClassAlias("com.efi.printsmith.data.PreferencesAccounting",PreferencesAccounting);
		preferencesAccountingOrigObj = ObjectUtil.copy(preferencesAccounting) as PreferencesAccounting;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	
	private function handleLoadCountryResult(ev:ResultEvent):void {
		CountryArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.Country",Country);
		CountryOrigArray = ObjectUtil.copy(CountryArray) as ArrayCollection;
		if(preferencesSystem.defaultCountry==0 && preferencesSystem.defaultCountryName!=null){
			for each(var countryObj:Country in CountryArray) {
				if(countryObj.name==preferencesSystem.defaultCountryName){
					preferencesSystem.defaultCountry = countryObj.id;
   	 				dataServiceSystem.addUpdate(preferencesSystem);
   	 				break;
   				}
   			}
    	}
		registerClassAlias("com.efi.printsmith.data.PreferencesSystem",PreferencesSystem);
		preferencesSystemOrigObj = ObjectUtil.copy(preferencesSystem) as PreferencesSystem;
		setCurrentCountry();
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadCashRegisterResult(ev:ResultEvent):void {
		PreferencesCashRegisterArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.PreferencesCashRegister",PreferencesCashRegister);
		PreferencesCashRegisterOrigArray = ObjectUtil.copy(PreferencesCashRegisterArray) as ArrayCollection;
		if ( PreferencesCashRegisterArray.length >0)
			preferencesCashRegister = PreferencesCashRegisterArray.getItemAt(0,0) as PreferencesCashRegister;
		if (preferencesCashRegister == null)
		{
			preferencesCashRegister = new PreferencesCashRegister();
		} 
		registerClassAlias("com.efi.printsmith.data.PreferencesCashRegister",PreferencesCashRegister);
		preferencesCashRegisterOrigObj = ObjectUtil.copy(preferencesCashRegister) as PreferencesCashRegister;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadIntegrationPreferencesResult(ev:ResultEvent):void {
		//preferencesIntegration.fieryConnectorURL = this.txtFieryURL.text;
	}
	private function handleLoadCreditCardResult(ev:ResultEvent):void {
		PreferencesCreditCardArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.PreferencesCreditCard",PreferencesCreditCard);
		PreferencesCreditCardOrigArray = ObjectUtil.copy(PreferencesCreditCardArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadMarkupsResult(ev:ResultEvent):void {
		var count:int=0;
		var abovePosFlag:Boolean = false;
		PreferencesMarkupsArray = ev.result as ArrayCollection;
		if(PreferencesMarkupsArray==null || PreferencesMarkupsArray.length==0){
			var outsideService:OutsideService = new OutsideService();
			outsideService.above = true;
			PreferencesMarkupsArray.addItem(outsideService);
		} else {
			var abovePresent:Boolean = false;
			for each(var outsideServiceObj:OutsideService in PreferencesMarkupsArray) {
				if(outsideServiceObj.above){
					abovePresent = true;
					break;
				}
			}
			if(!abovePresent){
				var outsideServiceObject:OutsideService = new OutsideService();
				outsideServiceObject.above = true;
				PreferencesMarkupsArray.addItem(outsideServiceObject);
			}
		}
		for each(var outsideServiceObj:OutsideService in PreferencesMarkupsArray) {
			count++;
			if(outsideServiceObj.above){
				if(count==PreferencesMarkupsArray.length){
					abovePosFlag = true;
					break;
				} else {
					break;
				}
			}
		}
		if(!abovePosFlag){
			var outsideService:OutsideService = new OutsideService();
			registerClassAlias("com.efi.printsmith.data.OutsideService",OutsideService);
			outsideService = ObjectUtil.copy(PreferencesMarkupsArray.getItemAt(count-1)) as OutsideService;
			PreferencesMarkupsArray.removeItemAt(count-1);
			PreferencesMarkupsArray.addItem(outsideService);
		}
		registerClassAlias("com.efi.printsmith.data.OutsideService",OutsideService);
		PreferencesMarkupsOrigArray = ObjectUtil.copy(PreferencesMarkupsArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadMarkupsMerchandiseResult(ev:ResultEvent):void {
		var count:int=0;
		var abovePosFlag:Boolean = false;
		PreferencesMarkupsMerchandiseArray = ev.result as ArrayCollection;
		if(PreferencesMarkupsMerchandiseArray==null || PreferencesMarkupsMerchandiseArray.length==0){
			var merchandise:Merchandise = new Merchandise();
			merchandise.above = true;
			PreferencesMarkupsMerchandiseArray.addItem(merchandise);
		} else {
			var abovePresent:Boolean = false;
			for each(var merchandiseObj:Merchandise in PreferencesMarkupsMerchandiseArray) {
				if(merchandiseObj.above){
					abovePresent = true;
					break;
				}
			}
			if(!abovePresent){
				var merchandiseObject:Merchandise = new Merchandise();
				merchandiseObject.above = true;
				PreferencesMarkupsMerchandiseArray.addItem(merchandiseObject);
			}
		}
		for each(var merchandiseObj:Merchandise in PreferencesMarkupsMerchandiseArray) {
			count++;
			if(merchandiseObj.above){
				if(count==PreferencesMarkupsMerchandiseArray.length){
					abovePosFlag = true;
					break;
				} else {
					break;
				}
			}
		}
		if(!abovePosFlag){
			var merchandise:Merchandise = new Merchandise();
			registerClassAlias("com.efi.printsmith.data.Merchandise",Merchandise);
			merchandise = ObjectUtil.copy(PreferencesMarkupsMerchandiseArray.getItemAt(count-1)) as Merchandise;
			PreferencesMarkupsMerchandiseArray.removeItemAt(count-1);
			PreferencesMarkupsMerchandiseArray.addItem(merchandise);
		}
		registerClassAlias("com.efi.printsmith.data.Merchandise",Merchandise);
		PreferencesMarkupsMerchandiseOrigArray = ObjectUtil.copy(PreferencesMarkupsMerchandiseArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadPendingListResult(ev:ResultEvent):void {
		PreferencesPendingListArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.PreferencesPendingList",PreferencesPendingList);
		PreferencesPendingListOrigArray = ObjectUtil.copy(PreferencesPendingListArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadPricingMethodResult(ev:ResultEvent):void {
		PreferencesPricingMethodArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.PreferencesPricingMethod",PreferencesPricingMethod);
		PreferencesPricingMethodOrigArray = ObjectUtil.copy(PreferencesPricingMethodArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadQuantityBreaksResult(ev:ResultEvent):void {
		PreferencesQuantityBreaksArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.PreferencesQuantityBreaks",PreferencesQuantityBreaks);
		PreferencesQuantityBreaksOrigArray = ObjectUtil.copy(PreferencesQuantityBreaksArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadSalesCategoryResult(ev:ResultEvent):void {
		PreferencesSalesCategoryArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.SalesCategory",SalesCategory);
		PreferencesSalesCategoryOrigArray = ObjectUtil.copy(PreferencesSalesCategoryArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadStockDefinitionResult(ev:ResultEvent):void {
		PreferencesStockDefinitionArray = ev.result as ArrayCollection;
		registerClassAlias("com.efi.printsmith.data.PreferencesStockDefinition",PreferencesStockDefinition);
		PreferencesStockDefinitionOrigArray = ObjectUtil.copy(PreferencesStockDefinitionArray) as ArrayCollection;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadStocksResult(ev:ResultEvent):void {
		PreferencesStocksArray = ev.result as ArrayCollection;
		if ( PreferencesStocksArray.length >0)
			preferencesStocks = PreferencesStocksArray.getItemAt(0,0) as PreferencesStocks;
		if (preferencesStocks == null)
		{
			preferencesStocks = new PreferencesStocks();
		}
		if(SizeTableArray!=null && SizeTableArray.length>0 && preferencesStocks.sizeTable==null){
			preferencesStocks.sizeTable = SizeTableArray.getItemAt(0) as SizeTable;
		}
		registerClassAlias("com.efi.printsmith.data.PreferencesStocks",PreferencesStocks);
		preferencesStocksOrigObj = ObjectUtil.copy(preferencesStocks) as PreferencesStocks;
		successCheckCount++;
		if((isSave || isRevert || isLoad) && checkCount==successCheckCount){
			if(isSave) {
				isSave = false;
			}
			if(isRevert) {
				isRevert = false;
			}
			if(isLoad) {
				isLoad = false;
			}
			if(loadComponent) {
				loadComponent.close();
			}
		}
	}
	private function handleLoadColumnNamesResult(ev:ResultEvent):void {
	     ColumnNamesArray = ev.result as ArrayCollection;
	}
	private function handleLoadSizeTableResult(ev:ResultEvent):void {
	     SizeTableArray = ev.result as ArrayCollection;
	}
	private function handleLoadCategoryResult(ev:ResultEvent):void {
	     CategoryArray = ev.result as ArrayCollection;
	}

// Data Save Handlers
	private function handleSaveIntegrationResult(ev:ResultEvent):void {
		dataServiceIntegration.getAll("PreferencesIntegration");
	}
	private function handleSaveSystemResult(ev:ResultEvent):void {
		var preferencesSystemObject:PreferencesSystem = ev.result as PreferencesSystem;
   		if(preferencesSystemObject!=null){
   			if(preferencesSystemObject.enableAutoLogOut && preferencesSystemObject.secondsOfInactivity){
   				if(preferencesSystemObject.autoLogOutSeconds!=0) {
   					Snowmass.getInstance().doAutoLogout(preferencesSystemObject.autoLogOutSeconds);
   				} else if(preferencesSystemObject.autoLogOutSeconds==0) {
   					Snowmass.getInstance().stopAutoLogoutTimer();
   				}
   			} else {
   				Snowmass.getInstance().stopAutoLogoutTimer();
   			}
   		}
    	dataServiceSystem.getAll("PreferencesSystem");
	}
	private function handleSavePOSResult(ev:ResultEvent):void {
    	dataServicePOS.getAll("PreferencesPOS");
	}
	private function handleSaveEstimatorResult(ev:ResultEvent):void {
    	dataServiceEstimator.getAll("preferencesEstimating");
	}
	private function handleSaveAccountingResult(ev:ResultEvent):void {
    	dataServiceAccounting.getAll("PreferencesAccounting");
	}
	private function handleSaveCountryResult(ev:ResultEvent):void {
		countryAddArray.removeAll();
		countryDeleteArray.removeAll();
    	dataServiceCountry.getAll("Country");
	}
	private function handleSaveCashRegisterResult(ev:ResultEvent):void {
    	dataServiceCashRegister.getAll("PreferencesCashRegister");
	}
	private function handleSaveCreditCardResult(ev:ResultEvent):void {
    	dataServiceCreditCard.getAll("PreferencesCreditCard");
	}
	private function handleSaveMarkupsResult(ev:ResultEvent):void {
    	dataServiceMarkups.getAll("OutsideService");
	}
	private function handleSaveMarkupsMerchandiseResult(ev:ResultEvent):void {
    	dataServiceMarkupsMerchandise.getAll("Merchandise");
	}
	private function handleSavePendingListResult(ev:ResultEvent):void {
    	dataServicePendingList.getAllOrderBy("PreferencesPendingList","columnOrder");
	}
	private function handleSavePricingMethodResult(ev:ResultEvent):void {
    	dataServicePricingMethod.getAll("PreferencesPricingMethod");
	}
	private function handleSaveQuantityBreaksResult(ev:ResultEvent):void {
    	dataServiceQuantityBreaks.getAll("PreferencesQuantityBreaks");
	}
	private function handleSaveSalesCategoryResult(ev:ResultEvent):void {
    	dataServiceSalesCategory.getAll("SalesCategory");
	}
	private function handleSaveStockDefinitionResult(ev:ResultEvent):void {
    	dataServiceStockDefinition.getAllOrderBy("PreferencesStockDefinition","columnOrder");
	}
	private function handleSaveStocksResult(ev:ResultEvent):void {
    	dataServiceStocks.getAll("PreferencesStocks");
	}
	private function handleSaveColumnNamesResult(ev:ResultEvent):void {
    	dataServiceColumnNames.getAll("ColumnNames");
	}
	private function handleSaveSizeTableResult(ev:ResultEvent):void {
    	dataServiceSizeTable.getAll("SizeTable");
	}
	private function handleSaveCategoryResult(ev:ResultEvent):void {
    	dataServiceCategory.getAll("SalesCategory");
	}

	private function handleDeleteCashRegisterResult(ev:ResultEvent):void {
    	//dataServiceCashRegister.getAll("PreferencesCashRegister");
	}
	private function handleDeleteCreditCardResult(ev:ResultEvent):void {
    	//dataServiceCreditCard.getAll("PreferencesCreditCard");
	}
	
	private function handleDeleteMarkupsResult(ev:ResultEvent):void {
    	//dataServiceMarkups.getAll("OutsideService");
	}
	
	private function handleDeleteMarkupsMerchandiseResult(ev:ResultEvent):void {
    	//dataServiceMarkupsMerchandise.getAll("Merchandise");
	}
	
	private function handleDeletePricingMethodResult(ev:ResultEvent):void {
    	//dataServicePricingMethod.getAll("PreferencesPricingMethod");
	}
	
	private function handleDeleteSalesCategoryResult(ev:ResultEvent):void {
    	//dataServiceSalesCategory.getAll("SalesCategory");
	}
	
	private var openSequence:Array = [];

	private function openTree():void {
		var nodeList:XMLListCollection = 
			tvPreference.dataProvider as XMLListCollection;
		var node:XMLList = nodeList.source;
		var firstCommand:String = null;
		
		for(var i:int=0; i < node.length(); i++) {
			var n:XML = node[i];
			if( n.children() != null ) {
				tvPreference.expandItem(n,true,false);
				if (firstCommand == null)	{
					var ch:XMLList = n.children();
					firstCommand = ch[0].@command;
				}
			}
		}
		tvPreference.selectedIndex = 1;
		checkForTreeSelection(firstCommand);
		
		preferences_stack.selectedIndex = 0;
		for(var j:int=0; j <=0; j++) {
			var nodeVal:XML = node[j];
			if(nodeVal.children() !=null) {
				for each(var childNode:XML in nodeVal.children()) {
					selectedSection = childNode.@label;
					break;
				}
			} 
		}
		selectedIndexSelection = 1;
		  
	}
	
	private function checkForTreeSelection(commandId:String):void	{
		if (PSSecurityUtils.getInstance().hasPermission(commandId))	{
			btnSave.enabled = true;
			btnRevert.enabled = true;
		}
		else	{
			btnSave.enabled = false;
			btnRevert.enabled = false;
		}	
	}
	private function treeSelect(event:Event):void {
		var isObjEqual:Boolean = true;
		this.currentState = "";
		
		var node:XML = XML(event.currentTarget.selectedItem);
		
		if( node.@label == "genericPrefCmd.System" ) return;
		if( node.@label == "genericPrefCmd.POS" ) return;
		if( node.@label == "genericPrefCmd.Estimator" ) return;
		if( node.@label == "genericPrefCmd.Accounting" ) return;
		if( node.@label == "genericPrefCmd.Integration" && node.@isBranch == "true") return;
		
		checkForTreeSelection(node.@command);
		
		if(!validate(preferences_stack.selectedChild)) {
			tvPreference.selectedIndex = selectedIndexSelection;
			Alert.show("Validation Error");
			return;
		}
		
		if(selectedSection == "genericPrefCmd.Behavior" || selectedSection == "genericPrefCmd.Company" || selectedSection == "genericPrefCmd.BusinessCalendar"
			|| selectedSection == "genericPrefCmd.Numbers" || selectedSection == "genericPrefCmd.AlternateCurrency" || selectedSection == "genericPrefCmd.International") {
			if(!compareObject(preferencesSystem,preferencesSystemOrigObj)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.AddressFormatting") {
			if(!compareObject(preferencesSystem,preferencesSystemOrigObj) || !compareObject(CountryArray,CountryOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.Receipt" || selectedSection == "genericPrefCmd.CashDrawer"){
			if(!compareObject(preferencesPOS,preferencesPOSOrigObj)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.CashRegister"){
			if(!compareObject(PreferencesCashRegisterArray,PreferencesCashRegisterOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.PendingList"){
			if(!compareObject(preferencesPOS,preferencesPOSOrigObj) || !compareObject(PreferencesPendingListArray,PreferencesPendingListOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.EstimatorBehavior" || selectedSection == "genericPrefCmd.EstimatorPrinting" ||
			selectedSection == "genericPrefCmd.PaperCalculator" || selectedSection == "genericPrefCmd.JobTicket"){
			if(!compareObject(preferencesEstimating,preferencesEstimatingOrigObj)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.QuantityBreaks"){
			if(!compareObject(PreferencesQuantityBreaksArray,PreferencesQuantityBreaksOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.Markups"){
			if(!compareObject(PreferencesMarkupsArray,PreferencesMarkupsOrigArray) || !compareObject(PreferencesMarkupsMerchandiseArray,PreferencesMarkupsMerchandiseOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.StocksandSizes"){
			if(!compareObject(preferencesStocks,preferencesStocksOrigObj)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.StockDefinitions"){
			if(!compareObject(PreferencesStockDefinitionArray,PreferencesStockDefinitionOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.PricingMethod"){
			if(!compareObject(PreferencesPricingMethodArray,PreferencesPricingMethodOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.CreditDefaults" || selectedSection == "genericPrefCmd.AgingPeriods" || 
			selectedSection == "genericPrefCmd.GLProfiles" || selectedSection == "genericPrefCmd.OrderNumberFormat" ||
			selectedSection == "genericPrefCmd.JournalEntries"){
			if(!compareObject(preferencesAccounting,preferencesAccountingOrigObj)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.CreditCardInfo"){
			if(!compareObject(preferencesAccounting,preferencesAccountingOrigObj) || !compareObject(PreferencesCreditCardArray,PreferencesCreditCardOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.Integration"){
			if(!compareObject(preferencesIntegration,preferencesIntegrationOrigObj)){
				isObjEqual = false;
			}
		}
		
		if(selectedSection == "genericPrefCmd.SalesCategories"){
			if(!compareObject(PreferencesSalesCategoryArray,PreferencesSalesCategoryOrigArray)){
				isObjEqual = false;
			}
		}
		
		if(!isObjEqual){
			var confirmWindow:PreferencesConfirmComponent = PopUpManager.createPopUp(this,PreferencesConfirmComponent,true) as PreferencesConfirmComponent;
			confirmWindow.labelTxt = selectedSection;
			confirmWindow.addEventListener(ConfirmStatusEvent.CONFIRM_STATUS,function(event:ConfirmStatusEvent):void{
				if(event.confirmStatus==1){
					doRevert();
					changeSelectedSection(node); 
				} else if(event.confirmStatus==2) {
					tvPreference.selectedIndex = selectedIndexSelection;
				} else if(event.confirmStatus==3) {
					doSave();
					changeSelectedSection(node);
				}
			},false,0,true);
		}
			
		
		if(isObjEqual){
			changeSelectedSection(node);
		}
		
	}
	
	private function changeSelectedSection(node:XML):void{
		if( node == null ) return;
		
		if(node.@isBranch == "false") {
			selectedSection = node.@label;
			selectedIndexSelection = tvPreference.selectedIndex;
		}

		//var message:String;
		//message = node.@label; 
		//Alert.show(message, "Selected Item", 0, null, null, null, 4);                                 
		preferences_stack.selectedIndex = node.@tag;
		if( node.@label == "genericPrefCmd.PendingList" ) {
			pendinglist_canvas.updateFontLabels();
		} 
	}
	
	public function doSignSymbol(text:String):void{
		if(numberCanvasTextInput){
			var text:String = numberCanvasTextInput.text+text;
			numberCanvasTextInput.dataHolder[numberCanvasTextInput.variableName] = text; 
			//numberCanvasTextInput.customText = text;
		} 
	}

	public function setAlternateCurrencyText(formatStr:String,roundingValue:int):void{
		
		var number1:Number = 1234.56;
		var number2:Number = 0.00;
		var number3:Number = -1234.56;
		var number4:Number = 0.55;
		var currencySymbol:String = "";
		var currencyArray:Array;
		var numberBeforeDecimalArray:Array;
		var thousandSeparatorCounter:int=0;
		var thousandSeparatorObj:String="";
		var thousandSeparatorArray:Array;
		var sampleFormatString:String = "";
		var numberFormatString:String = "";
		var commaFormattedString:String = "";
		var numFormatter:NumberFormatter = new NumberFormatter();
		var number2String:String="";
		var number4String:String="";
		numFormatter.useThousandsSeparator = false;
		numFormatter.rounding = "nearest";
		
		if(formatStr!=null && StringUtil.trim(formatStr)!=""){
			if(formatStr.indexOf("'")>-1){
				currencyArray = formatStr.split("'");
				if(currencyArray.length==3){
					currencySymbol = currencyArray[1];
					sampleFormatString = currencySymbol;				
					if(currencyArray[2].indexOf(".")>-1){
						numberBeforeDecimalArray = currencyArray[2].split(".");
						if(roundingValue<numberBeforeDecimalArray[1].length){
							numFormatter.precision = roundingValue;
							number1 = Number(numFormatter.format(number1));
							number2 = Number(numFormatter.format(number2)); 
							number4 = Number(numFormatter.format(number4));
							if(roundingValue<0){
								number1 = Number(roundOfNegativeValue(number1,roundingValue));
								number2 = Number(roundOfNegativeValue(number2,roundingValue));
								number4 = Number(roundOfNegativeValue(number4,roundingValue));
							}
						}
						numFormatter.precision = numberBeforeDecimalArray[1].length;
						numberFormatString = numFormatter.format(number1);
						number2String = numFormatter.format(number2);
						number4String = numFormatter.format(number4);
						commaFormattedString = numberFormatString.split(".")[0];
						if(numberBeforeDecimalArray[0].length>=4) {
							if(numberBeforeDecimalArray[0].indexOf(",")>-1){
								thousandSeparatorArray = numberBeforeDecimalArray[0].split(",");
								for(var i:int=thousandSeparatorArray.length-1;i>=0;i--) {
									thousandSeparatorObj = thousandSeparatorArray[i];
									thousandSeparatorCounter = thousandSeparatorCounter+thousandSeparatorObj.length;
									if(thousandSeparatorCounter<=3){
										commaFormattedString = addCommas(commaFormattedString,thousandSeparatorCounter);
									}
								}
								if(commaFormattedString!=""){
									numberFormatString = commaFormattedString+"."+numberFormatString.split(".")[1];
								}
							}
						}
					} else {
						if(roundingValue<0){
							numFormatter.precision = roundingValue;
							number1 = Number(numFormatter.format(number1));
							number2 = Number(numFormatter.format(number2)); 
							number4 = Number(numFormatter.format(number4));
							if(roundingValue<0){
								number1 = Number(roundOfNegativeValue(number1,roundingValue));
								number2 = Number(roundOfNegativeValue(number2,roundingValue));
								number4 = Number(roundOfNegativeValue(number4,roundingValue));
							}
						}
						numFormatter.precision = 0;
						numberFormatString = numFormatter.format(number1);
						number2String = numFormatter.format(number2);
						number4String = numFormatter.format(number4);
						commaFormattedString = ""+numberFormatString;
						if(currencyArray[2].length>=4) {
							if(currencyArray[2].indexOf(",")>-1){
								thousandSeparatorArray = currencyArray[2].split(",");
								for(var i:int=thousandSeparatorArray.length-1;i>=0;i--) {
									thousandSeparatorObj = thousandSeparatorArray[i];
									thousandSeparatorCounter = thousandSeparatorCounter+thousandSeparatorObj.length;
									if(thousandSeparatorCounter<=3){
										commaFormattedString = addCommas(commaFormattedString,thousandSeparatorCounter);
									}
								}
								if(commaFormattedString!=""){
									numberFormatString = commaFormattedString;
								}
							}
						}
					}
					alternatecurrency_canvas.txtSampleArea.text = sampleFormatString+numberFormatString
																  +"\n"+sampleFormatString+number2String
																  +"\n"+"-"+sampleFormatString+numberFormatString
																  +"\n"+sampleFormatString+number4String;
				} else {
					alternatecurrency_canvas.txtSampleArea.text = "";
				}
			} else {
				alternatecurrency_canvas.txtSampleArea.text = "";
			}
		} else {
			alternatecurrency_canvas.txtSampleArea.text = "";
		}
	}
	
	public function roundOfNegativeValue(value:Number,precision:int):String {
		var v:Number = value;
		
		
		// Shift decimal right as Math functions
		// perform only integer ceil/round/floor.
		v = v * Math.pow(10, precision);
		
		// Attempt to get rid of floating point errors
		v = Number(v.toString()); 
		
		v = Math.round(v);
		
		// Shift decimal left to get back decimal to original point.
		v = v / Math.pow(10, precision); 
		
		return v.toString()
	}
	
	public function addCommas(numberFormatString:String, position:int):String {
		var numCounter:int = 0;
		var commaFormattedString:String = "";
		for(var i:int=numberFormatString.length-1;i>=0;i--){
			var number:Number = Number(numberFormatString.charAt(i));
			if(!isNaN(number)){
				numCounter++;
				if(numCounter==position){
					commaFormattedString = commaFormattedString + number + ",";
				} else {
					commaFormattedString = commaFormattedString + number;
				}
			} else {
				commaFormattedString = commaFormattedString+numberFormatString.charAt(i);
			}
		}
		commaFormattedString = reverseString(commaFormattedString);
		return commaFormattedString
	}
	
	public function reverseString(reverseStr:String):String {
		var reversedString:String = "";
		for(var i:int=reverseStr.length-1;i>=0;i--){
			reversedString = reversedString+reverseStr.charAt(i);
		}
		return reversedString;
	} 
	
	public function setDisplayText(event:Event=null,text:String=null,compName:String=null):void{
		if(event!=null){
			numberCanvasTextInput = event.currentTarget as CustomStringTextInputComponent;
			text = event.currentTarget.text;
			compName = event.currentTarget.name;
		}
		currentnumberstext = text;
		var number1:Number = 1234.567890;
		var number2:Number = 0.0;
		var number3:Number = -1234.567890;
		var number4:Number = 0.555555;
		var str:String = currentnumberstext;
		if ( str == null)
			str = new String();
		if (str.substr(str.indexOf(";")).length > 0){
			str = str.substr(0,str.indexOf(";"))
		}
 
		var fmt1:mx.formatters.CurrencyFormatter = new CurrencyFormatter();
		var fmt2:mx.formatters.NumberFormatter = new NumberFormatter();
		if (str.length > 0){
			if (str.substr(str.indexOf(dollar)).length > 0 || str.substr(str.indexOf(yen)).length > 0 || str.substr(str.indexOf(euro)).length > 0) {
				if (str.substr(str.indexOf(".")).length > 0){
					fmt1.precision = str.substr(str.indexOf(".")).length 
				}else{
					fmt1.precision = 0;
				}
				if (str.substr(str.indexOf(dollar)).length > 0){
					fmt1.currencySymbol = dollar;
				}  
				if (str.substr(str.indexOf(yen)).length > 0){
					fmt1.currencySymbol = yen;
				}  
				if (str.substr(str.indexOf(euro)).length > 0){
					fmt1.currencySymbol = euro;
				}
				numbers_canvas.txtDisplayArea.text = fmt1.format(number1)+ "\n" + fmt1.format(number2)+ "\n" + fmt1.format(number3)+ "\n" + fmt1.format(number4);
			}else {
				if (str.substr(str.indexOf(".")).length > 0){
					fmt2.precision = str.substr(str.indexOf(".")).length 
				}else {
					fmt2.precision = 0;
				}
				numbers_canvas.txtDisplayArea.text = fmt2.format(number1)+ "\n" + fmt2.format(number2)+ "\n" + fmt2.format(number3)+ "\n" + fmt2.format(number4);
			}		
		}

		numbers_canvas.txtDisplayDemo.text = compName;
	}

	public function setCurrentRange():void{
		var dt1:Date= new Date();
		dt1.setFullYear(dt1.fullYear,calendar_canvas.cboFiscalYearStartMonth.selectedIndex,"1");
		var dt2:Date = new Date(dt1.fullYear+1, calendar_canvas.cboFiscalYearStartMonth.selectedIndex, 0);
		calendar_canvas.txtCurrentRange.text = dt1.toDateString() + " - " + dt2.toDateString(); 
	}
	
	private function doSave():void{
		if(!validate(preferences_stack.selectedChild)) {
			Alert.show("Validation Error");
			return;
		} else {
			isSave = true;
			mapToPreferencesAllData();
			updatePreferencesData();
		}
	}
	
	private function doRevert():void{
		isReverted = true;
		isRevert = true;
		checkCount = 0;
		successCheckCount = 0;
		loadComponent = PopUpManager.createPopUp(this,CommonLoadComponent,true) as CommonLoadComponent;
		PreferencesCashRegisterDeleteArray.removeAll();
		PreferencesMarkupsDeleteArray.removeAll();
		PreferencesMarkupsMerchandiseDeleteArray.removeAll();
		PreferencesPricingMethodDeleteArray.removeAll();
		PreferencesSalesCategoryDeleteArray.removeAll();
		PreferencesCreditCardDeleteArray.removeAll();
		PreferencesQuantityBreaksDeleteArray.removeAll();
		if(selectedSection == "genericPrefCmd.Behavior" || selectedSection == "genericPrefCmd.Company" || selectedSection == "genericPrefCmd.BusinessCalendar"
			|| selectedSection == "genericPrefCmd.Numbers" || selectedSection == "genericPrefCmd.AlternateCurrency" || selectedSection == "genericPrefCmd.International") {
			checkCount = 1;
			dataServiceSystem.getAll("PreferencesSystem");
		}
		
		if(selectedSection == "genericPrefCmd.AddressFormatting") {
			checkCount = 2;
			dataServiceSystem.getAll("PreferencesSystem");
			dataServiceCountry.getAll("Country");
			countryAddArray.removeAll();
			countryDeleteArray.removeAll();
		}
		
		if(selectedSection == "genericPrefCmd.Receipt" || selectedSection == "genericPrefCmd.CashDrawer"){
			checkCount = 1;
			dataServicePOS.getAll("PreferencesPOS");
		}
		
		if(selectedSection == "genericPrefCmd.CashRegister"){
			checkCount = 1;
			dataServiceCashRegister.getAll("PreferencesCashRegister");
		}
		
		if(selectedSection == "genericPrefCmd.PendingList"){
			checkCount = 2;
			dataServicePOS.getAll("PreferencesPOS");
			dataServicePendingList.getAllOrderBy("PreferencesPendingList","columnOrder");
		}
		
		if(selectedSection == "genericPrefCmd.EstimatorBehavior" || selectedSection == "genericPrefCmd.EstimatorPrinting" ||
			selectedSection == "genericPrefCmd.PaperCalculator" || selectedSection == "genericPrefCmd.JobTicket"){
			checkCount = 1;
			dataServiceEstimator.getAll("PreferencesEstimating");
		}
		
		if(selectedSection == "genericPrefCmd.QuantityBreaks"){
			checkCount = 1;
			dataServiceQuantityBreaks.getAll("PreferencesQuantityBreaks");
		}
		
		if(selectedSection == "genericPrefCmd.Markups"){
			checkCount = 2;
			dataServiceMarkups.getAll("OutsideService");
			dataServiceMarkupsMerchandise.getAll("Merchandise");
		}
		
		if(selectedSection == "genericPrefCmd.StocksandSizes"){
			checkCount = 1;
			dataServiceStocks.getAll("PreferencesStocks");
		}
		
		if(selectedSection == "genericPrefCmd.StockDefinitions"){
			checkCount = 1;
			dataServiceStockDefinition.getAllOrderBy("PreferencesStockDefinition","columnOrder");
		}
		
		if(selectedSection == "genericPrefCmd.PricingMethod"){
			checkCount = 1;
			dataServicePricingMethod.getAll("PreferencesPricingMethod");
		}
		
		if(selectedSection == "genericPrefCmd.CreditDefaults" || selectedSection == "genericPrefCmd.AgingPeriods" || 
			selectedSection == "genericPrefCmd.GLProfiles" || selectedSection == "genericPrefCmd.OrderNumberFormat" ||
			selectedSection == "genericPrefCmd.JournalEntries"){
			checkCount = 1;
			dataServiceAccounting.getAll("PreferencesAccounting");
		}
		
		if(selectedSection == "genericPrefCmd.CreditCardInfo"){
			checkCount = 2;
			dataServiceAccounting.getAll("PreferencesAccounting");
			dataServiceCreditCard.getAll("PreferencesCreditCard");
		}
		
		if(selectedSection == "genericPrefCmd.Integration"){
			checkCount = 1;
			dataServiceIntegration.getAll("PreferencesIntegration");
		}
		
		if(selectedSection == "genericPrefCmd.SalesCategories"){
			checkCount = 1;
			dataServiceSalesCategory.getAll("SalesCategory");
		}
		mapFromPreferencesAllData();
	}
	
	private function doCheckPNIConnection():void{
		
	}
	private function doBrowsePath():void{
		
	}
	
	private function doCreateLocationFile():void{
		
	}
	
	private function doCheckForPalmData():void{
		
	}
	
	private function doPrintBarCodes():void{
		
	}
	private function doSelectFolder():void{
		
	}	
	
	private function TreeDisplayLabel(item:XML):String {
		return resourceManager.getString(Snowmass.RESOURCE_BUNDLE, item.@label)
	}        

	private function padString(_str:String, _n:Number, _pStr:String):String {
	    var _rtn:String = _str;
	    if (_pStr == null || _pStr.length < 1)
	    {
	        _pStr = " ";
	    }
	    //
	    if (_str.length < _n)
	    {
	        var _s:String = "";
	        for (var i:Number = 0 ; i < (_n - _str.length) ; i++)
	        {
	            _s += _pStr;
	        }
	        _rtn = _s + _str;
	    }
	    
	    return _rtn;
	}
	
	
	public function getOriginalObject():ArrayCollection {
		var originalList:ArrayCollection = new ArrayCollection();
		if(selectedSection == "genericPrefCmd.Behavior" || selectedSection == "genericPrefCmd.Company" || selectedSection == "genericPrefCmd.BusinessCalendar"
			|| selectedSection == "genericPrefCmd.Numbers" || selectedSection == "genericPrefCmd.AlternateCurrency" || selectedSection == "genericPrefCmd.International") {
			originalList.addItem(preferencesSystemOrigObj);
		}
		
		if(selectedSection == "genericPrefCmd.AddressFormatting") {
			originalList.addItem(preferencesSystemOrigObj);
			originalList.addItem(CountryOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.Receipt" || selectedSection == "genericPrefCmd.CashDrawer"){
			originalList.addItem(preferencesPOSOrigObj);
		}
		
		if(selectedSection == "genericPrefCmd.CashRegister"){
			originalList.addItem(PreferencesCashRegisterOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.PendingList"){
			originalList.addItem(preferencesPOSOrigObj);
			originalList.addItem(PreferencesPendingListOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.EstimatorBehavior" || selectedSection == "genericPrefCmd.EstimatorPrinting" ||
			selectedSection == "genericPrefCmd.PaperCalculator" || selectedSection == "genericPrefCmd.JobTicket"){
			originalList.addItem(preferencesEstimatingOrigObj);
		}
		
		if(selectedSection == "genericPrefCmd.QuantityBreaks"){
			originalList.addItem(PreferencesQuantityBreaksOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.Markups"){
			originalList.addItem(PreferencesMarkupsOrigArray);
			originalList.addItem(PreferencesMarkupsMerchandiseOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.StocksandSizes"){
			originalList.addItem(preferencesStocksOrigObj);
		}
		
		if(selectedSection == "genericPrefCmd.StockDefinitions"){
			originalList.addItem(PreferencesStockDefinitionOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.PricingMethod"){
			originalList.addItem(PreferencesPricingMethodOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.CreditDefaults" || selectedSection == "genericPrefCmd.AgingPeriods" || 
			selectedSection == "genericPrefCmd.GLProfiles" || selectedSection == "genericPrefCmd.OrderNumberFormat" ||
			selectedSection == "genericPrefCmd.JournalEntries"){
			originalList.addItem(preferencesAccountingOrigObj);
		}
		
		if(selectedSection == "genericPrefCmd.CreditCardInfo"){
			originalList.addItem(preferencesAccountingOrigObj);
			originalList.addItem(PreferencesCreditCardOrigArray);
		}
		
		if(selectedSection == "genericPrefCmd.Integration"){
			originalList.addItem(preferencesIntegrationOrigObj);
		}
		
		if(selectedSection == "genericPrefCmd.SalesCategories"){
			originalList.addItem(PreferencesSalesCategoryOrigArray);
		}
		return originalList;
	}
		
	public function getUpdatedObject():ArrayCollection {
		var updatedList:ArrayCollection = new ArrayCollection();
		if(selectedSection == "genericPrefCmd.Behavior" || selectedSection == "genericPrefCmd.Company" || selectedSection == "genericPrefCmd.BusinessCalendar"
			|| selectedSection == "genericPrefCmd.Numbers" || selectedSection == "genericPrefCmd.AlternateCurrency" || selectedSection == "genericPrefCmd.International") {
			updatedList.addItem(preferencesSystem);
		}
		
		if(selectedSection == "genericPrefCmd.AddressFormatting") {
			updatedList.addItem(preferencesSystem);
			updatedList.addItem(CountryArray);
		}
		
		if(selectedSection == "genericPrefCmd.Receipt" || selectedSection == "genericPrefCmd.CashDrawer"){
			updatedList.addItem(preferencesPOS);
		}
		
		if(selectedSection == "genericPrefCmd.CashRegister"){
			updatedList.addItem(PreferencesCashRegisterArray);
		}
		
		if(selectedSection == "genericPrefCmd.PendingList"){
			updatedList.addItem(preferencesPOS);
			updatedList.addItem(PreferencesPendingListArray);
		}
		
		if(selectedSection == "genericPrefCmd.EstimatorBehavior" || selectedSection == "genericPrefCmd.EstimatorPrinting" ||
			selectedSection == "genericPrefCmd.PaperCalculator" || selectedSection == "genericPrefCmd.JobTicket"){
			updatedList.addItem(preferencesEstimating);
		}
		
		if(selectedSection == "genericPrefCmd.QuantityBreaks"){
			updatedList.addItem(PreferencesQuantityBreaksArray);
		}
		
		if(selectedSection == "genericPrefCmd.Markups"){
			updatedList.addItem(PreferencesMarkupsArray);
			updatedList.addItem(PreferencesMarkupsMerchandiseArray);
		}
		
		if(selectedSection == "genericPrefCmd.StocksandSizes"){
			updatedList.addItem(preferencesStocks);
		}
		
		if(selectedSection == "genericPrefCmd.StockDefinitions"){
			updatedList.addItem(PreferencesStockDefinitionArray);
		}
		
		if(selectedSection == "genericPrefCmd.PricingMethod"){
			updatedList.addItem(PreferencesPricingMethodArray);
		}
		
		if(selectedSection == "genericPrefCmd.CreditDefaults" || selectedSection == "genericPrefCmd.AgingPeriods" || 
			selectedSection == "genericPrefCmd.GLProfiles" || selectedSection == "genericPrefCmd.OrderNumberFormat" ||
			selectedSection == "genericPrefCmd.JournalEntries"){
			updatedList.addItem(preferencesAccounting);
		}
		
		if(selectedSection == "genericPrefCmd.CreditCardInfo"){
			updatedList.addItem(preferencesAccounting);
			updatedList.addItem(PreferencesCreditCardArray);
		}
		
		if(selectedSection == "genericPrefCmd.Integration"){
			updatedList.addItem(preferencesIntegration);
		}
		
		if(selectedSection == "genericPrefCmd.SalesCategories"){
			updatedList.addItem(PreferencesSalesCategoryArray);
		}
		return updatedList;
	}
	
	public function getConfirmationText():String {
		return "\nPreferences "+resourceManager.getString(Snowmass.RESOURCE_BUNDLE,selectedSection);
	}
	
	public function onClose():void {
		
	}
	
	public function onSave():void {
		doSave();
	}
	
	public function onDontSave():void {
		
	}
	
	public function onCancel():void {
		
	}
	
]]>

</mx:Script>	

	<mx:HBox width="100%" height="100%" horizontalGap="0">
	
		<mx:VBox width="20%" height="100%">
		
			<mx:Tree  
				id="tvPreference"
				width="100%" height="100%" 
				dataProvider="{treeData.node}" 
				change="treeSelect(event);" labelFunction="TreeDisplayLabel" itemRenderer="com.efi.printsmith.itemRenderers.StyledTreeRenderer"
				defaultLeafIcon="{null}" folderClosedIcon="{null}" folderOpenIcon="{null}"
				/>			
		</mx:VBox>
		
		<mx:VBox width="80%" height="100%">
		
			<mx:Spacer height="1%"/>
		
			<mx:HBox width="100%" height="6%">
			
				<mx:Spacer width="3%"/>
				
				<mx:Button width="5%" height="100%" click="doSave();" enabled="{enableSave}" id="btnSave">
					<mx:icon>@Embed(source='../../../../assets/file.png')</mx:icon>
				</mx:Button>
				
				<mx:Button width="5%" height="100%" click="doRevert();" enabled="{enableSave}" id="btnRevert">
					<mx:icon>@Embed(source='../../../../assets/cancel.png')</mx:icon>
				</mx:Button>
				
			</mx:HBox>
			
			<mx:HBox width="100%">
			
				<mx:Spacer width="3%"/>
			
				<mx:Label 
					text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'rButtonLabel.Save')}"
					width="5%" textAlign="center"/>
				<mx:Label 
					text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'rButtonLabel.Revert')}"
					width="5%" textAlign="center"/>
			
			</mx:HBox>
			
			<mx:ViewStack id="preferences_stack" width="100%" height="100%" creationPolicy="all">
				<prefcomp:BehaviourCanvasComponent id="behavior_canvas" preferencesSystem="{preferencesSystem}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:CompanyCanvasComponent id="company_canvas" preferencesSystem="{preferencesSystem}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:CalendarCanvasComponent id="calendar_canvas" preferencesSystem="{preferencesSystem}" monthsArray="{MonthsArray}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:NumbersCanvasComponent id="numbers_canvas" preferencesSystem="{preferencesSystem}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:AlternateCurrencyCanvasComponent id="alternatecurrency_canvas" preferencesSystem="{preferencesSystem}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:InternationalCanvasComponent id="international_canvas" preferencesSystem="{preferencesSystem}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:AddressFormattingCanvasComponent id="addressformatting_canvas" preferencesSystem="{preferencesSystem}" countryArray="{CountryArray}"
					addressLayoutArray="{addressLayoutArray}" countryAddArray="{countryAddArray}" countryDeleteArray="{countryDeleteArray}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:ReceiptCanvasComponent id="receipt_canvas" preferencesPOS="{preferencesPOS}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:CashdrawerCanvasComponent id="cashdrawer_canvas" preferencesPOS="{preferencesPOS}"
					receiptPrinterArray="{ReceiptPrinterArray}" baudRateArray="{BaudRateArray}" stopBitsArray="{StopBitsArray}"
					parityArray="{ParityArray}" dataSizeArray="{DataSizeArray}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:CashRegisterCanvasComponent id="cashregister_canvas" preferencesCashRegisterArray="{PreferencesCashRegisterArray}"
					preferencesCashRegisterDeleteArray="{PreferencesCashRegisterDeleteArray}" salesCategoryArray="{PreferencesSalesCategoryArray}"
					taxTablesArray="{taxTablesArray}" taxCodesArray="{taxCodesArray}"
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
				
				<prefcomp:PendinglistCanvasComponent id="pendinglist_canvas" preferencesPOS="{preferencesPOS}" 
					preferencesPendingListArray="{PreferencesPendingListArray}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:EstimatorBehaviorCanvasComponent id="estimatorbehavior_canvas" preferencesEstimating="{preferencesEstimating}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:EstimatorPrintingCanvasComponent id="estimatorprinting_canvas" preferencesEstimating="{preferencesEstimating}"
					defaultInvoiceArray="{DefaultInvoiceArray}" defaultEstimateArray="{DefaultEstimateArray}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:PaperCalculatorCanvasComponent id="papercalculator_canvas" preferencesEstimating="{preferencesEstimating}"
					runToFinishGrainArray="{RunToFinishGrainArray}" width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:JobTicketCanvasComponent id="jobticket_canvas" preferencesEstimating="{preferencesEstimating}"
					jobTicketStylesArray="{JobTicketStylesArray}" width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:QuantityBreaksCanvasComponent id="quantitybreaks_canvas" preferencesQuantityBreaksArray="{PreferencesQuantityBreaksArray}"
					preferencesQuantityBreaksDeleteArray="{PreferencesQuantityBreaksDeleteArray}" jobMethodsArray="{jobMethodsArray}"
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:MarkupsCanvasComponent id="markups_canvas" preferencesMarkupsArray="{PreferencesMarkupsArray}"
					preferencesMarkupsMerchandiseArray="{PreferencesMarkupsMerchandiseArray}" preferencesMarkupsDeleteArray="{PreferencesMarkupsDeleteArray}"
					preferencesMarkupsMerchandiseDeleteArray="{PreferencesMarkupsMerchandiseDeleteArray}" 
					width="100%" height="100%"  hideEffect="effect" showEffect="effect"/>
				
				<prefcomp:StocksizesCanvasComponent id="stocksizes_canvas" preferencesStocks="{preferencesStocks}" 
					sizeTableArray="{SizeTableArray}" width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:StockdefinitionsCanvasComponent id="stockdefinitions_canvas"
					preferencesStockDefinitionArray="{PreferencesStockDefinitionArray}" width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
				
				<prefcomp:PricingmethodCanvasComponent id="pricingmethod_canvas"
					preferencesPricingMethodArray="{PreferencesPricingMethodArray}" salesCategoryArray="{PreferencesSalesCategoryArray}"
					preferencesPricingMethodDeleteArray="{PreferencesPricingMethodDeleteArray}" estimatorTypesArray="{estimatorTypesArray}" 
					width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:CreditdefaultsCanvasComponent id="creditdefaults_canvas" preferencesAccounting="{preferencesAccounting}"
					salesRepArray="{salesRepsArray}" shippingMethodArray="{shippingMethodsArray}"
					width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:AgingperiodsCanvasComponent id="agingperiods_canvas" preferencesAccounting="{preferencesAccounting}"
					width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:SalescategoriesCanvasComponent id="salescategories_canvas" preferencesSalesCategoryArray="{PreferencesSalesCategoryArray}"
					preferencesSalesCategoryDeleteArray="{PreferencesSalesCategoryDeleteArray}" width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
				
				<prefcomp:GlProfilesCanvasComponent id="glprofiles_canvas" preferencesAccounting="{preferencesAccounting}"
					accountingPackagesArray="{AccountingPackagesArray}" width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:CreditCardsCanvasComponent id="creditcards_canvas" preferencesAccounting="{preferencesAccounting}"
					preferencesCreditCardArray="{PreferencesCreditCardArray}" preferencesCreditCardDeleteArray="{PreferencesCreditCardDeleteArray}" 
					width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:OrderNumberformatCanvasComponent id="ordernumberformat_canvas" preferencesAccounting="{preferencesAccounting}"
					width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:JournalEntriesCanvasComponent id="journalentries_canvas" preferencesAccounting="{preferencesAccounting}"
					journalDocumentPreferenceArray="{JournalDocumentPreferenceArray}" width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
				<prefcomp:FieryCanvasComponent id="fiery_canvas" preferencesIntegration="{preferencesIntegration}"
					width="100%" height="100%" hideEffect="effect" showEffect="effect"/>
					
			</mx:ViewStack>
			
		</mx:VBox>					
		
	</mx:HBox>
	
</mx:Panel>
