<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="100%" height="100%" 
	title="Tracker Console" 
	xmlns:view="com.efi.printsmith.view.*" xmlns:vo="com.efi.printsmith.vo.*" xmlns:ns1="com.hillelcoren.components.*"
	creationComplete="init()" 
	label="Tracker Console" 
	name="Tracker Console" xmlns:components="com.efi.printsmith.common.components.*" xmlns:trackercomponent="com.efi.printsmith.components.*">
	
	<mx:RemoteObject id="dataService" destination="dataService" showBusyCursor="true">
		<mx:method name="getClockedInEmployee" fault="handleFault(event)" result="handleLoadEmployeeResult(event)"/>
		<mx:method name="getSingle" fault="handleFault(event)" result="handleLoadTrackerConsoleResult(event)"/>
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveTrackerConsoleResult(event)"/>
		<mx:method name="getJobsChargesForTrackerByEmployee" fault="handleFault(event)" result="handleLoadJobChargesResult(event)"/>
		<mx:method name="getActiveTrackerConsoleJobsBasedOnEmployee" fault="handleFault(event)" result="handleLoadTCJobsResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="saveDataServiceJob" destination="dataService" showBusyCursor="true">
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveJobResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="updateDataServiceJob" destination="dataService" showBusyCursor="true">
		<mx:method name="addUpdate" fault="handleFault(event)" result="handleUpdateJobResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceProductionLocation" destination="dataService" showBusyCursor="true">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadProductionLocationResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceFacilty" destination="dataService" showBusyCursor="true">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadFaciltyResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServiceStation" destination="dataService" showBusyCursor="true">
		<mx:method name="getAll" fault="handleFault(event)" result="handleLoadStationResult(event)"/>
	</mx:RemoteObject>
	
	<mx:RemoteObject id="dataServicePending" destination="dataService" showBusyCursor="true">
		<mx:method name="getTracker" fault="handleFault(event)" result="handleLoadPendingResult(event)"/>
	</mx:RemoteObject>
	
	<mx:Script source="../common/scripts/ComponentHelper.as"/>
	
	<mx:Script> 
	                                  
	<![CDATA[
		import com.efi.printsmith.data.TrackerConsoleJobs;
		import com.efi.printsmith.data.Charge;
		import mx.events.CloseEvent;
		import flash.net.registerClassAlias;
		import mx.utils.ObjectUtil;
		import com.efi.printsmith.data.ProductionLocations;
		import com.efi.printsmith.data.ProductionStations;
		import com.efi.printsmith.data.ProductionFacilities;
		import com.efi.printsmith.data.TrackerConsole;
		import mx.controls.dataGridClasses.DataGridColumn;
		import com.efi.printsmith.data.Job;
		import com.efi.printsmith.data.JobBase;
		import com.efi.printsmith.data.Invoice;
		import com.efi.printsmith.data.Employee;  
		import com.efi.printsmith.data.InvoiceBase;                        
		import mx.controls.Alert;                                         
		import mx.managers.PopUpManager;                                         
		import mx.containers.TitleWindow;                                         
		import mx.collections.ArrayCollection;                                         
		import mx.rpc.events.ResultEvent;                                         
		import mx.rpc.events.FaultEvent;         
		
		[Bindable] private var trackerConsole:TrackerConsole;    
		
		[Bindable] private var employee:Employee;
		
		[Bindable] private var employeesArray:ArrayCollection = new ArrayCollection();
		[Bindable] private var trackerList:ArrayCollection = new ArrayCollection();
		[Bindable] private var productionLocationArray:ArrayCollection = new ArrayCollection();
		 
		[Bindable] private var facilitiesArray:ArrayCollection = new ArrayCollection();
		[Bindable] private var stationsArray:ArrayCollection = new ArrayCollection();
		[Bindable] private var productionStations:ArrayCollection = new ArrayCollection();
		
		[Bindable] private var onLoad:Boolean = true;
		
		[Bindable] private var selectedJob:Job;
		
		[Bindable] private var selectedCharge:Charge;
		
		[Bindable] private var trackerConsoleJobsList:ArrayCollection = new ArrayCollection();
		
		[Bindable] private var selectedTrackerConsoleJob:TrackerConsoleJobs;
		
		[Bindable] private var trackerStatus:String="";
		
		[Bindable] private var refreshList:Boolean = false;
		
		[Bindable] private var selectedDGIndex:int = -1; 
		
		[Bindable] private var closeEventTriggered:Boolean = false;
		 
		 
		public function init():void {
			dataService.getSingle("TrackerConsole");
		}    
		 
		private function handleFault(ev:FaultEvent):void {  
			var message:String;
			              
			message = "Error: "                          
			+ ev.fault.faultCode + " - "                                  
			+ ev.fault.faultDetail + " - "                                  
			+ ev.fault.faultString;
			Alert.show(message, "Error", 0, null, null, null, 4);                                 
		}
	
	
	// Data Load Handlers
	
		private function handleLoadTrackerConsoleResult(event:ResultEvent):void {
			trackerConsole = event.result as TrackerConsole;
			if(trackerConsole==null){
				trackerConsole = new TrackerConsole();
			}
			if(onLoad){
				onLoad = false;
				dataService.getClockedInEmployee();	
				dataServiceFacilty.getAll("ProductionFacilities");
				dataServiceStation.getAll("ProductionStations");		
				dataServiceProductionLocation.getAll("ProductionLocations");
			}
		}
		
		private function handleLoadEmployeeResult(event:ResultEvent):void {
			var list:ArrayCollection = event.result as ArrayCollection;
			for each(var employeeObject:Employee in list){
				employeeObject.employeeName = employeeObject.lastName+", "+employeeObject.firstName;
			}
			var employeeObj:Employee = new Employee();
			employeeObj.employeeId = null;
			employeeObj.employeeName = "";
			list.addItemAt(employeeObj,0);
			employeesArray = list;
			if(trackerConsole.selectedEmployee!=null){
				var checkFlag:Boolean = false;
				for each(var employeeObject:Employee in employeesArray) {
					if(trackerConsole.selectedEmployee.employeeId==employeeObject.employeeId){
						checkFlag = true;
						trackerConsole.selectedEmployee = employeeObject;
						employee = trackerConsole.selectedEmployee;
						break;
					}
				}
				if(!checkFlag){
					trackerConsole.selectedEmployee = null;
					employee = null;
				}
			}
			
			trackerList = new ArrayCollection();
			trackerConsoleJobsList = new ArrayCollection();
			getEmployee();
		}
		private function handleLoadProductionLocationResult(event:ResultEvent):void {
			var list:ArrayCollection = event.result as ArrayCollection;
			var location:ProductionLocations = new ProductionLocations();
			location.id = 0;
			location.name = "";
			list.addItemAt(location,0);
			productionLocationArray = list;
		}
		
		private function handleLoadPendingResult(event:ResultEvent):void{
			trackerList = event.result as ArrayCollection;
		}
		
		private function handleLoadFaciltyResult(event:ResultEvent):void {
		    var list:ArrayCollection = event.result as ArrayCollection;
			var facility:ProductionFacilities = new ProductionFacilities();
			facility.id = 0;
			facility.name = "";
			list.addItemAt(facility,0);
			facilitiesArray = list;
		}
		
		private function handleLoadStationResult(event:ResultEvent):void {
			var list:ArrayCollection = event.result as ArrayCollection;
			for each(var stationObj:ProductionStations in list){
				productionStations.addItem(stationObj);
			}
			if(trackerConsole.selectedStations!=null && trackerConsole.selectedStations.length>0){
				for each(var stationObj:ProductionStations in productionStations){
					for each(var stationObject:ProductionStations in trackerConsole.selectedStations) {
						if(stationObject.id==stationObj.id){
							stationObj.isSelected = true;
						}
					}
				}
			}
			var station:ProductionStations = new ProductionStations();
			station.id = 0;
			station.name = "";
			list.addItemAt(station,0);
			stationsArray = list;
			if(trackerConsole.selectedStations!=null && trackerConsole.selectedStations.length>0) {
				for each(var selectedStation:ProductionStations in trackerConsole.selectedStations){
					for each(var station:ProductionStations in stationsArray){
						if(selectedStation.id == station.id){
							station.isSelected = true;
							break;
						}
					}
				}
			}
		}
		
		private function doName(item:Object):String{
			var temp:Employee =  item as Employee;
			var tempString:String;
			 tempString = temp.firstName as String;
			 tempString += " ";
			 tempString += temp.lastName as String;
			return tempString;
		}
		
		private function getEmployee(event:Event=null):void {
			if(trackerConsole.selectedEmployee!=null){
				if(trackerConsole.selectedEmployee.employeeId==null){
					employee = null;
				} else {
					employee = trackerConsole.selectedEmployee;
				}
				if(employee!=null){
					dataService.getJobsChargesForTrackerByEmployee(employee.id);
					dataService.getActiveTrackerConsoleJobsBasedOnEmployee(employee);
				}
			} else {
				resetButtons();
				employee = null;
				selectedJob = null;
				selectedCharge = null;
				selectedDGIndex = -1;
				selectedTrackerConsoleJob = null;
				progressBarComponent.trackerConsoleJobs = null;
				closeEventTriggered = false;
			}
		}
		
		private function doConsoleJobSelection(event:Event):void {
			if(event.currentTarget.selectedIndex>-1){
				var trackerConsoleJobObject:TrackerConsoleJobs = event.currentTarget.selectedItem as TrackerConsoleJobs;
				selectedTrackerConsoleJob = trackerConsoleJobObject;
				enableRequiredBtns();
				registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
				progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(trackerConsoleJobObject) as TrackerConsoleJobs;
			}
		}
		
		private function openClockInOut():void {
			var clockInOut:ClockInOut = PopUpManager.createPopUp(this,ClockInOut,true) as ClockInOut;
			clockInOut.addEventListener(CloseEvent.CLOSE,function(event:Event):void{
				closeEventTriggered = true;
				dataService.getClockedInEmployee();
			},false,0,true);
		}
		
		private function openEditEmployee():void {
			var editEmployee:EditEmployee = PopUpManager.createPopUp(this,EditEmployee,true) as EditEmployee;
			editEmployee.addEventListener(CloseEvent.CLOSE,function(event:Event):void{
				closeEventTriggered = true;
				dataService.getClockedInEmployee();
			},false,0,true);
			if(employee!=null){
				registerClassAlias("com.efi.printsmith.data.Employee",Employee);
				editEmployee.employee = ObjectUtil.copy(employee) as Employee;
			}
		}
		
		private function handleLoadJobChargesResult(event:ResultEvent):void {
			trackerList = event.result as ArrayCollection;
		}
		
		private function handleLoadTCJobsResult(event:ResultEvent):void {
			trackerConsoleJobsList = event.result as ArrayCollection;
			if(refreshList){
				refreshList = false;
				if(selectedDGIndex>-1){
					if(trackerConsoleJobsList!=null && trackerConsoleJobsList.length>0){
						if(trackerConsoleJobsList.length-1>=selectedDGIndex) {
							employee_jobs_grid.selectedIndex = selectedDGIndex;
							selectedTrackerConsoleJob = employee_jobs_grid.selectedItem as TrackerConsoleJobs;
							registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
							progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
							enableRequiredBtns();
						} else {
							employee_jobs_grid.selectedIndex = trackerConsoleJobsList.length-1;
							selectedTrackerConsoleJob = employee_jobs_grid.selectedItem as TrackerConsoleJobs;
							registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
							progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
							enableRequiredBtns();
						}
					} else {
						selectedTrackerConsoleJob = null;
						progressBarComponent.trackerConsoleJobs = null;
						enableRequiredBtns();
					}
				}
			}
			if(closeEventTriggered){
				closeEventTriggered = false;
				if(selectedTrackerConsoleJob!=null){
					var counter:int=0;
					var checkFlag:Boolean = false;
					for each(var trackerConsoleJobsObj:TrackerConsoleJobs in trackerConsoleJobsList){
						counter++;
						if(trackerConsoleJobsObj.id == selectedTrackerConsoleJob.id){
							employee_jobs_grid.selectedIndex = counter;
							selectedTrackerConsoleJob = trackerConsoleJobsObj;
							registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
							progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
							checkFlag = true;
							break;
						}
					}
					if(!checkFlag){
						selectedTrackerConsoleJob = null;
						progressBarComponent.trackerConsoleJobs = null;
					}
				}
			}
		}
		
		public function getInvoiceNumber(object:Object):String {
			if(object is Job){
				var job:Job = object as Job;
				return String(job.parentInvoice.invoiceNumber);	
			}
			if(object is Charge){
				var charge:Charge = object as Charge;
				if(charge.parentInvoice!=null){
					return String(charge.parentInvoice.invoiceNumber);
				}
				if(charge.parentJob!=null){
					return String(charge.parentJob.jobNumber);
				}
			}
			return "";
		}
		
		public function getDeliveryDate(object:Object):String {
			if(object is Job){
				var job:Job = object as Job;
				return dateFormatter.format(job.parentInvoice.deliveryIntentDate);	
			}
			if(object is Charge){
				var charge:Charge = object as Charge;
				if(charge.parentInvoice!=null){
					return dateFormatter.format(charge.parentInvoice.deliveryIntentDate);
				}
				if(charge.parentJob!=null){
					return "";
				}
			}
			return "";
		}
		
		public function getProductionLoc(object:Object):String {
			if(object is Job){
				var job:Job = object as Job;
				return job.location.name;	
			}
			if(object is Charge){
				var charge:Charge = object as Charge;
				return charge.productionLocation.name;
			}
			return "";
		}
		
		public function getAccount(object:Object):String{
			if(object is Job){
				var job:Job = object as Job;
				return "#"+job.parentInvoice.account.id + " "+job.parentInvoice.account.title;	
			}
			if(object is Charge){
				var charge:Charge = object as Charge;
				if(charge.parentInvoice!=null){
					return "#"+job.parentInvoice.account.id + " "+job.parentInvoice.account.title;
				}
				if(charge.parentJob!=null){
					var jobBase:JobBase = charge.parentJob as JobBase;
					return "#"+jobBase.parentInvoice.account.id + " "+jobBase.parentInvoice.account.title;
				}
			}
			return "";
		}
		
		public function getJobDescription(object:Object):String {
			return object.description;
		}
		
		public function updateTrackerConsole():void {
			if(trackerConsole.productionFacilities!=null){
				if(trackerConsole.productionFacilities.id==0){
					trackerConsole.productionFacilities = null;
				}
			}
			if(trackerConsole.productionStations!=null){
				if(trackerConsole.productionStations.id==0){
					trackerConsole.productionStations = null;
				}
			}
			trackerConsole.selectedStations = new ArrayCollection();
			for each(var productionStation:ProductionStations in productionStations) {
				if(productionStation.isSelected) {
					trackerConsole.selectedStations.addItem(productionStation);
				}
			}
			
			dataService.addUpdate(trackerConsole);
		}
		
		private function handleSaveTrackerConsoleResult(event:ResultEvent):void {
			if(isNaN(trackerConsole.id) || trackerConsole.id==0){
				dataService.getSingle("TrackerConsole");
			}
		}
		
		private function doSelectJob(event:Event):void {
			selectedCharge = null;
			selectedJob = null;
			if(event.currentTarget.selectedItem is Job){
				selectedJob = event.currentTarget.selectedItem as Job;
			}
			if(event.currentTarget.selectedItem is Charge){
				selectedCharge = event.currentTarget.selectedItem as Charge;
			}
			resetButtons();
			startBtn.enabled = true;
			defaultEnableButtons();
		}
		
		private function resetButtons():void {
			startBtn.enabled = false;
			setUpBtn.enabled = false;
			washUpBtn.enabled = false;
			stopBtn.enabled = false;
			cancelBtn.enabled = false;
			pauseBtn.enabled = false;
			continueBtn.enabled = false;
			defaultEnableButtons();
		}
		
		private function defaultEnableButtons():void {
			openBtn.enabled = true;
			jobTicketBtn.enabled = true;
			layoutBtn.enabled = true;
		}
		
		private function startJob():void {
			if((selectedJob!=null || selectedCharge!=null) && trackerConsole.productionFacilities!=null && trackerConsole.productionStations!=null){
				for each(var trackerConsoleJobsObj:TrackerConsoleJobs in trackerConsoleJobsList) {
					if(trackerConsoleJobsObj.job!=null && selectedJob!=null){
						if(trackerConsoleJobsObj.job.id == selectedJob.id){
							Alert.show("This item has a activity started, would you like to reset the beginning timers?", "Confirmation", Alert.YES | Alert.NO , this, function(event:CloseEvent):void {
								if (event.detail==Alert.YES) {
									trackerStatus = "start";
									trackerConsoleJobsObj.firstTrackerDate = new Date();
									trackerConsoleJobsObj.firstTrackerTime = 0;
									trackerConsoleJobsObj.firstSetUpDate = null;
									trackerConsoleJobsObj.firstSetUpTime = 0;
									trackerConsoleJobsObj.firstRunDate = null;
									trackerConsoleJobsObj.firstRunTime = 0;
									trackerConsoleJobsObj.firstWashDate = null;
									trackerConsoleJobsObj.firstWashTime = 0;
									trackerConsoleJobsObj.firstSetUpCompleted = false;
									trackerConsoleJobsObj.firstRunCompleted = false;
									trackerConsoleJobsObj.firstWashCompleted = false;
									trackerConsoleJobsObj.secondTrackerDate = null;
									trackerConsoleJobsObj.secondTrackerTime = 0;
									trackerConsoleJobsObj.secondSetUpDate = null;
									trackerConsoleJobsObj.secondSetUpTime = 0;
									trackerConsoleJobsObj.secondRunDate = null;
									trackerConsoleJobsObj.secondRunTime = 0;
									trackerConsoleJobsObj.secondWashDate = null;
									trackerConsoleJobsObj.secondWashTime = 0;
									trackerConsoleJobsObj.secondSetUpCompleted = false;
									trackerConsoleJobsObj.secondRunCompleted = false;
									trackerConsoleJobsObj.secondWashCompleted = false;
									trackerConsoleJobsObj.currentPass = 1;
									trackerConsoleJobsObj.paused = false;
									updateDataServiceJob.addUpdate(trackerConsoleJobsObj);
								}
							});
							return;
						}
					} else if(trackerConsoleJobsObj.charge!=null && selectedCharge!=null){
						if(trackerConsoleJobsObj.charge.id == selectedCharge.id){
							Alert.show("This item has a activity started, would you like to reset the beginning timers?", "Confirmation", Alert.YES | Alert.NO , this, function(event:CloseEvent):void {
								if (event.detail==Alert.YES) {
									trackerStatus = "start";
									trackerConsoleJobsObj.firstTrackerDate = new Date();
									trackerConsoleJobsObj.firstTrackerTime = 0;
									trackerConsoleJobsObj.firstSetUpDate = null;
									trackerConsoleJobsObj.firstSetUpTime = 0;
									trackerConsoleJobsObj.firstRunDate = null;
									trackerConsoleJobsObj.firstRunTime = 0;
									trackerConsoleJobsObj.firstWashDate = null;
									trackerConsoleJobsObj.firstWashTime = 0;
									trackerConsoleJobsObj.firstSetUpCompleted = false;
									trackerConsoleJobsObj.firstRunCompleted = false;
									trackerConsoleJobsObj.firstWashCompleted = false;
									trackerConsoleJobsObj.secondTrackerDate = null;
									trackerConsoleJobsObj.secondTrackerTime = 0;
									trackerConsoleJobsObj.secondSetUpDate = null;
									trackerConsoleJobsObj.secondSetUpTime = 0;
									trackerConsoleJobsObj.secondRunDate = null;
									trackerConsoleJobsObj.secondRunTime = 0;
									trackerConsoleJobsObj.secondWashDate = null;
									trackerConsoleJobsObj.secondWashTime = 0;
									trackerConsoleJobsObj.secondSetUpCompleted = false;
									trackerConsoleJobsObj.secondRunCompleted = false;
									trackerConsoleJobsObj.secondWashCompleted = false;
									trackerConsoleJobsObj.currentPass = 1;
									trackerConsoleJobsObj.paused = false;
									updateDataServiceJob.addUpdate(trackerConsoleJobsObj);
								}
							});
							return;
						}
					}
				}
				trackerStatus = "start";
				resetButtons();
				setUpBtn.enabled = true;
				stopBtn.enabled = true;
				cancelBtn.enabled = true;
				pauseBtn.enabled = true;
				defaultEnableButtons();
				var trackerConsoleJobs:TrackerConsoleJobs = new TrackerConsoleJobs();
				trackerConsoleJobs.productionFacilities = trackerConsole.productionFacilities;
				trackerConsoleJobs.productionStations = trackerConsole.productionStations;
				trackerConsoleJobs.productionLocations = trackerConsole.productionLocation;
				trackerConsoleJobs.employee = employee;
				if(selectedJob!=null){
					trackerConsoleJobs.job = selectedJob;
				} else if(selectedCharge!=null){
					trackerConsoleJobs.charge = selectedCharge;
				}
				trackerConsoleJobs.actualSetUpTime = 25*60*1000;
				trackerConsoleJobs.actualRunTime = 10*60*1000;
				trackerConsoleJobs.actualWashTime = 30*60*1000;
				trackerConsoleJobs.firstTrackerDate = new Date();
				trackerConsoleJobs.duration = 0;
				trackerConsoleJobs.noOfPasses = 2;
				trackerConsoleJobs.currentPass = 1;
				saveDataServiceJob.addUpdate(trackerConsoleJobs);
			}
		}
		
		private function handleSaveJobResult(event:ResultEvent):void {
			var trackerConsoleJobs:TrackerConsoleJobs = event.result as TrackerConsoleJobs;
			trackerConsoleJobsList.addItem(trackerConsoleJobs);
			registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
			progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(trackerConsoleJobs) as TrackerConsoleJobs;
			selectedTrackerConsoleJob = trackerConsoleJobs;
			employee_jobs_grid.selectedIndex = (trackerConsoleJobsList.length-1);
			enableRequiredBtns();
		}
		
		private function setUpJob():void {
			if(selectedTrackerConsoleJob!=null){
				var nowDate:Date = new Date();
				var totalSetUpTime:Number = 0;
				trackerStatus = "setup";
				if(selectedTrackerConsoleJob.currentPass==1){
					selectedTrackerConsoleJob.firstSetUpCompleted = true;
					totalSetUpTime = (nowDate.time-selectedTrackerConsoleJob.firstTrackerDate.time);
					if(!(isNaN(selectedTrackerConsoleJob.firstTrackerTime)) && selectedTrackerConsoleJob.firstTrackerTime!=0){
						totalSetUpTime = totalSetUpTime + selectedTrackerConsoleJob.firstTrackerTime;
					}
					selectedTrackerConsoleJob.firstTrackerDate = nowDate;
					selectedTrackerConsoleJob.firstTrackerTime = 0;
					selectedTrackerConsoleJob.firstSetUpDate = nowDate;
					selectedTrackerConsoleJob.firstSetUpTime = totalSetUpTime;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
				if(selectedTrackerConsoleJob.currentPass==2){
					selectedTrackerConsoleJob.secondSetUpCompleted = true;
					totalSetUpTime = (nowDate.time-selectedTrackerConsoleJob.secondTrackerDate.time);
					if(!(isNaN(selectedTrackerConsoleJob.secondTrackerTime)) && selectedTrackerConsoleJob.secondTrackerTime!=0){
						totalSetUpTime = totalSetUpTime + selectedTrackerConsoleJob.secondTrackerTime;
					}
					selectedTrackerConsoleJob.secondTrackerDate = nowDate;
					selectedTrackerConsoleJob.secondTrackerTime = 0;
					selectedTrackerConsoleJob.secondSetUpDate = nowDate;
					selectedTrackerConsoleJob.secondSetUpTime = totalSetUpTime;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
			}
		}
		
		private function washUpJob():void {
			if(selectedTrackerConsoleJob!=null){
				var nowDate:Date = new Date();
				var totalRunTime:Number = 0;
				trackerStatus = "washup";
				if(selectedTrackerConsoleJob.currentPass==1){
					selectedTrackerConsoleJob.firstRunCompleted = true;
					totalRunTime = (nowDate.time-selectedTrackerConsoleJob.firstTrackerDate.time);
					if(!(isNaN(selectedTrackerConsoleJob.firstTrackerTime)) && selectedTrackerConsoleJob.firstTrackerTime!=0){
						totalRunTime = totalRunTime + selectedTrackerConsoleJob.firstTrackerTime;
					}
					selectedTrackerConsoleJob.firstTrackerDate = nowDate;
					selectedTrackerConsoleJob.firstTrackerTime = 0;
					selectedTrackerConsoleJob.firstRunDate = nowDate;
					selectedTrackerConsoleJob.firstRunTime = totalRunTime;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
				if(selectedTrackerConsoleJob.currentPass==2){
					selectedTrackerConsoleJob.secondRunCompleted = true;
					totalRunTime = (nowDate.time-selectedTrackerConsoleJob.secondTrackerDate.time);
					if(!(isNaN(selectedTrackerConsoleJob.secondTrackerTime)) && selectedTrackerConsoleJob.secondTrackerTime!=0){
						totalRunTime = totalRunTime + selectedTrackerConsoleJob.secondTrackerTime;
					}
					selectedTrackerConsoleJob.secondTrackerDate = nowDate;
					selectedTrackerConsoleJob.secondTrackerTime = 0;
					selectedTrackerConsoleJob.secondRunDate = nowDate;
					selectedTrackerConsoleJob.secondRunTime = totalRunTime;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
			}
		}
		
		private function stopOrNextPassJob():void {
			if(selectedTrackerConsoleJob!=null){
				var nowDate:Date = new Date();
				var totalWashTime:Number = 0;
				trackerStatus = "stop";
				if(selectedTrackerConsoleJob.currentPass==1){
					if(!selectedTrackerConsoleJob.paused) {
						totalWashTime = (nowDate.time-selectedTrackerConsoleJob.firstTrackerDate.time);
					}
					if(!(isNaN(selectedTrackerConsoleJob.firstTrackerTime)) && selectedTrackerConsoleJob.firstTrackerTime!=0){
						totalWashTime = totalWashTime + selectedTrackerConsoleJob.firstTrackerTime;
					}
					selectedTrackerConsoleJob.firstTrackerDate = nowDate;
					selectedTrackerConsoleJob.firstTrackerTime = 0;
					if(!selectedTrackerConsoleJob.firstSetUpCompleted || !selectedTrackerConsoleJob.firstRunCompleted){
						selectedTrackerConsoleJob.firstRunDate = nowDate;
						selectedTrackerConsoleJob.firstRunTime = totalWashTime;
					} else {
						selectedTrackerConsoleJob.firstWashDate = nowDate;
						selectedTrackerConsoleJob.firstWashTime = totalWashTime;
						selectedTrackerConsoleJob.firstWashCompleted = true;
					}
					if(selectedTrackerConsoleJob.noOfPasses==2){
						trackerStatus = "nextpass";
						selectedTrackerConsoleJob.currentPass = 2;
						selectedTrackerConsoleJob.paused = false;
						selectedTrackerConsoleJob.secondTrackerDate = new Date();
					} else {
						selectedTrackerConsoleJob.completed = true;
						selectedTrackerConsoleJob.completedDate = nowDate;
					}
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				} else if(selectedTrackerConsoleJob.currentPass==2){
					selectedTrackerConsoleJob.completed = true;
					selectedTrackerConsoleJob.completedDate = nowDate;
					if(!selectedTrackerConsoleJob.paused) {
						totalWashTime = (nowDate.time-selectedTrackerConsoleJob.secondTrackerDate.time);
					}
					if(!(isNaN(selectedTrackerConsoleJob.secondTrackerTime)) && selectedTrackerConsoleJob.secondTrackerTime!=0){
						totalWashTime = totalWashTime + selectedTrackerConsoleJob.secondTrackerTime;
					}
					selectedTrackerConsoleJob.secondTrackerDate = nowDate;
					selectedTrackerConsoleJob.secondTrackerTime = 0;
					if(!selectedTrackerConsoleJob.secondSetUpCompleted || !selectedTrackerConsoleJob.secondRunCompleted){
						selectedTrackerConsoleJob.secondRunDate = nowDate;
						selectedTrackerConsoleJob.secondRunTime = totalWashTime;
					} else {
						selectedTrackerConsoleJob.secondWashDate = nowDate;
						selectedTrackerConsoleJob.secondWashTime = totalWashTime;
						selectedTrackerConsoleJob.secondWashCompleted = true;
					}
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
			}
		}
		
		private function pauseJob():void {
			if(selectedTrackerConsoleJob!=null){
				trackerStatus = "pause";
				var nowDate:Date = new Date();
				if(selectedTrackerConsoleJob.currentPass==1){
					selectedTrackerConsoleJob.firstTrackerTime = nowDate.time - selectedTrackerConsoleJob.firstTrackerDate.time+(isNaN(selectedTrackerConsoleJob.firstTrackerTime)?0:selectedTrackerConsoleJob.firstTrackerTime);
					selectedTrackerConsoleJob.firstTrackerDate = nowDate;
					selectedTrackerConsoleJob.paused = true;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
				if(selectedTrackerConsoleJob.currentPass==2){
					selectedTrackerConsoleJob.secondTrackerTime = nowDate.time - selectedTrackerConsoleJob.secondTrackerDate.time+(isNaN(selectedTrackerConsoleJob.secondTrackerTime)?0:selectedTrackerConsoleJob.secondTrackerTime);
					selectedTrackerConsoleJob.secondTrackerDate = nowDate;
					selectedTrackerConsoleJob.paused = true;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
			}
		}
		
		private function continueJob():void {
			if(selectedTrackerConsoleJob!=null){
				trackerStatus = "continue";
				var nowDate:Date = new Date();
				if(selectedTrackerConsoleJob.currentPass==1){
					selectedTrackerConsoleJob.firstTrackerDate = nowDate;
					selectedTrackerConsoleJob.paused = false;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
				if(selectedTrackerConsoleJob.currentPass==2){
					selectedTrackerConsoleJob.secondTrackerDate = nowDate;
					selectedTrackerConsoleJob.paused = false;
					updateDataServiceJob.addUpdate(selectedTrackerConsoleJob);
				}
			}
		}
		
		private function handleUpdateJobResult(event:ResultEvent):void {
			resetButtons();
			if(trackerStatus=="start"){
				var trackerConsoleJobsObject:TrackerConsoleJobs = event.result as TrackerConsoleJobs;
				if(trackerConsoleJobsObject!=null){
					setUpBtn.enabled = true;
					washUpBtn.enabled = true;
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					pauseBtn.enabled = true;
					defaultEnableButtons();
					var counter:int = 0;
					for each(var trackerConsoleJobsObj:TrackerConsoleJobs in trackerConsoleJobsList){
						counter++;
						if(trackerConsoleJobsObject.job!=null && trackerConsoleJobsObj.job!=null){
							if(trackerConsoleJobsObject.job.id==trackerConsoleJobsObj.job.id){
								selectedTrackerConsoleJob = trackerConsoleJobsObj;
								employee_jobs_grid.selectedIndex = counter;
								registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
								progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
								enableRequiredBtns();
								break;
							}
							
						} else if(trackerConsoleJobsObject.charge!=null && trackerConsoleJobsObj.charge!=null) {
							if(trackerConsoleJobsObject.charge.id==trackerConsoleJobsObj.charge.id){
								selectedTrackerConsoleJob = trackerConsoleJobsObj;
								employee_jobs_grid.selectedIndex = counter;
								registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
								progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
								enableRequiredBtns();
								break;
							}
						}
					}
				}
			} else if(trackerStatus=="setup"){
				if(selectedTrackerConsoleJob!=null){
					washUpBtn.enabled = true;
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					pauseBtn.enabled = true;
					defaultEnableButtons();
					registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
					progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
				}
			} else if(trackerStatus=="washup"){
				if(selectedTrackerConsoleJob!=null){
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					pauseBtn.enabled = true;
					defaultEnableButtons();
					registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
					progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
				}
			} else if(trackerStatus=="pause"){
				if(selectedTrackerConsoleJob!=null){
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					continueBtn.enabled = true;
					defaultEnableButtons();
					registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
					progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
				}
			} else if(trackerStatus=="continue"){
				if(selectedTrackerConsoleJob!=null){
					if(selectedTrackerConsoleJob.currentPass==1){
						if(selectedTrackerConsoleJob.firstSetUpCompleted){
							washUpBtn.enabled = true;
						} else {
							setUpBtn.enabled = true;
							washUpBtn.enabled = true;
						}
					}
					if(selectedTrackerConsoleJob.currentPass==2){
						if(selectedTrackerConsoleJob.secondSetUpCompleted){
							washUpBtn.enabled = true;
						} else {
							setUpBtn.enabled = true;
							washUpBtn.enabled = true;
						}
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					pauseBtn.enabled = true;
					defaultEnableButtons();
					registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
					progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
				}
			} else if(trackerStatus=="stop"){
				if(selectedTrackerConsoleJob!=null){
					selectedDGIndex = employee_jobs_grid.selectedIndex;
					if(selectedDGIndex>-1){
						if(employee!=null){
							refreshList = true;
							dataService.getActiveTrackerConsoleJobsBasedOnEmployee(employee);
						}
					}
					progressBarComponent.stopJob();
				}
			} else if(trackerStatus=="nextpass"){
				if(selectedTrackerConsoleJob!=null){
					resetButtons();
					setUpBtn.enabled = true;
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					pauseBtn.enabled = true;
					defaultEnableButtons();
					registerClassAlias("com.efi.printsmith.data.TrackerConsoleJobs",TrackerConsoleJobs);
					progressBarComponent.trackerConsoleJobs = ObjectUtil.copy(selectedTrackerConsoleJob) as TrackerConsoleJobs;
				}
			}
			/* var trackerConsoleJobs:TrackerConsoleJobs = event.result as TrackerConsoleJobs;
			trackerConsoleJobsList.addItem(trackerConsoleJobs);
			progressBarComponent.trackerConsoleJobs = trackerConsoleJobs; */
		}
		
		private function enableRequiredBtns():void {
			if(selectedTrackerConsoleJob!=null){
				if(selectedTrackerConsoleJob.firstSetUpCompleted && selectedTrackerConsoleJob.firstRunCompleted
					&& selectedTrackerConsoleJob.currentPass==1){
					resetButtons();
					if(!selectedTrackerConsoleJob.paused){
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					defaultEnableButtons();
				} else if(selectedTrackerConsoleJob.firstSetUpCompleted && selectedTrackerConsoleJob.currentPass==1){
					resetButtons();
					if(!selectedTrackerConsoleJob.paused){
						washUpBtn.enabled = true;
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					defaultEnableButtons();
				} else if(selectedTrackerConsoleJob.firstRunCompleted && selectedTrackerConsoleJob.currentPass==1){
					resetButtons();
					if(!selectedTrackerConsoleJob.paused){
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					defaultEnableButtons();
				} else if(selectedTrackerConsoleJob.secondSetUpCompleted && selectedTrackerConsoleJob.secondRunCompleted
					&& selectedTrackerConsoleJob.currentPass==2){
					resetButtons();
					if(!selectedTrackerConsoleJob.paused){
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					defaultEnableButtons();
				} else if(selectedTrackerConsoleJob.secondSetUpCompleted && selectedTrackerConsoleJob.currentPass==2){
					resetButtons();
					if(!selectedTrackerConsoleJob.paused){
						washUpBtn.enabled = true;
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					defaultEnableButtons();
				} else if(selectedTrackerConsoleJob.secondRunCompleted && selectedTrackerConsoleJob.currentPass==2){
					resetButtons();
					if(!selectedTrackerConsoleJob.paused){
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					defaultEnableButtons();
				} else {
					resetButtons();
					stopBtn.enabled = true;
					cancelBtn.enabled = true;
					if(!selectedTrackerConsoleJob.paused){
						setUpBtn.enabled = true;
						pauseBtn.enabled = true;
					} else {
						continueBtn.enabled = true;
					}
					defaultEnableButtons();
				}
			} else {
				resetButtons();
			}
		}
		
		private function getStopNextPassLabel(tcJob:TrackerConsoleJobs):String {
			if(tcJob!=null){
				if(tcJob.noOfPasses==2 && tcJob.currentPass==1){
					return resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.NextPass');
				}
			}
			return resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Stop');
		} 
				
	]]>
	                        
	</mx:Script>	
	
	<mx:DateFormatter id="dateFormatter" formatString="MM/DD/YYYY L:NN A EEE"/>
	
	<mx:TabNavigator width="100%" height="100%">
		<mx:VBox label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.ActiveItems')}" 
			paddingLeft="20" paddingTop="20" width="100%" height="100%">
			
			<mx:HBox width="100%">
				<mx:Label text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Employee')}"/>
				<components:CustomComboBoxComponent width="20%" change="{getEmployee(event)}"
					masterList="{employeesArray}" updateObject="true" objectLabelFieldId="employeeId" labelFieldId="employeeId" labelFieldName="employeeName"
					dataHolder="{trackerConsole}" variableName="selectedEmployee" customText="{getCustomTextData(employeesArray,trackerConsole,trackerConsole.selectedEmployee)}"/>
				<mx:Image source="@Embed(source='../../../../assets/punchclock.png')" 
					click="{openClockInOut()}" buttonMode="true" useHandCursor="true"/>		
				<mx:Image source="@Embed(source='../../../../assets/EmployeeEdit.png')" 
					click="{openEditEmployee()}" buttonMode="true" useHandCursor="true"/>
			</mx:HBox>
			
			<mx:DataGrid width="90%" height="30%" id="invoiceGrid" dataProvider="{trackerList}" itemClick="{doSelectJob(event)}">
				<mx:columns>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Item')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getInvoiceNumber(data)}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Description')}" dataField="description"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.DeliveryDate')}">
					<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getDeliveryDate(data)}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.ProductionLocation')}">
					<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getProductionLoc(data)}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.RunDate')}" dataField="col2"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.ActiveLocation')}" dataField="col3"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Estimated')}" dataField="col1"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Priority')}" dataField="col2"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Machine')}" dataField="col2"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Account')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getAccount(data)}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
				</mx:columns>
			</mx:DataGrid>
			
			<mx:HBox width="100%" height="50%">
				<mx:VBox width="50%" height="100%">
					<mx:Panel width="100%" height="50%" paddingTop="10" paddingLeft="5" 
						layout="vertical" title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.CurrentStation')}">
					
						<mx:HBox width="100%">
							<mx:Label width="15%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Facility')}" textAlign="right"/>
							<components:CustomComboBoxComponent width="40%" enabled="false"
								masterList="{facilitiesArray}" updateObject="true" objectLabelFieldId="id" labelFieldId="id" labelFieldName="name"
								dataHolder="{trackerConsole}" variableName="productionFacilities" customText="{getCustomTextData(facilitiesArray,trackerConsole,trackerConsole.productionFacilities)}"/>
						</mx:HBox>
						
						<mx:HBox width="100%">
							<mx:Label width="15%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.StationName')}" textAlign="right"/>
							<components:CustomComboBoxComponent width="40%" enabled="false"
								masterList="{stationsArray}" updateObject="true" objectLabelFieldId="id" labelFieldId="id" labelFieldName="name"
								dataHolder="{trackerConsole}" variableName="productionStations" customText="{getCustomTextData(stationsArray,trackerConsole,trackerConsole.productionStations)}"/>
						</mx:HBox>
						
						<mx:HBox width="100%">
							<mx:Label width="15%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Location')}" textAlign="right"/>
							<components:CustomComboBoxComponent width="40%"
								masterList="{productionLocationArray}" updateObject="true" objectLabelFieldId="id" labelFieldId="id" labelFieldName="name"
								dataHolder="{trackerConsole}" variableName="productionLocation" customText="{getCustomTextData(productionLocationArray,trackerConsole,trackerConsole.productionLocation)}"
								change="{updateTrackerConsole()}"/>
						</mx:HBox>	
						
					</mx:Panel>
					<mx:Panel width="100%" height="50%" paddingTop="10" paddingLeft="5" 
						layout="vertical" title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.BarcodeInput')}">
						<mx:HBox width="100%" height="100%">
							<mx:VBox width="40%" height="100%">
								<mx:HBox width="100%">
									<mx:Label width="40%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Doc')}" 
										textAlign="right"/>
									<mx:TextInput width="40%" id="doc_edit"/>	
								</mx:HBox>
								<mx:HBox width="100%">
									<mx:Label width="40%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Job')}"
										textAlign="right"/>
									<mx:TextInput width="40%" id="job_edit"/>
								</mx:HBox>
								<mx:HBox width="100%">
									<mx:Label width="40%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Charge')}"
										textAlign="right"/>
									<mx:TextInput width="40%" id="charge_edit"/>
								</mx:HBox>
							</mx:VBox>
							<mx:VBox width="60%" height="100%">
								<mx:HBox width="100%">
									<mx:Label width="35%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Facility')}"
										textAlign="right"/>
									<mx:TextInput width="55%" id="barcode_facility_edit"/>
								</mx:HBox>
								<mx:HBox width="100%">
									<mx:Label width="35%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Location')}"
										textAlign="right"/>
									<mx:TextInput width="55%" id="barcode_location_edit"/>
								</mx:HBox>
								<mx:HBox width="100%">
									<mx:Label width="35%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Employee')}"
										textAlign="right"/>
									<mx:TextInput width="55%" id="barcode_employee_edit"/>
								</mx:HBox>
							</mx:VBox>
						</mx:HBox>
					</mx:Panel>	
				</mx:VBox>
				<mx:VBox width="40%" height="100%" verticalAlign="middle">
					<mx:HBox width="100%">
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Start')}" 
							labelPlacement="bottom" width="20%" click="{startJob()}" id="startBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingStart.png')</mx:icon>
						</mx:Button>
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Setup')}" 
							labelPlacement="bottom" width="20%" click="{setUpJob()}" id="setUpBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingSetupDone.png')</mx:icon>
						</mx:Button>
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Washup')}" 
							labelPlacement="bottom" width="20%" click="{washUpJob()}" id="washUpBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingWashupStart.png')</mx:icon>
						</mx:Button>
						<mx:Button label="{getStopNextPassLabel(selectedTrackerConsoleJob)}" 
							labelPlacement="bottom" width="20%" click="{stopOrNextPassJob()}" id="stopBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingStop.png')</mx:icon>
						</mx:Button> 
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Cancel')}" 
							labelPlacement="bottom" width="20%" id="cancelBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingCancel.png')</mx:icon>
						</mx:Button>
					</mx:HBox>
					<mx:HBox width="100%">
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Pause')}" 
							labelPlacement="bottom" width="20%" click="{pauseJob()}" id="pauseBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingPause.png')</mx:icon>
						</mx:Button>
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Continue')}" 
							labelPlacement="bottom" width="20%" click="{continueJob()}" id="continueBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingContinue.png')</mx:icon>
						</mx:Button>
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Open')}" 
							labelPlacement="bottom" width="20%" id="openBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingInvOpen.png')</mx:icon>
						</mx:Button>
						
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.JobTicket')}" 
							labelPlacement="bottom" width="20%" id="jobTicketBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingTickets.png')</mx:icon>
						</mx:Button>
						<mx:Button label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Layout')}" 
							labelPlacement="bottom" width="20%" id="layoutBtn" enabled="false">
							<mx:icon>@Embed(source='../../../../assets/TrackingCutouts.png')</mx:icon>
						</mx:Button>
					</mx:HBox>
				</mx:VBox>
			</mx:HBox>
			
			
			
			
			<mx:DataGrid width="90%" height="20%" id="employee_jobs_grid" dataProvider="{trackerConsoleJobsList}" itemClick="{doConsoleJobSelection(event)}">
				<mx:columns>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Item')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getInvoiceNumber((data.job==null?data.charge:data.job))}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Description')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getJobDescription((data.job==null?data.charge:data.job))}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.TimeQty')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text=""/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Duration')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text=""/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Who')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{data.employee.lastName}, {data.employee.firstName}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Facility')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{data.productionFacilities.name}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Station')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{data.productionStations.name}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Location')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{data.productionLocations.name}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Machine')}">
					</mx:DataGridColumn>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'deliveryTicketMgrCmd.Account')}">
						<mx:itemRenderer>
							<mx:Component>
								<mx:Label text="{outerDocument.getAccount((data.job==null?data.charge:data.job))}"/>
							</mx:Component>
						</mx:itemRenderer>
					</mx:DataGridColumn>
				</mx:columns>
			</mx:DataGrid>
			
			<mx:Spacer height="5%"/>
			
			<trackercomponent:TrackerProgressBarComponent id="progressBarComponent" width="98%" height="15%"/>
			
		</mx:VBox>
		
		<mx:VBox label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Preference')}"
			paddingLeft="20" paddingTop="20" width="100%" height="100%">
			<mx:HBox width="60%" height="60%">
				<mx:VBox width="50%" height="100%">
						<mx:Panel width="100%" height="50%" layout="vertical" title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Startnewitemshere')}"
							paddingLeft="20" paddingTop="20">
							<mx:HBox width="100%">
								<mx:Label width="40%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Facility')}"
									textAlign="right"/>
								<components:CustomComboBoxComponent width="55%"
									masterList="{facilitiesArray}" updateObject="true" objectLabelFieldId="id" labelFieldId="id" labelFieldName="name"
									dataHolder="{trackerConsole}" variableName="productionFacilities" customText="{getCustomTextData(facilitiesArray,trackerConsole,trackerConsole.productionFacilities)}"
									change="{updateTrackerConsole()}"/>
							</mx:HBox>
							<mx:HBox width="100%">
								<mx:Label width="40%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.StationName')}"
									textAlign="right"/>
								<components:CustomComboBoxComponent width="55%"
									masterList="{stationsArray}" updateObject="true" objectLabelFieldId="id" labelFieldId="id" labelFieldName="name"
									dataHolder="{trackerConsole}" variableName="productionStations" customText="{getCustomTextData(stationsArray,trackerConsole,trackerConsole.productionStations)}"
									change="{updateTrackerConsole()}"/>
							</mx:HBox>
						</mx:Panel>
						<mx:Panel width="100%" height="50%" layout="vertical" title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.ShowThesePendingItem')}"
							paddingLeft="20" paddingTop="20">
							<components:CustomCheckBoxComponent label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.HideItemsNotReleased')}"
								dataHolder="{trackerConsole}" customText="{trackerConsole.hideItemsNotReleasedToProd}" variableName="hideItemsNotReleasedToProd"
								selectedValue="true" deSelectedValue="false" defaultValue="false" click="{updateTrackerConsole()}"/>
							<components:CustomCheckBoxComponent label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.OnlyShowEmployeesPro')}"
								dataHolder="{trackerConsole}" customText="{trackerConsole.showEmployeeProdParents}" variableName="showEmployeeProdParents"
								selectedValue="true" deSelectedValue="false" defaultValue="false" click="{updateTrackerConsole()}"/>
						</mx:Panel>
					
				</mx:VBox>
				<mx:VBox width="50%" height="100%">
					<mx:Panel width="100%" height="100%" layout="vertical" title="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Showtheseactiveitems')}"
						paddingLeft="20" paddingTop="20">
						<components:CustomCheckBoxComponent label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.Selectedemployeeonly')}"
								dataHolder="{trackerConsole}" customText="{trackerConsole.showSelectedEmployee}" variableName="showSelectedEmployee"
								selectedValue="true" deSelectedValue="false" defaultValue="false" click="{updateTrackerConsole()}"/>
						<components:CustomCheckBoxComponent label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.ShowAllFacilities')}"
								dataHolder="{trackerConsole}" customText="{trackerConsole.showAllFacilities}" variableName="showAllFacilities"
								selectedValue="true" deSelectedValue="false" defaultValue="false" click="{updateTrackerConsole()}"/>
						<components:CustomCheckBoxComponent label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.ShowAllStations')}"
								dataHolder="{trackerConsole}" customText="{trackerConsole.showAllStations}" variableName="showAllStations"
								selectedValue="true" deSelectedValue="false" defaultValue="false" click="{updateTrackerConsole()}"/>
						<mx:Label text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowDetailsCmd.Station')}"/>
						<mx:DataGrid width="90%" id="stations" dataProvider="{productionStations}">
							<mx:columns>
								<mx:DataGridColumn id="checkAllCol" headerText=" "
									sortable="false" dataField="isSelected" width="200">
									<mx:headerRenderer>
										<mx:Component>
											<components:CheckBoxHeaderRenderer click="{outerDocument.updateTrackerConsole()}" />
										</mx:Component>
									</mx:headerRenderer>
									<mx:itemRenderer>
										<mx:Component>
											<components:CustomCheckBoxComponent click="{outerDocument.updateTrackerConsole()}" 
												datagridControl="true" variableName="isSelected" customText="{data.isSelected}"
												selectedValue="true" deSelectedValue="false" defaultValue="false"/>
										</mx:Component>
									</mx:itemRenderer>
								</mx:DataGridColumn>
								<mx:DataGridColumn dataField="name" headerText="Station Name" width="800"/>
							</mx:columns>
						</mx:DataGrid>
					</mx:Panel>
				</mx:VBox>
				
				
				
			</mx:HBox>
		</mx:VBox>
		<mx:VBox label="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.CompletedItems')}"
			paddingLeft="20" paddingTop="20" width="100%" height="85%">
			<mx:DataGrid width="90%" height="100%" id="completed_grid">
				<mx:columns>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowCmd.DateCompleted')}" dataField="col1"/>
					<mx:DataGridColumn headerText="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'workflowStopCmd.Item')}" dataField="col2"/>
				</mx:columns>
			</mx:DataGrid>
		</mx:VBox>
	</mx:TabNavigator>
	
</mx:Panel>
