<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:vo="com.efi.printsmith.vo.*" width="576" height="346" showCloseButton="false" creationComplete="init()"
    close="PopUpManager.removePopUp(this);"
    title="Utilities" xmlns:text="flash.text.*" borderThickness="3" borderStyle="solid" horizontalScrollPolicy="off" 
    label="Utilities" name="Utilities"
    verticalScrollPolicy="off">
<mx:Script>
                                   
<![CDATA[ 
	import com.efi.printsmith.data.Contact;           
    import com.efi.printsmith.data.Account;    
    import com.efi.printsmith.view.EditContact;
    import com.efi.printsmith.view.EditCustomer;    
    import com.efi.printsmith.view.PressDefinitions;
    import com.efi.printsmith.data.Charge;   
    import com.efi.printsmith.events.PriceListPickerSelectEvent;
         
	import mx.managers.PopUpManager;     
	import com.efi.printsmith.data.SpeedTable;  
	import com.efi.printsmith.data.PriceList;
	import com.efi.printsmith.data.PriceListBase; 
	import com.efi.printsmith.data.WasteChart;                          
	import mx.controls.Alert;                          
	import mx.containers.Canvas;   
	import mx.core.Container;                      
	import mx.rpc.events.ResultEvent;                                 
	import mx.rpc.events.FaultEvent;                          
	import mx.events.ValidationResultEvent;                          
	import mx.validators.Validator;       
	import mx.messaging.messages.AsyncMessage;
	import mx.messaging.messages.IMessage;
	import mx.core.Application;
	import mx.collections.ArrayCollection;
	import flash.net.FileReference;
	
	private var fileReference:FileReference;
	private var servletTarget:URLRequest = new URLRequest("http://localhost:8080/Snowmass/ImportServlet");
	private var loader:Loader;
	                                                       
	private function init():void {   
	}
	
	private function handleLoadFileComplete(event:Event):void {
	}
		
	private function handleIOError(event:IOErrorEvent):void {
		if (event.target != null) {
			
		}
	}
	
	private function handleSelectChargeDefinitionsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("ChargeDefinitions");
	}
	
	private function handleSelectContactsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("Contacts");
	}
	
	private function handleSelectCopierDefinitionsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("CopierDefinitions");
	}

	private function handleSelectCustomerLogsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("CustomerLogs");
	}
	
	private function handleSelectCustomerFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("Customers");
	}

	private function handleSelectInvoicesFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("Invoices");
	}
	
	private function handleSelectJobsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("Jobs");
	}
	
	private function handleSelectPressDefinitionsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("PressDefinitions");
	}

	private function handleSelectPriceListsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("PriceLists");
	}

	private function handleSelectStockDefinitionsFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("StockDefinitions");
	}

	private function handleSelectTaxTablesFile(evt:Event):void {
		fileReference.addEventListener(Event.COMPLETE, handleLoadFileComplete);
		fileReference.addEventListener(IOErrorEvent.IO_ERROR, handleIOError);
		uploadFile("TaxTables");
	}

	private function uploadFile(fileType:String):void {
		var urlVariables:URLVariables = new URLVariables();
		urlVariables.importType = fileType;
		servletTarget.data = urlVariables;
		servletTarget.method = URLRequestMethod.POST;
		fileReference.upload(servletTarget);		
	}
	
	private function handleCancelFile(evt:Event):void {
		
	}
	
	private function doImport(listener:Function):void {
		fileReference = new FileReference();
		fileReference.addEventListener(Event.SELECT, listener);
		fileReference.addEventListener(Event.CANCEL, handleCancelFile);
		fileReference.browse();
	}
	private function doImportCustomers():void {
		doImport(handleSelectCustomerFile);
	}
	
	private function doImportChargeDefinitions():void {
		doImport(handleSelectChargeDefinitionsFile);
	}

	private function doImportContacts():void {
		doImport(handleSelectContactsFile);
	}
	
	private function doImportCustomerLogs():void {
		doImport(handleSelectCustomerLogsFile);
	}
	
	private function doImportInvoices():void {
		doImport(handleSelectInvoicesFile);
	} 

	private function doImportJobs():void {
		doImport(handleSelectJobsFile); 
	}
	
	private function doImportPressDefinitions():void {  
		doImport(handleSelectPressDefinitionsFile);
	}
	
	private function doImportPriceLists():void {
		doImport(handleSelectPriceListsFile);
	}
	
	private function doImportCopierDefinitions():void {
		doImport(handleSelectCopierDefinitionsFile);
	}

	private function doImportStockDefinitions():void {
		doImport(handleSelectStockDefinitionsFile);
	}
	
	private function doImportTaxTables():void {
		doImport(handleSelectTaxTablesFile);
	}

]]>        
</mx:Script>
                             

                             
	<mx:Canvas width="100%" height="100%" verticalScrollPolicy="off" horizontalScrollPolicy="off">
		<mx:Button label="Import Customers &amp; Customer Contacts" id="import_customers" enabled="true" click="doImportCustomers();"  width="256" x="10" y="70"/>
		<mx:Button label="Import Charge Definitions" id="import_charge_definitions" enabled="true" click="doImportChargeDefinitions();"  width="256" x="10" y="10"/>
		<mx:Button label="Import Standalone Contacts" id="import_contacts" enabled="true" click="doImportContacts();"  width="256" x="10" y="40"/>
		<mx:Button label="Import Customer Logs" id="import_customer_logs" enabled="true" click="doImportCustomerLogs();"  width="256" x="10" y="100"/>
		<mx:Button label="Import Invoices" id="import_invoices" enabled="true" click="doImportInvoices();"  width="256" x="10" y="130"/>
		<mx:Button label="Import Jobs" id="import_jobs" enabled="true" click="doImportJobs();"  width="256" x="10" y="160"/>
		<mx:Button label="Import Press Definitions" id="import_press_definitions" enabled="true" click="doImportPressDefinitions();"  width="256" x="10" y="190"/>
		<mx:Button label="Import Price Lists" id="import_price_lists" enabled="true" click="doImportPriceLists();"  width="256" x="10" y="220"/>
		<mx:Button label="Import Copier Definitions" id="import_copier_definitions" enabled="true" click="doImportCopierDefinitions();"  width="256" x="274" y="10"/>
		<mx:Button label="Import Stock Definitions" id="import_stock_definitions" enabled="true" click="doImportStockDefinitions();"  width="256" x="274" y="40"/>
		<mx:Button label="Import Tax Tables" id="import_tax_tables" enabled="true" click="doImportTaxTables();"  width="256" x="274" y="70"/>
	</mx:Canvas>
<mx:Spacer height="10" />        

</mx:TitleWindow>