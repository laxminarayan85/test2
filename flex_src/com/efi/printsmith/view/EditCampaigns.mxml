<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:view="com.efi.printsmith.view.*" xmlns:vo="com.efi.printsmith.vo.*" xmlns:fc="http://www.adobe.com/2006/fc" xmlns:hc="com.hillelcoren.components.*"
width="548" height="100%" title="Campaign Editor"  close="PopUpManager.removePopUp(this);" showCloseButton="true"
creationComplete="init()" label="Campaign Editor" name="Campaign Editor" xmlns:ns1="com.efi.printsmith.components.*">

<mx:RemoteObject id="dataService" destination="dataService">
	<mx:method name="getAll" fault="handleFault(event)" result="handleLoadResult(event)"/>
	<mx:method name="addUpdate" fault="handleFault(event)" result="handleSaveResult(event)"/>
</mx:RemoteObject>




<mx:Script> 
                                  
<![CDATA[
	
	import com.efi.printsmith.data.Campaigns;
	import com.efi.printsmith.data.Grade
	import com.efi.printsmith.events.CampaignEditCompleteEvent;
	import mx.controls.Alert;                                         
	import mx.managers.PopUpManager;                                         
	import mx.containers.TitleWindow;                                         
	import mx.collections.ArrayCollection;                                         
	import mx.rpc.events.ResultEvent;                                         
	import mx.rpc.events.FaultEvent;                                         
	import mx.messaging.messages.AsyncMessage;
	import mx.messaging.messages.IMessage;
    import mx.printing.FlexPrintJob;
    import mx.printing.PrintAdvancedDataGrid;
    import mx.printing.PrintDataGrid;
    import mx.core.Application;
    import mx.validators.Validator;
    import mx.events.ValidationResultEvent;    
    
    [Bindable]            
    private var campaignsarray:ArrayCollection = new ArrayCollection();
                 
	[Bindable]                                         
	private var campaign:Campaigns;
	
	[Bindable]	
	private var grade:Grade;
		
	    
   
	public function init():void {
		dataService.getAll("Campaigns");  
		campaign = new Campaigns();
	}      

	private function doNew():void {
		campaign_name.text = "";
		global_campaign.selected = false;
		campaign = new Campaigns();
	
	}  
	private function doDelete():void {
	 
	 	
	}  
	private function doGet():void{
		
		
	   	    
	}    
		
	private function doSave():void {
		campaign.name = campaign_name.text;
		campaign.globalCampaign = global_campaign.selected;
		dataService.addUpdate(campaign);
	
		                                    		
	}   

	
	 private function handleSaveResult(ev:ResultEvent):void {
		this.campaign = ev.result as Campaigns;
		var selectEvent:CampaignEditCompleteEvent = new CampaignEditCompleteEvent(CampaignEditCompleteEvent.SAVE, this.campaign );
		dispatchEvent(selectEvent);
		PopUpManager.removePopUp(this);
	
	}

	
	private function handleLoadResult(ev:ResultEvent):void {
		campaignsarray = ev.result as ArrayCollection; 
		
	}
	

	private function handleFault(ev:FaultEvent):void {  
		var message:String;
		              
		message = "Error: "                          
		+ ev.fault.faultCode + " - "                                  
		+ ev.fault.faultDetail + " - "                                  
		+ ev.fault.faultString;
		Alert.show(message, "Error", 0, null, null, null, 4);                                 
	}
	
	
	private function dataRefresh():void{
		campaign = dataGrid.selectedItem as Campaigns;
	}
	
]]>	

                             
</mx:Script>

<mx:Canvas width="851" height="704">
		<mx:TabNavigator x="0" y="70" width="491" height="637" creationPolicy="all">
			<mx:Canvas label="Campaigns" width="100%" height="100%">
				<mx:TextInput x="87" y="31" id="campaign_name" text="{campaign.name}"/>
				<mx:CheckBox x="267" y="31" label="Global" id="global_campaign" width="77" selected="{campaign.globalCampaign}"/>
				<mx:Label x="44" y="33" text="Title:" textAlign="right"/>
				<mx:DataGrid x="44" y="75" id="dataGrid" dataProvider="{campaignsarray}" itemClick="dataRefresh();" editable="false">
					<mx:columns>
						<mx:DataGridColumn headerText="Slot" dataField="id"/>
						<mx:DataGridColumn headerText="Global" dataField="globalCampaign" itemRenderer="com.efi.printsmith.components.GenericCheckboxRenderer"/>
						<mx:DataGridColumn headerText="Title" dataField="name"/>
					</mx:columns>
				</mx:DataGrid>
				
			</mx:Canvas>
			<mx:Canvas label="Grade" width="100%" height="100%">
				<mx:Label x="30" y="24" width="31" text="ID:" textAlign="right"/>
				<mx:TextInput x="244" y="22" text="{grade.name}" id="grade_edit"/>
				<mx:TextInput x="69" y="22" width="81" id="grade_ID" text="{grade.id}" editable="false"/>
				<mx:Text x="202" y="24" text="Title:" width="34" textAlign="right"/>
				<mx:DataGrid x="20" y="80" height="260" width="150">
					<mx:columns>
						<mx:DataGridColumn headerText=" Grade Campaigns" dataField="col1"/>
						
					</mx:columns>
				</mx:DataGrid>
				<mx:DataGrid x="244" y="80" height="260" width="150" id="dataGrid2" dataProvider="{campaignsarray}">
					<mx:columns>
						<mx:DataGridColumn headerText="All Campaigns" dataField="name"/>
					</mx:columns>
				</mx:DataGrid>
				
			</mx:Canvas>
		</mx:TabNavigator>
		<mx:Button x="34" y="10" width="38" height="38"  click="doSave();">
			<mx:icon>@Embed(source='../../../../assets/file.png')</mx:icon>
		</mx:Button>
		<mx:Label x="34" y="44" text="Save" width="38" textAlign="center"/>
		<mx:Button x="101" y="10" width="38" height="38" click="doNew();">
			<mx:icon>@Embed(source='../../../../assets/new.png')</mx:icon>
		</mx:Button>
		<mx:Label x="101" y="44" text="New" width="38" textAlign="center"/>
	</mx:Canvas>

</mx:TitleWindow>