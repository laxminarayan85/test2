<?xml version="1.0" encoding="utf-8"?>
<mx:ComboBox xmlns:mx="http://www.adobe.com/2006/mxml" 
	
>
	<mx:Script>
		<![CDATA[
			import mx.messaging.AbstractConsumer;
			import mx.collections.ArrayCollection;
			
			private var _lastSelectedObj:Object;
			
			private var _optional:Boolean;
			
			public function set optional(val:Boolean):void	{
				_optional = val;
			}
//			private var _newRecord:Boolean = false;
//			private var _nameField:String;
//			private var _idValue:Object;
//			
//			public function set idField(val:String):void	{
//				_idField = val;
//			}
//			
//			public function get idValue():Object	{
//				return _idValue;
//			}
			
			public function get lastSelectedObj():Object	{
				return _lastSelectedObj;
			}

			override public function set dataProvider(value:Object):void	{
				super.dataProvider = value;
				
				if ((_optional) && ((dataProvider as ArrayCollection).length > 0))	{
					var blank:String = "";
					(dataProvider as ArrayCollection).addItem(blank);
					selectedIndex = (dataProvider as ArrayCollection).length - 1;
				}
				
			}
			override public function set selectedIndex(value:int):void	{
				super.selectedIndex = value;
				
				if (editable)	{
					if (value >= 0)
						_lastSelectedObj = selectedItem;
					else	{
						if (_lastSelectedObj == "")	{
	//						_newRecord = true;
							(dataProvider as ArrayCollection).addItem("");
						}
					}
				}	
//				else	{
//					if (_lastSelectedObj)	{
//						_idValue = _lastSelectedObj[_idField];
//					}	 
//				}
			}
			
			
		]]>
	</mx:Script>
</mx:ComboBox>
