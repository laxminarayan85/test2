<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%">
	<mx:Script>
		<![CDATA[
			import mx.controls.DataGrid;
			import mx.core.UIComponent;
			import mx.controls.Alert;
			import mx.utils.StringUtil;
			import mx.collections.ArrayCollection;
			
			[Bindable] protected var _searchCriteria:ArrayCollection;
			[Bindable] protected var _searchComponent:UIComponent;
			[Bindable] protected var _listData:ArrayCollection;
		
			
			public function set searchComponent(val:UIComponent):void	{
				_searchComponent = val;
			}	
								
			
			public function set listData(val:ArrayCollection):void	{
				setCustomListData(val);	
			}
			
			protected function setCustomListData(val:ArrayCollection):void	{
				_listData = val;	
			}
			
			public function set searchCriteria(val:ArrayCollection):void	{
				_searchCriteria = val;		
				if (_searchCriteria.length == 1)	{
					filterCanvas.removeChild(cboSearchBy); //.width = 0;
					//cboSearchBy.visible = false;
				}		
			}
			
			protected function search():void	{
				if (txtSearchString.text == "")		{
					_searchComponent["dataProvider"] = _listData;
				}
				else	{	
					var tmpArray:ArrayCollection = new ArrayCollection();
					var selectedCriterion:FilterSearchBy = cboSearchBy.selectedItem as FilterSearchBy;
					for (var i:int = 0; i < _listData.length; i++)	{
						var baseObj:Object = _listData.getItemAt(i);
						var obj:Object = selectedCriterion.property.getValueOf(baseObj);
						var entered:String = StringUtil.trim(txtSearchString.text).toLowerCase();
						if (obj != null)
							var indx:int = obj.toString().toLowerCase().indexOf(entered);
						 
						if ((selectedCriterion.property.getValueOf(baseObj) != null) 
								&& (selectedCriterion.property.getValueOf(baseObj).toString().toLowerCase().indexOf(StringUtil.trim(txtSearchString.text).toLowerCase()) > -1))	{
							tmpArray.addItem(baseObj);
						}
					}
					
					_searchComponent["dataProvider"] = tmpArray;					
				}
			
			} 
		]]>
	</mx:Script>
	<mx:HBox height="100%" width="100%" id="filterCanvas">
		<mx:Label height="100%" width="20%" text="{resourceManager.getString(Snowmass.RESOURCE_BUNDLE, 'labelCmd.Filter')}:"  />
		<mx:ComboBox height="100%" width="30%" id="cboSearchBy" dataProvider="{_searchCriteria}" labelField="displayLabel" />
		<mx:TextInput height="100%" width="50%" id="txtSearchString"   change="search();" />		
	</mx:HBox>
	
</mx:Canvas>
